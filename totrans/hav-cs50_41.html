<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Lecture 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Lecture 3</h1>
<blockquote>原文：<a href="https://cs50.harvard.edu/r/notes/3/">https://cs50.harvard.edu/r/notes/3/</a></blockquote>

                    

<ul id="markdown-toc">
  <li><a href="#welcome" id="markdown-toc-welcome">Welcome!</a></li>
  <li><a href="#defining-functions" id="markdown-toc-defining-functions">Defining Functions</a></li>
  <li><a href="#scope" id="markdown-toc-scope">Scope</a></li>
  <li><a href="#checking-input" id="markdown-toc-checking-input">Checking Input</a></li>
  <li><a href="#loops" id="markdown-toc-loops">Loops</a></li>
  <li><a href="#using-loops" id="markdown-toc-using-loops">Using Loops</a></li>
  <li><a href="#using-functions-and-loops" id="markdown-toc-using-functions-and-loops">Using Functions and Loops</a></li>
  <li><a href="#applying-functions" id="markdown-toc-applying-functions">Applying Functions</a></li>
  <li><a href="#summing-up" id="markdown-toc-summing-up">Summing Up</a></li>
</ul>

<h2 id="welcome">Welcome!</h2>

<ul>
  <li data-marker="*">Welcome back to CS50’s Introduction to Programming with R!</li>
  <li data-marker="*">Today, we will be learning about applying functions. We will also learn how to write our own functions and apply loops.</li>
  <li data-marker="*">
    <p>Recall a program that we created during our last lecture called <code class="language-plaintext highlighter-rouge">count.R</code>.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates counting votes for 3 different candidates</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">))</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">))</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">))</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the lines repeat functionality to get input from the user.</p>
  </li>
  <li data-marker="*">Traditionally, any time in programming that we reuse code over and over again is regarded as an opportunity for improvement. Functions are one way by which we can reduce these redundancies by defining certain blocks of code we can reuse throughout our programs.</li>
</ul>

<h2 id="defining-functions">Defining Functions</h2>

<ul>
  <li data-marker="*">In R, functions are defined by the syntax <code class="language-plaintext highlighter-rouge">function()</code>.</li>
  <li data-marker="*">
    <p>Consider the following improved version of our program:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates defining a function</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="s2">"Enter votes: "</span><span class="p">))</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that a new function called <code class="language-plaintext highlighter-rouge">get_votes</code> is created. The <em>body</em> of the function is denoted by opening and closing curly braces (<code class="language-plaintext highlighter-rouge">{</code> and <code class="language-plaintext highlighter-rouge">}</code>). Notice that within the body there are 2 lines of code, which will run each time this function is called. First, the <code class="language-plaintext highlighter-rouge">votes</code> are gathered from the user. Second, the <code class="language-plaintext highlighter-rouge">votes</code> are returned. <code class="language-plaintext highlighter-rouge">mario</code>, <code class="language-plaintext highlighter-rouge">peach</code> and <code class="language-plaintext highlighter-rouge">bowser</code> each receive the return value after <code class="language-plaintext highlighter-rouge">get_votes</code> is called. Finally, the sum of the values is provided and displayed to the user.</p>
  </li>
  <li data-marker="*">Congratulations, this is your first function in R!</li>
  <li data-marker="*">
    <p>However, running this function, we find that the function has lost some functionality that we had prior. Could there be a way we can provide a <em>parameter</em> to the function so we can more accurately prompt the user? Indeed, we can! Consider the following:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates defining a parameter</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that a <code class="language-plaintext highlighter-rouge">prompt</code> is provided to the <code class="language-plaintext highlighter-rouge">get_votes</code> function. Thus, the user is prompted with the names of those they are voting for. Additionally, notice that the <code class="language-plaintext highlighter-rouge">return(votes)</code> statement has been removed. In R, functions automatically return the last computed value.</p>
  </li>
  <li data-marker="*">
    <p>Functions that have parameters may have default values assigned. Consider the following update to our program:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates defining a parameter with a default value</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">()</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how a default value is offered in the first line of code.</p>
  </li>
  <li data-marker="*">
    <p>We can still override the default prompt as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates exact argument matching</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how, for each function call, the given argument overrides the default argument.</p>
  </li>
</ul>

<h2 id="scope">Scope</h2>

<ul>
  <li data-marker="*">Looking at our environment pane in RStudio, notice that values are provided for <code class="language-plaintext highlighter-rouge">bowser</code> and others. However, no value for <code class="language-plaintext highlighter-rouge">votes</code> appears. Why might this be?</li>
  <li data-marker="*">
    <p>Turns out all objects are defined within certain “environments.” One such environment is the “global” environment. The global environment is home to objects you define in the R console or outside of a function body—objects like <code class="language-plaintext highlighter-rouge">mario</code>, <code class="language-plaintext highlighter-rouge">bowser</code>, and <code class="language-plaintext highlighter-rouge">peach</code>. By default, RStudio’s environment pane shows you objects defined in the global environment.</p>

    <p class="w-50"><img src="../Images/4e21d01cbb22b2b2b5a55db2138468ee.png" alt="Visualization of global environment" data-original-src="https://cs50.harvard.edu/r/notes/3/009.png"/></p>
  </li>
  <li data-marker="*">
    <p>The <code class="language-plaintext highlighter-rouge">get_votes</code> function is also an object defined in the global environment. What’s unique, though, is that <code class="language-plaintext highlighter-rouge">get_votes</code> is also a kind of environment in itself! As you’ve seen, within the definition of <code class="language-plaintext highlighter-rouge">get_votes</code>, you can define other objects, like <code class="language-plaintext highlighter-rouge">votes</code> and <code class="language-plaintext highlighter-rouge">prompt</code>.</p>

    <p class="w-50"><img src="../Images/1b07a7392b73174e8a1ad91044068051.png" alt="Visualization of `get_votes` environment" data-original-src="https://cs50.harvard.edu/r/notes/3/010.png"/></p>
  </li>
  <li data-marker="*">The environment of <code class="language-plaintext highlighter-rouge">get_votes</code> is <em>not</em> the global environment. While writing code that operates in the global environment, objects in this environment are not accessible.</li>
  <li data-marker="*">The environment(s) in which an object is available is known as its “scope.”</li>
</ul>

<h2 id="checking-input">Checking Input</h2>

<ul>
  <li data-marker="*">One of the challenges consistently facing programmers is the bad behavior of users. That is, we should expect, as programmers, that users will not always do what we want. For instance, what if a user provides a string of text instead of numbers for votes?</li>
  <li data-marker="*">
    <p>We can improve our program to catch incorrect values that are entered:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates anticipating invalid input</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">))</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how <code class="language-plaintext highlighter-rouge">get_votes</code> will return a <code class="language-plaintext highlighter-rouge">0</code> if the value for <code class="language-plaintext highlighter-rouge">votes</code> is <code class="language-plaintext highlighter-rouge">NA</code>. Otherwise, <code class="language-plaintext highlighter-rouge">get_votes</code> will return the value provided by the user.</p>
  </li>
  <li data-marker="*">
    <p>While this program works, it still provides warnings, which we may not want the user to see. We can suppress warnings as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates anticipating invalid input</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how warnings are now suppressed when this code is run.</p>
  </li>
  <li data-marker="*">
    <p>This program can be further improved by using <code class="language-plaintext highlighter-rouge">ifelse</code>. Consider the following:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates ifelse as last evaluated expression</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">))</span><span class="w">
  </span><span class="n">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">votes</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that the first value of <code class="language-plaintext highlighter-rouge">ifelse</code> is a logical expression to be tested. The second value, <code class="language-plaintext highlighter-rouge">0</code>, is what will be returned if the first value <code class="language-plaintext highlighter-rouge">is.na(votes)</code> evaluates to <code class="language-plaintext highlighter-rouge">TRUE</code>. Finally, the third value, <code class="language-plaintext highlighter-rouge">votes</code>, is provided if the first value evaluates to <code class="language-plaintext highlighter-rouge">FALSE</code>.</p>
  </li>
  <li data-marker="*">We have now discovered our first fundamental ways of checking user input.</li>
  <li data-marker="*">
    <p>As we did prior, we can suppress warnings:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates suppressWarnings</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
  </span><span class="n">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">votes</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how warnings are suppressed.</p>
  </li>
</ul>

<h2 id="loops">Loops</h2>

<ul>
  <li data-marker="*">One significant improvement we may desire for our program is the ability to repeatedly prompt the user when they make an error.</li>
  <li data-marker="*">To learn more about loops, let’s enlist the help of the CS50 Duck Debugger! Quack!</li>
  <li data-marker="*">
    <p>Consider the following code:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates a duck quacking 3 times</span><span class="w">

</span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how this code will output quack three times. However, it’s quite inefficient! We are repeating the same line of code three times.</p>
  </li>
  <li data-marker="*">
    <p>We could attempt to improve this code using a <em>repeat loop</em> as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates duck quacking in an infinite loop</span><span class="w">

</span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how our duck quacks multiple times, but forever. The duck is going to get very tired!</p>
  </li>
  <li data-marker="*">
    <p>One of the ways we can implement a loop is by utilizing <code class="language-plaintext highlighter-rouge">break</code> and <code class="language-plaintext highlighter-rouge">next</code>. Such a loop will repeat a number of times by using a counter.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates quacking 3 times with repeat</span><span class="w">

</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">break</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">next</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the value of <code class="language-plaintext highlighter-rouge">i</code> is set to <code class="language-plaintext highlighter-rouge">3</code>. Then each time a <code class="language-plaintext highlighter-rouge">quack!</code> occurs, <code class="language-plaintext highlighter-rouge">i</code> is reduced by a value of <code class="language-plaintext highlighter-rouge">1</code>. When <code class="language-plaintext highlighter-rouge">0</code> is reached, the loop will <code class="language-plaintext highlighter-rouge">break</code>. Otherwise (or <code class="language-plaintext highlighter-rouge">else</code>), this loop will continue with <code class="language-plaintext highlighter-rouge">next</code>.</p>
  </li>
  <li data-marker="*">
    <p>In the end, <code class="language-plaintext highlighter-rouge">next</code> is not required. The loop will automatically continue without the <code class="language-plaintext highlighter-rouge">next</code> statement. We can remove this statement as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates removing extraneous next keyword</span><span class="w">

</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">break</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the loop will break when <code class="language-plaintext highlighter-rouge">i</code> is equal to <code class="language-plaintext highlighter-rouge">0</code>. However, <code class="language-plaintext highlighter-rouge">next</code> has been removed. The loop will still function.</p>
  </li>
  <li data-marker="*">
    <p>Another type of loop at our disposal is called a <em>while loop</em>. Such a loop will continue as long as a certain condition has not been met. Consider the following code:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates a while loop, counting down</span><span class="w">

</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how this loop will run <code class="language-plaintext highlighter-rouge">while</code> the value of <code class="language-plaintext highlighter-rouge">i != 0</code> is true.</p>
  </li>
  <li data-marker="*">
    <p>Another type of loop is called a <em>for loop</em> that allows us to repeat based upon a list or vector of values:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates a for loop</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how a <code class="language-plaintext highlighter-rouge">for</code> loop starts the value of <code class="language-plaintext highlighter-rouge">i</code> at <code class="language-plaintext highlighter-rouge">1</code>, running the code inside of it. Then, it will set the value of <code class="language-plaintext highlighter-rouge">i</code> to two and run. Finally, it will set <code class="language-plaintext highlighter-rouge">i</code> to <code class="language-plaintext highlighter-rouge">3</code> and run. Thus, the code within the loop runs three times.</p>
  </li>
  <li data-marker="*">
    <p>We can simplify our code by counting <code class="language-plaintext highlighter-rouge">1</code>, <code class="language-plaintext highlighter-rouge">2</code>, and <code class="language-plaintext highlighter-rouge">3</code> using the range <code class="language-plaintext highlighter-rouge">1:3</code> (one through three).</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates a for loop with syntactic sugar</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"quack!\n"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the code <code class="language-plaintext highlighter-rouge">i in 1:3</code> accomplishes the same task as the code presented in the prior example.</p>
  </li>
</ul>

<h2 id="using-loops">Using Loops</h2>

<ul>
  <li data-marker="*">
    <p>We can use our newly-learned abilities in loops in our counting of votes for Mario and friends. Consider the following code that utilizes a repeat loop:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates reprompting the user for valid input</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">break</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that the user will be reprompted until the value provided is not <code class="language-plaintext highlighter-rouge">NA</code>.</p>
  </li>
  <li data-marker="*">
    <p>We can further improve our code as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates tightening return</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Mario: "</span><span class="p">)</span><span class="w">
</span><span class="n">peach</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Peach: "</span><span class="p">)</span><span class="w">
</span><span class="n">bowser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="s2">"Bowser: "</span><span class="p">)</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mario</span><span class="p">,</span><span class="w"> </span><span class="n">peach</span><span class="p">,</span><span class="w"> </span><span class="n">bowser</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the <code class="language-plaintext highlighter-rouge">return(votes)</code> clause is put in the place of <code class="language-plaintext highlighter-rouge">break</code>. The same functionality remains for this function, but the code is more brief.</p>
  </li>
  <li data-marker="*">
    <p>Now, using our knowledge of <code class="language-plaintext highlighter-rouge">for</code> loops, we can improve our code that is repeated for Mario and friends:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates prompting for input in a loop</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Mario"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Peach"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bowser"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s2">": "</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how, instead of three separate lines to prompt the user for votes for each of the candidates, the <code class="language-plaintext highlighter-rouge">for</code> loop will run for the range of “Mario,” “Peach,” and “Bowser” to get the votes. The <code class="language-plaintext highlighter-rouge">paste0</code> statement adds the <code class="language-plaintext highlighter-rouge">:</code> character to each of the prompts.</p>
  </li>
  <li data-marker="*">
    <p>As a final flourish, we can employ a loop to count the votes as we go:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates prompting for input, tallying votes in a loop</span><span class="w">

</span><span class="n">get_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Enter votes: "</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">repeat</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">suppressWarnings</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">readline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)))</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nf">return</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Mario"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Peach"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bowser"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_votes</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s2">": "</span><span class="p">))</span><span class="w">
  </span><span class="n">total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">votes</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Total votes:"</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the <code class="language-plaintext highlighter-rouge">total</code> number of votes is updated in each iteration of the <code class="language-plaintext highlighter-rouge">for</code> loop.</p>
  </li>
  <li data-marker="*">
    <p>Reflecting upon the above, you can see the fundamental programming power that loops provide you as a programmer.</p>
  </li>
</ul>

<h2 id="using-functions-and-loops">Using Functions and Loops</h2>

<ul>
  <li data-marker="*">
    <p>Let’s return to a case that we discussed in a previous lecture, summing up candidates’ votes in a table like the below.</p>

    <p class="w-50"><img src="../Images/8744023a53bd9ec9c3423505bd17def0.png" alt="Candidate votes table" data-original-src="https://cs50.harvard.edu/r/notes/3/022.png"/></p>
  </li>
  <li data-marker="*">Let’s now use our new abilities in loops and functions to create a better program.</li>
  <li data-marker="*">
    <p>Perhaps our first goal should be to sum up the votes. Consider the following code:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates summing votes for each candidate procedurally</span><span class="w">

</span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"votes.csv"</span><span class="p">)</span><span class="w">

</span><span class="n">total_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">candidate</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">rownames</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">total_votes</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">votes</span><span class="p">[</span><span class="n">candidate</span><span class="p">,</span><span class="w"> </span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">total_votes</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how this <code class="language-plaintext highlighter-rouge">for</code> loop will iterate through each <code class="language-plaintext highlighter-rouge">candidate</code> presented in the <code class="language-plaintext highlighter-rouge">votes</code> data frame. Then the <code class="language-plaintext highlighter-rouge">sum</code> of the <code class="language-plaintext highlighter-rouge">votes</code> for the <code class="language-plaintext highlighter-rouge">candidate</code> will be stored in the <code class="language-plaintext highlighter-rouge">total_votes</code> vector. <code class="language-plaintext highlighter-rouge">total_votes &lt;- c()</code> represents an empty vector that is later populated with data. <code class="language-plaintext highlighter-rouge">total_votes[candidate]</code> creates a new element within the vector <code class="language-plaintext highlighter-rouge">total_votes</code>, one for each candidate in each iteration of the loop.</p>
  </li>
  <li data-marker="*">
    <p>A second goal could be to sum the <code class="language-plaintext highlighter-rouge">method</code> by which each candidate received votes.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates summing votes for each voting method procedurally</span><span class="w">

</span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"votes.csv"</span><span class="p">)</span><span class="w">

</span><span class="n">total_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">votes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">total_votes</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">votes</span><span class="p">[,</span><span class="w"> </span><span class="n">method</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">total_votes</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how this <code class="language-plaintext highlighter-rouge">for</code> loop iterates through each <code class="language-plaintext highlighter-rouge">method</code> in the <code class="language-plaintext highlighter-rouge">colnames</code> (or column names).</p>
  </li>
</ul>

<h2 id="applying-functions">Applying Functions</h2>

<ul>
  <li data-marker="*">The above program could be optimized further using a family of functions known as the <code class="language-plaintext highlighter-rouge">apply</code> functions.</li>
  <li data-marker="*">The <code class="language-plaintext highlighter-rouge">apply</code> functions allow you to apply (i.e., run) a function across elements of a data structure. For example, the <code class="language-plaintext highlighter-rouge">apply</code> function can apply a function across all rows or columns in a table of data.</li>
  <li data-marker="*">
    <p>In the case of the votes table, we can use <code class="language-plaintext highlighter-rouge">apply</code> as follows to get the <code class="language-plaintext highlighter-rouge">sum</code> of all the rows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates summing votes for each candidate with apply</span><span class="w">

</span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"votes.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">total_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span><span class="w">
</span><span class="n">total_votes</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the <code class="language-plaintext highlighter-rouge">sum</code> function is applied to all of the rows using <code class="language-plaintext highlighter-rouge">MARGIN = 1</code>. Had we put <code class="language-plaintext highlighter-rouge">MARGIN = 2</code>, the <code class="language-plaintext highlighter-rouge">sum</code> function would have been applied to all of the columns.</p>
  </li>
  <li data-marker="*">
    <p>We can sum each column as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates summing votes for each voting method with apply</span><span class="w">

</span><span class="n">votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"votes.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">total_votes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span><span class="w">
</span><span class="n">total_votes</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how <code class="language-plaintext highlighter-rouge">MARGIN = 2</code>.</p>
  </li>
</ul>

<h2 id="summing-up">Summing Up</h2>

<p>In this lesson, you learned how to apply functions in R. Specifically, you learned…</p>

<ul>
  <li data-marker="*">Defining Functions</li>
  <li data-marker="*">Scope</li>
  <li data-marker="*">Checking Input</li>
  <li data-marker="*">Loops</li>
  <li data-marker="*">Using Loops</li>
  <li data-marker="*">Using Functions and Loops</li>
  <li data-marker="*">Applying Functions</li>
</ul>

<p>See you next time when we discuss how to clean up our data.</p>


                    
</body>
</html>