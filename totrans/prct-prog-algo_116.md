# 6.4   最大流

> 原文：[`algs4.cs.princeton.edu/64maxflow`](https://algs4.cs.princeton.edu/64maxflow)

本节正在大规模建设中。

## 最大流和最小 s-t 割。

程序 FordFulkerson.java 在 E² V 时间内使用 Edmonds-Karp 最短增广路径启发式方法计算带权有向图中的最大流和最小 s-t 割（尽管在实践中，它通常运行得更快）。它使用 FlowNetwork.java 和 FlowEdge.java。

## 渗透。

2D（始终选择最左边的路径）和 3D 中的最大流。

## 应用于计算机图形学。

[Yuri Boykov](http://www.csd.uwo.ca/~yuri/)在计算机视觉中的分割应用中有关于最大流的论文。[maxflow data](http://vision.csd.uwo.ca/maxflow-data)。

## 二部图匹配。

#### 练习

1.  **包含两个顶点的循环。**给定一个无向图 G 和两个特殊顶点 s 和 t，找到包含 s 和 t 的循环（不一定是简单的），或报告不存在这样的循环。您的算法应该在线性时间内运行。

    *答案*。当且仅当从 s 到 t 的最大流至少为 2 时，答案是肯定的。因此，在每条边都替换为两条反向边和单位容量的有向图中运行 Ford-Fulkerson 的两次迭代。

1.  **k-连通。**给定一个无向图，确定两个顶点 s 和 t 是否 k-连通（或等价地，是否存在 k 条边不相交的路径）。

1.  真或假。如果为真，请提供简短的证明，如果为假，请给出一个反例。

    +   在任何最大流中，没有一个有正流量的有向循环。

    +   存在一种最大流，其中没有一个有正流量的有向循环。

    +   如果所有边的容量都不同，最大流是唯一的。

    +   如果所有边的容量都不同，最小割是唯一的。

    +   如果所有边的容量增加一个加法常数，最小割保持不变。

    +   如果所有边的容量乘以一个正整数，最小割保持不变。

1.  **包含两个顶点的简单循环。**给定一个无向图和两个顶点 s 和 t，找到包含 s 和 t 的简单循环（或报告不存在这样的循环）。

    *提示*：当且仅当存在两个（内部）顶点不相交的路径时，包含 s 和 t 的有向循环才存在。

1.  **有向图中的顶点不相交路径。**给定一个有向图 G 和两个顶点 s 和 t，找到从 s 到 t 的最大数量的顶点不相交路径。

    *提示*：将每个顶点 v（除了 s 和 t 之外）替换为两个顶点 v1 和 v2；从 v1 到 v2 添加容量为 1 的边；将所有指向 v 的边重定向到 v1；将所有从 v 指向的边重定向到 v2。

1.  **无向图中的顶点不相交路径。**给定一个无向图 G 和两个顶点 s 和 t，找到 s 和 t 之间的最大数量的顶点不相交路径。

    *提示*：将每条无向边 v-w 替换为两条有向边 v->w 和 w->v。

1.  **包含三个顶点的简单路径。**给定一个无向图和三个顶点 u、v 和 w，找到包含 u、v 和 w 的简单路径（或报告不存在这样的路径）。

    *提示*：当且仅当存在两个（内部）顶点不相交的路径，一个从 v 到 u，一个从 v 到 w 时，u 和 w 之间存在一个通过 v 的简单路径。

1.  **唯一最小割。**给定一个 s-t 流网络，确定最小割是否唯一。

    *提示*：在 G 和 G^R 中解决 s-t 最小割问题。

1.  **二部图中的不可匹配边。**给定一个二部图 G，如果边不出现在 G 的任何完美匹配中，则该边是*不��匹配的*。

    *提示*：如果 G 没有完美匹配，那么所有边都是不可匹配的。否则，找到一个完美匹配；将完美匹配中的所有边定向为一个方向，将所有剩余的边定向为相反的方向；不在完美匹配中且端点在结果有向图的不同强连通分量中的边都是不可匹配的边。

1.  **具有最少边的最小割。** 给定一个流网络，在所有最小割中，找到一个具有最少边数的割。

    *提示*：创建一个新的流网络 G'，它等于 G，除了 w'(e) = w(e) * n + 1。
