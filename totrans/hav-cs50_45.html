<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Lecture 7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Lecture 7</h1>
<blockquote>原文：<a href="https://cs50.harvard.edu/r/notes/7/">https://cs50.harvard.edu/r/notes/7/</a></blockquote>

                    

<ul id="markdown-toc">
  <li><a href="#welcome" id="markdown-toc-welcome">Welcome!</a></li>
  <li><a href="#packages" id="markdown-toc-packages">Packages</a></li>
  <li><a href="#package-structure" id="markdown-toc-package-structure">Package Structure</a></li>
  <li><a href="#devtools" id="markdown-toc-devtools">devtools</a></li>
  <li><a href="#writing-tests" id="markdown-toc-writing-tests">Writing Tests</a></li>
  <li><a href="#writing-r-code" id="markdown-toc-writing-r-code">Writing R Code</a></li>
  <li><a href="#namespace" id="markdown-toc-namespace"><code class="language-plaintext highlighter-rouge">NAMESPACE</code></a></li>
  <li><a href="#testing-code" id="markdown-toc-testing-code">Testing Code</a></li>
  <li><a href="#writing-documentation" id="markdown-toc-writing-documentation">Writing Documentation</a></li>
  <li><a href="#building-packages" id="markdown-toc-building-packages">Building Packages</a></li>
  <li><a href="#updating-packages" id="markdown-toc-updating-packages">Updating Packages</a></li>
  <li><a href="#using-and-sharing-packages" id="markdown-toc-using-and-sharing-packages">Using and Sharing Packages</a></li>
  <li><a href="#summing-up" id="markdown-toc-summing-up">Summing Up</a></li>
</ul>

<h2 id="welcome">Welcome!</h2>

<ul>
  <li data-marker="*">Welcome back to CS50’s Introduction to Programming with R!</li>
  <li data-marker="*">Today, we will be learning about packaging and distributing our programs. This way, we can share them with the world!</li>
</ul>

<h2 id="packages">Packages</h2>

<ul>
  <li data-marker="*">Today, we are going to be building and packaging a program called <code class="language-plaintext highlighter-rouge">ducksay</code>.</li>
  <li data-marker="*">If you have taken one of our other CS50 courses, you might be aware of a program called <code class="language-plaintext highlighter-rouge">cowsay</code>. It takes some piece of text and creates an image of a cow saying that text. We will be building <code class="language-plaintext highlighter-rouge">ducksay</code> in that same spirit.</li>
  <li data-marker="*"><em>Packages</em> are source code that has been compiled so that it can be distributed.</li>
</ul>

<h2 id="package-structure">Package Structure</h2>

<ul>
  <li data-marker="*">Packages should be held within a folder that is the same name as the package.</li>
  <li data-marker="*">
    <p>We can do so by typing the following commands in the R console:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir.create</span><span class="p">(</span><span class="s2">"ducksay"</span><span class="p">)</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="s2">"ducksay"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that these commands create a directory called <code class="language-plaintext highlighter-rouge">ducksay</code> and then set the working directory to <code class="language-plaintext highlighter-rouge">ducksay</code>.</p>
  </li>
  <li data-marker="*">
    <p>Packages generally have a structure as follows within the main folder:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DESCRIPTION
NAMESPACE
man/
R/
tests/
</code></pre></div>    </div>
    <p>The <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file will include a description of the package, including who wrote it. The <code class="language-plaintext highlighter-rouge">NAMESPACE</code> file will include a list of functions we want to make available to the users of our package. <code class="language-plaintext highlighter-rouge">man</code> is a folder that holds the manual (documentation) for the package. <code class="language-plaintext highlighter-rouge">R</code> includes the R code for the package. Finally, <code class="language-plaintext highlighter-rouge">tests</code> holds all the tests that we want to be able to run to ensure our package behaves as we expect.</p>
  </li>
  <li data-marker="*">
    <p>We can create a <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file by typing <code class="language-plaintext highlighter-rouge">file.create("DESCRIPTION")</code> into the R console. We can now open this file and code as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates required components of a DESCRIPTION file</span><span class="w">

</span><span class="n">Package</span><span class="o">:</span><span class="w"> </span><span class="n">ducksay</span><span class="w">
</span><span class="n">Title</span><span class="o">:</span><span class="w"> </span><span class="n">Duck</span><span class="w"> </span><span class="n">Say</span><span class="w">
</span><span class="n">Description</span><span class="o">:</span><span class="w"> </span><span class="n">Say</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">duck.</span><span class="w">
</span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="m">1.0</span><span class="w">
</span><span class="n">Authors</span><span class="o">@</span><span class="n">R</span><span class="o">:</span><span class="w"> </span><span class="n">person</span><span class="p">(</span><span class="s2">"Carter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Zenke"</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"carter@cs50.harvard.edu"</span><span class="p">,</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"aut"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cre"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cph"</span><span class="p">))</span><span class="w">
</span><span class="n">License</span><span class="o">:</span><span class="w"> </span><span class="n">MIT</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">LICENSE</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the package is named and titled. Then, a description is provided. Authors are included. Finally, the license is provided under which this package is offered. You can learn more about these fields in the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file <a href="https://cran.r-project.org/doc/manuals/R-exts.html#The-DESCRIPTION-file">documentation</a>.</p>
  </li>
  <li data-marker="*">
    <p>As you can see by the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file above, we also need a <code class="language-plaintext highlighter-rouge">LICENSE</code> file. We can code that as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates adding on to a license template</span><span class="w">

</span><span class="n">YEAR</span><span class="o">:</span><span class="w"> </span><span class="n">...</span><span class="w">
</span><span class="n">COPYRIGHT</span><span class="w"> </span><span class="n">HOLDER</span><span class="o">:</span><span class="w"> </span><span class="n">ducksay</span><span class="w"> </span><span class="n">authors</span><span class="w">
</span></code></pre></div>    </div>
    <p>Fill in the <code class="language-plaintext highlighter-rouge">...</code> with the present year. Notice how the year of the license and the copyright holder is named.</p>
  </li>
</ul>

<h2 id="devtools">devtools</h2>

<ul>
  <li data-marker="*">A package called devtools allows us to create packages faster.</li>
  <li data-marker="*">In particular, <code class="language-plaintext highlighter-rouge">devtools</code> comes with utilities for creating the necessary folder structure for our package’s tests and R code.</li>
  <li data-marker="*">We can load devtools by typing <code class="language-plaintext highlighter-rouge">library(devtools)</code> into the R console, assuming it’s already installed.</li>
</ul>

<h2 id="writing-tests">Writing Tests</h2>

<ul>
  <li data-marker="*">Thanks to the devtools package, we can easily use testthat to develop tests for packages we author.</li>
  <li data-marker="*">
    <p>Then, we can type <code class="language-plaintext highlighter-rouge">use_testthat()</code> to invoke the ability to use testthat. Our <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file will be automatically modified as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates suggesting a dependency, for testing's sake</span><span class="w">

</span><span class="n">Package</span><span class="o">:</span><span class="w"> </span><span class="n">ducksay</span><span class="w">
</span><span class="n">Title</span><span class="o">:</span><span class="w"> </span><span class="n">Duck</span><span class="w"> </span><span class="n">Say</span><span class="w">
</span><span class="n">Description</span><span class="o">:</span><span class="w"> </span><span class="n">Say</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">duck.</span><span class="w">
</span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="m">1.0</span><span class="w">
</span><span class="n">Authors</span><span class="o">@</span><span class="n">R</span><span class="o">:</span><span class="w"> </span><span class="n">person</span><span class="p">(</span><span class="s2">"Carter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Zenke"</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"carter@cs50.harvard.edu"</span><span class="p">,</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"aut"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cre"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cph"</span><span class="p">))</span><span class="w">
</span><span class="n">License</span><span class="o">:</span><span class="w"> </span><span class="n">MIT</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">LICENSE</span><span class="w">
</span><span class="n">Suggests</span><span class="o">:</span><span class="w">
    </span><span class="n">testthat</span><span class="w"> </span><span class="p">(</span><span class="o">&gt;=</span><span class="w"> </span><span class="m">3.0.0</span><span class="p">)</span><span class="w">
</span><span class="n">Config</span><span class="o">/</span><span class="n">testthat</span><span class="o">/</span><span class="n">edition</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that the package will suggest that one should have testthat version 3.0.0 or above installed. This may vary depending on the version of testthat that you’ve installed.</p>
  </li>
  <li data-marker="*">
    <p>Inside our <code class="language-plaintext highlighter-rouge">tests/testthat</code> folder, created by <code class="language-plaintext highlighter-rouge">use_testthat</code>, we can create our first test, <code class="language-plaintext highlighter-rouge">test-ducksay.R</code>, as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates describing behavior of `ducksay`</span><span class="w">

</span><span class="n">describe</span><span class="p">(</span><span class="s2">"ducksay()"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can print to the console with `cat`"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_output</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">()))</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say hello to the world"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(),</span><span class="w"> </span><span class="s2">"hello, world"</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
</span><span class="p">})</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that <code class="language-plaintext highlighter-rouge">expect_match</code> looks for the string <code class="language-plaintext highlighter-rouge">hello, world</code> in the output of <code class="language-plaintext highlighter-rouge">ducksay</code>.</p>
  </li>
</ul>

<h2 id="writing-r-code">Writing R Code</h2>

<ul>
  <li data-marker="*">Continuing our use of devtools we can now type the following in the R console: <code class="language-plaintext highlighter-rouge">use_r("ducksay")</code>.</li>
  <li data-marker="*">This command will create a folder called <code class="language-plaintext highlighter-rouge">R</code> and a file called <code class="language-plaintext highlighter-rouge">ducksay.R</code>.</li>
  <li data-marker="*">Now, it’s time to provide some functionality within our program that we will package. This functionality should match the test that we wrote.</li>
  <li data-marker="*">
    <p>Write code for <code class="language-plaintext highlighter-rouge">ducksay.R</code> as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates defining a function for a package</span><span class="w">

</span><span class="n">ducksay</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="w">
    </span><span class="s2">"hello, world"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"&gt;(. )__"</span><span class="p">,</span><span class="w">
    </span><span class="s2">" (____/"</span><span class="p">,</span><span class="w">
    </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ul>

<h2 id="namespace"><code class="language-plaintext highlighter-rouge">NAMESPACE</code></h2>

<ul>
  <li data-marker="*">As mentioned previously, we need to provide information about what functions are available to the end users of this package in a file called <code class="language-plaintext highlighter-rouge">NAMESPACE</code>.</li>
  <li data-marker="*">
    <p>To do so, you can type <code class="language-plaintext highlighter-rouge">file.create("NAMESPACE")</code> in your console. Then, edit this file as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates declaring `ducksay` accessible to package end users</span><span class="w">

</span><span class="n">export</span><span class="p">(</span><span class="n">ducksay</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>This file simply makes the <code class="language-plaintext highlighter-rouge">ducksay</code> function available to the end user of the package.</p>
  </li>
  <li data-marker="*">We can now type <code class="language-plaintext highlighter-rouge">load_all()</code> into the R console to load all the available functions named in <code class="language-plaintext highlighter-rouge">NAMESPACE</code>.</li>
</ul>

<h2 id="testing-code">Testing Code</h2>

<ul>
  <li data-marker="*">You can now run <code class="language-plaintext highlighter-rouge">test()</code> to test our function. No errors should result.</li>
  <li data-marker="*">Further, you can now use <code class="language-plaintext highlighter-rouge">ducksay</code> in RStudio after you have loaded the functions of this package.</li>
  <li data-marker="*">
    <p>Updating our tests, let’s test to see if a duck appears in <code class="language-plaintext highlighter-rouge">ducksay</code>:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates checking for duck in output</span><span class="w">

</span><span class="n">describe</span><span class="p">(</span><span class="s2">"ducksay()"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can print to the console with `cat`"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_output</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">()))</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say hello to the world"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(),</span><span class="w"> </span><span class="s2">"hello, world"</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say hello with a duck"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">duck</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="w">
      </span><span class="s2">"&gt;(. )__"</span><span class="p">,</span><span class="w">
      </span><span class="s2">" (____/"</span><span class="p">,</span><span class="w">
      </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="w">
    </span><span class="p">)</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(),</span><span class="w"> </span><span class="n">duck</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
</span><span class="p">})</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how this test looks to see if a duck is represented. Additionally, notice how <code class="language-plaintext highlighter-rouge">fixed = TRUE</code>, as described in the lecture, prevents the test from misinterpreting some of the characters within the duck as being part of something called a regular expression. Suffice to say for now, a regular expression is not what we’d like!</p>
  </li>
</ul>

<h2 id="writing-documentation">Writing Documentation</h2>

<ul>
  <li data-marker="*">We can now document how to use our function. Typically, we can type <code class="language-plaintext highlighter-rouge">?ducksay</code> to see documentation. However, we have not created our documentation yet.</li>
  <li data-marker="*">Documentation is written in a type of language called a markup language. A markup language provides syntax for specifying the formatting of a document.</li>
  <li data-marker="*">
    <p>You can write your documentation by typing:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir.create</span><span class="p">(</span><span class="s2">"man"</span><span class="p">)</span><span class="w">
</span><span class="n">file.create</span><span class="p">(</span><span class="s2">"man/ducksay.Rd"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>The first command creates a folder called <code class="language-plaintext highlighter-rouge">man</code>. The second creates our documentation file.</p>
  </li>
  <li data-marker="*">
    <p>Modify your documentation file as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates required markup for R documentation files</span><span class="w">

</span><span class="err">\</span><span class="n">name</span><span class="p">{</span><span class="n">ducksay</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">alias</span><span class="p">{</span><span class="n">ducksay</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">title</span><span class="p">{</span><span class="n">Duck</span><span class="w"> </span><span class="n">Say</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">description</span><span class="p">{</span><span class="n">A</span><span class="w"> </span><span class="n">duck</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">hello.</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">usage</span><span class="p">{</span><span class="w">
</span><span class="n">ducksay</span><span class="p">()</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">value</span><span class="p">{</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">representation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">duck</span><span class="w"> </span><span class="n">saying</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">world.</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">examples</span><span class="p">{</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">())</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice how the <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">description</code>, <code class="language-plaintext highlighter-rouge">usage</code>, and other sections are provided. You can learn more about these elements by reading the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-documentation-files">documentation</a> on R documentation files.</p>
  </li>
  <li data-marker="*">Now, it’s time to wrap things up and share our package.</li>
</ul>

<h2 id="building-packages">Building Packages</h2>

<ul>
  <li data-marker="*">
    <p>Once a package’s contents are ready to be bundled together and distributed, one of two commands can be used to initiate a <em>build</em>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>build
R CMD build
</code></pre></div>    </div>
    <p>Notice that <code class="language-plaintext highlighter-rouge">build</code> is a devtools function and can be run directly from the R console. <code class="language-plaintext highlighter-rouge">R CMD build</code> can be run from the computer’s terminal outside of R.</p>
  </li>
  <li data-marker="*">
    <p>Running <code class="language-plaintext highlighter-rouge">build</code>, you will see a <code class="language-plaintext highlighter-rouge">.gz</code> file will be outputted within your working directory.</p>
  </li>
</ul>

<h2 id="updating-packages">Updating Packages</h2>

<ul>
  <li data-marker="*">
    <p>To update our code, we can open our test file and update our test as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates ensuring duck repeats given phrase</span><span class="w">

</span><span class="n">describe</span><span class="p">(</span><span class="s2">"ducksay()"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can print to the console with `cat`"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_output</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">()))</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say hello to the world"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(),</span><span class="w"> </span><span class="s2">"hello, world"</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say hello with a duck"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">duck</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="w">
      </span><span class="s2">"&gt;(. )__"</span><span class="p">,</span><span class="w">
      </span><span class="s2">" (____/"</span><span class="p">,</span><span class="w">
      </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="w">
    </span><span class="p">)</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(),</span><span class="w"> </span><span class="n">duck</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="n">it</span><span class="p">(</span><span class="s2">"can say any given phrase"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expect_match</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(</span><span class="s2">"quack!"</span><span class="p">),</span><span class="w"> </span><span class="s2">"quack!"</span><span class="p">)</span><span class="w">
  </span><span class="p">})</span><span class="w">
</span><span class="p">})</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that a new test is added that looks for “quack!”</p>
  </li>
  <li data-marker="*">
    <p>With this test in mind, we can now update our source code to allow for the inputting of any phrase, which, in turn, will be stated by the duck:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates taking an argument to print</span><span class="w">

</span><span class="n">ducksay</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">phrase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"hello, world"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="w">
    </span><span class="n">phrase</span><span class="p">,</span><span class="w">
    </span><span class="s2">"&gt;(. )__"</span><span class="p">,</span><span class="w">
    </span><span class="s2">" (____/"</span><span class="p">,</span><span class="w">
    </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that a default <code class="language-plaintext highlighter-rouge">phrase</code>, “hello, world” is provided. If another <code class="language-plaintext highlighter-rouge">phrase</code> is provided, it will say that <code class="language-plaintext highlighter-rouge">phrase</code> instead.</p>
  </li>
  <li data-marker="*">
    <p>Similarly, we can update our documentation file as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates updated markup, including specifying arguments</span><span class="w">

</span><span class="err">\</span><span class="n">name</span><span class="p">{</span><span class="n">ducksay</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">alias</span><span class="p">{</span><span class="n">ducksay</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">title</span><span class="p">{</span><span class="n">Duck</span><span class="w"> </span><span class="n">Say</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">description</span><span class="p">{</span><span class="n">A</span><span class="w"> </span><span class="n">duck</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">hello.</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">usage</span><span class="p">{</span><span class="w">
</span><span class="n">ducksay</span><span class="p">(</span><span class="n">phrase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"hello, world"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">arguments</span><span class="p">{</span><span class="w">
</span><span class="err">\</span><span class="n">item</span><span class="p">{</span><span class="n">phrase</span><span class="p">}{</span><span class="n">The</span><span class="w"> </span><span class="n">phrase</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">duck</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">say.</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">value</span><span class="p">{</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">representation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">duck</span><span class="w"> </span><span class="n">saying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">phrase.</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">\</span><span class="n">examples</span><span class="p">{</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">())</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">ducksay</span><span class="p">(</span><span class="s2">"quack!"</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that <code class="language-plaintext highlighter-rouge">value</code> is updated. Further, <code class="language-plaintext highlighter-rouge">arguments</code> is also updated. Another example is provided in <code class="language-plaintext highlighter-rouge">examples</code>.</p>
  </li>
  <li data-marker="*">We can run <code class="language-plaintext highlighter-rouge">build</code> again to include our modifications.</li>
  <li data-marker="*">This package can now be shared with others.</li>
</ul>

<h2 id="using-and-sharing-packages">Using and Sharing Packages</h2>

<ul>
  <li data-marker="*">Let’s now create a program called <code class="language-plaintext highlighter-rouge">greet.R</code> that uses this package.</li>
  <li data-marker="*">We can set the working directory away from <code class="language-plaintext highlighter-rouge">ducksay</code> by typing <code class="language-plaintext highlighter-rouge">setwd("..")</code> in the R console. This will move our working directory to one directory higher than that of <code class="language-plaintext highlighter-rouge">ducksay</code>.</li>
  <li data-marker="*">
    <p>Next, we can type <code class="language-plaintext highlighter-rouge">file.create("greet.R")</code> to create a new file. Modify this file as follows:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Demonstrates using custom package</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">ducksay</span><span class="p">)</span><span class="w">

</span><span class="n">name</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readline</span><span class="p">(</span><span class="s2">"What's your name? "</span><span class="p">)</span><span class="w">
</span><span class="n">greeting</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ducksay</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"hello,"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">))</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">greeting</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
    <p>Notice that this program loads <code class="language-plaintext highlighter-rouge">ducksay</code>. Then, the code uses this new library.</p>
  </li>
  <li data-marker="*">
    <p>While this works on our computer, being that we developed this package locally, others will need to install this package. To do so, one of the following commands can be used:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>install.packages
R CMD INSTALL
</code></pre></div>    </div>
    <p>As discussed in previous lectures, the top command can be run directly within RStudio and is built into R itself. The other command can be run in the computer’s terminal. It is also built into R.</p>
  </li>
  <li data-marker="*">To install our package, we can run the following in our console: <code class="language-plaintext highlighter-rouge">install.packages("ducksay_1.0.tar.gz")</code></li>
  <li data-marker="*">You can share your code using CRAN, GitHub, and even email.</li>
</ul>

<h2 id="summing-up">Summing Up</h2>

<p>In this lesson, you learned how to package your programs in R. Specifically, you learned about:</p>

<ul>
  <li data-marker="*">Packages</li>
  <li data-marker="*">Package Structure</li>
  <li data-marker="*">devtools</li>
  <li data-marker="*">Writing Tests</li>
  <li data-marker="*">Writing R Code</li>
  <li data-marker="*"><code class="language-plaintext highlighter-rouge">NAMESPACE</code></li>
  <li data-marker="*">Testing Code</li>
  <li data-marker="*">Writing Documentation</li>
  <li data-marker="*">Building Packages</li>
  <li data-marker="*">Updating Packages</li>
  <li data-marker="*">Using and Sharing Packages</li>
</ul>

<p>In this course, you learned many things about R and programming with R. You learned how to represent data, transform data, apply functions, tidy data, visualize data, test programs, and package programs. In all, we hope that you have found this material helpful to you. We also hope that you will take what you have learned to do great good in the world.</p>

<p>This was CS50’s Introduction to Programming with R.</p>


                    
</body>
</html>