- en: Lecture 7
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7讲
- en: 原文：[https://cs50.harvard.edu/x/notes/7/](https://cs50.harvard.edu/x/notes/7/)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://cs50.harvard.edu/x/notes/7/](https://cs50.harvard.edu/x/notes/7/)
- en: '[Welcome!](#welcome)'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[欢迎！](#welcome)'
- en: '[Flat-File Database](#flat-file-database)'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[平面文件数据库](#flat-file-database)'
- en: '[Relational Databases](#relational-databases)'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[关系数据库](#relational-databases)'
- en: '[SELECT](#select)'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SELECT](#select)'
- en: '[INSERT](#insert)'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[INSERT](#insert)'
- en: '[DELETE](#delete)'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[DELETE](#delete)'
- en: '[UPDATE](#update)'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[UPDATE](#update)'
- en: '[IMDb](#imdb)'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[IMDb](#imdb)'
- en: '[`JOIN`s](#joins)'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[JOIN](#joins)'
- en: '[Indexes](#indexes)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[索引](#indexes)'
- en: '[Using SQL in Python](#using-sql-in-python)'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在Python中使用SQL](#using-sql-in-python)'
- en: '[Race Conditions](#race-conditions)'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[竞争条件](#race-conditions)'
- en: '[SQL Injection Attacks](#sql-injection-attacks)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SQL注入攻击](#sql-injection-attacks)'
- en: '[Summing Up](#summing-up)'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结](#summing-up)'
- en: Welcome!
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 欢迎！
- en: In previous weeks, we introduced you to Python, a high-level programming language
    that utilized the same building blocks we learned in C. However, we introduced
    this new language not for the purpose of learning “just another language.” Instead,
    we do so because some tools are better for some jobs and not so great for others!
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在前几周，我们向您介绍了Python，这是一种高级编程语言，它使用了我们在C语言中学到的相同构建块。然而，我们引入这种新语言不是为了学习“另一种语言”。相反，我们这样做是因为某些工具更适合某些工作，而不太适合其他工作！
- en: This week, we will be continuing more syntax related to Python.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这周，我们将继续学习更多与Python相关的语法。
- en: Further, we will be integrating this knowledge with data.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，我们将把这种知识与我们所学的内容结合起来。
- en: Finally, we will be discussing *SQL* or *Structured Query Language*, a domain-specific
    way by which we can interact with and modify data.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们将讨论*SQL*或*结构化查询语言*，这是一种特定领域的方法，我们可以通过它来交互和修改数据。
- en: Overall, one of the goals of this course is to learn to program generally –
    not simply how to program in the languages described in this course.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总体而言，本课程的一个目标就是学习编程的一般知识——而不仅仅是学习本课程中描述的语言的编程。
- en: Flat-File Database
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 平面文件数据库
- en: As you have likely seen before, data can often be described in patterns of columns
    and rows.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如你所见，数据通常可以用列和行的模式来描述。
- en: Spreadsheets like those created in Microsoft Excel and Google Sheets can be
    outputted to a `csv` or *comma-separated values* file.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类似于在Microsoft Excel和Google Sheets中创建的电子表格可以输出为`csv`或*逗号分隔值*文件。
- en: If you look at a `csv` file, you’ll notice that the file is flat in that all
    of our data is stored in a single table represented by a text file. We call this
    form of data a *flat-file database*.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你查看一个`csv`文件，你会注意到文件是平的，因为我们的所有数据都存储在一个由文本文件表示的单个表中。我们称这种形式的数据为*平面文件数据库*。
- en: All data is stored row by row. Each column is separated by a comma or another
    value.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有数据都是按行存储的。每个列由逗号或其他值分隔。
- en: Python comes with native support for `csv` files.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python自带对`csv`文件的原生支持。
- en: First, download [favorites.csv](https://cdn.cs50.net/2023/fall/lectures/7/src7/favorites/favorites.csv)
    and upload it to your file explorer inside [cs50.dev](https://cs50.dev). Second,
    examining this data, notice that the first row is special in that it defines each
    column. Then, each record is stored row by row.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，下载[favorites.csv](https://cdn.cs50.net/2023/fall/lectures/7/src7/favorites/favorites.csv)并将其上传到[cs50.dev](https://cs50.dev)中的文件资源管理器内。其次，检查这些数据，注意第一行是特殊的，因为它定义了每一列。然后，每条记录按行存储。
- en: 'In your terminal window, type `code favorites.py` and write code as follows:'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在你的终端窗口中，输入`code favorites.py`并编写以下代码：
- en: '[PRE0]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Notice that the `csv` library is imported. Further, we created a `reader` that
    will hold the result of `csv.reader(file)`. The `csv.reader` function reads each
    row from the file, and in our code, we store the results in `reader`. `print(row[1])`,
    therefore, will print the language from the `favorites.csv` file.
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到已经导入了`csv`库。此外，我们创建了一个`reader`，它将保存`csv.reader(file)`的结果。`csv.reader`函数从文件中读取每一行，在我们的代码中，我们将结果存储在`reader`中。因此，`print(row[1])`将打印出`favorites.csv`文件中的语言。
- en: 'You can improve your code as follows:'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以按照以下方式改进你的代码：
- en: '[PRE1]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Notice that `favorite` is stored and then printed. Also, notice that we use
    the `next` function to skip to the next line of our reader.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意`favorite`被存储并打印出来。此外，注意我们使用`next`函数跳到读者下一行。
- en: One of the disadvantages of the above approach is that we are trusting that
    `row[1]` is always the favorite. However, what would happen if the columns had
    been moved around?
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上述方法的一个缺点是我们信任`row[1]`始终是首选。然而，如果列被移动了，会发生什么呢？
- en: 'We can fix this potential issue. Python also allows you to index by the keys
    of a list. Modify your code as follows:'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以修复这个潜在的问题。Python还允许你通过列表的键进行索引。按照以下方式修改你的代码：
- en: '[PRE2]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Notice that this example directly utilizes the `language` key in the print statement.
    `favorite` indexes into the `reader` dictionary of `row["language"]`.
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到这个例子直接在打印语句中使用了`language`键。`favorite`索引到`row["language"]`的`reader`字典。
- en: 'This could be further simplified to:'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这可以进一步简化为：
- en: '[PRE3]'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To count the number of favorite languages expressed in the `csv` file, we can
    do the following:'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要统计在`csv`文件中表达的首选语言的数目，我们可以这样做：
- en: '[PRE4]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Notice that each language is counted using `if` statements. Further, notice
    the double equal `==` signs in those `if` statements.
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到每种语言都是通过`if`语句进行统计的。此外，注意那些`if`语句中的双等号`==`。
- en: 'Python allows us to use a dictionary to count the `counts` of each language.
    Consider the following improvement upon our code:'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 允许我们使用字典来统计每种语言的`counts`。考虑以下对我们代码的改进：
- en: '[PRE5]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Notice that the value in `counts` with the key `favorite` is incremented when
    it exists already. If it does not exist, we define `counts[favorite]` and set
    it to 1\. Further, the formatted string has been improved to present the `counts[favorite]`.
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到当`counts`中存在`favorite`键时，其值会增加。如果它不存在，我们定义`counts[favorite]`并将其设置为1。此外，格式化字符串已经得到改进，以展示`counts[favorite]`。
- en: 'Python also allows sorting `counts`. Improve your code as follows:'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 也允许对`counts`进行排序。按照以下方式改进你的代码：
- en: '[PRE6]'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Notice the `sorted(counts)` at the bottom of the code.
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意代码底部的`sorted(counts)`。
- en: 'If you look at the parameters for the `sorted` function in the Python documentation,
    you will find it has many built-in parameters. You can leverage some of these
    built-in parameters as follows:'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你查看 Python 文档中`sorted`函数的参数，你会发现它有许多内置参数。你可以利用一些这些内置参数，如下所示：
- en: '[PRE7]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Notice the arguments passed to `sorted`. The `key` argument allows you to tell
    Python the method you wish to use to sort items. In this case `counts.get` is
    used to sort by the values. `reverse=True` tells `sorted` to sort from largest
    to smallest.
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意传递给`sorted`的参数。`key`参数允许你告诉 Python 你希望用于排序项的方法。在这种情况下，使用`counts.get`按值排序。`reverse=True`告诉`sorted`从大到小排序。
- en: 'Python has numerous libraries that we can utilize in our code. One of these
    libraries is `collections`, from which we can import `Counter`. `Counter` will
    allow you to access the counts of each language without the headaches of all the
    `if` statements seen in our previous code. You can implement as follows:'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 有许多库，我们可以在代码中利用这些库。其中之一是`collections`，我们可以从中导入`Counter`。`Counter`将允许你访问每种语言的计数，而无需像我们之前的代码中看到的那样处理所有`if`语句。你可以按照以下方式实现：
- en: '[PRE8]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Notice how `counts = Counter()` enables the use of this imported `Counter` class
    from `collections`.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到`counts = Counter()`如何启用从`collections`导入的`Counter`类。
- en: You can learn more about [sorted](https://docs.python.org/3/howto/sorting.html)
    in the [Python Documentation](https://docs.python.org/3/howto/sorting.html).
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以在[Python 文档](https://docs.python.org/3/howto/sorting.html)中了解更多关于[sorted](https://docs.python.org/3/howto/sorting.html)的信息。
- en: Relational Databases
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关系型数据库
- en: Google, X, and Meta all use relational databases to store their information
    at scale.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Google、X 和 Meta 都使用关系型数据库来大规模存储他们的信息。
- en: Relational databases store data in rows and columns in structures called *tables*.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关系型数据库在称为 *表格* 的结构中以行和列的形式存储数据。
- en: 'SQL allows for four types of commands:'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SQL 允许四种类型的命令：
- en: '[PRE9]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: These four operations are affectionately called *CRUD*.
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这四个操作被亲切地称为 *CRUD*。
- en: We can create a database with the SQL syntax `CREATE TABLE table (column type,
    ...);`. But where do you run this command?
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以使用 SQL 语法`CREATE TABLE table (column type, ...);`创建一个数据库。但这个命令在哪里运行呢？
- en: '`sqlite3` is a type of SQL database that has the core features required for
    this course.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sqlite3`是一种具有本课程所需核心功能的关系型数据库。'
- en: We can create a SQL database at the terminal by typing `sqlite3 favorites.db`.
    Upon being prompted, we will agree that we want to create `favorites.db` by pressing
    `y`.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以在终端通过输入`sqlite3 favorites.db`创建一个 SQL 数据库。在被提示时，我们将通过按`y`键同意创建`favorites.db`。
- en: You will notice a different prompt as we are now using a program called `sqlite`.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你会注意到提示符发生了变化，因为我们现在正在使用一个名为`sqlite`的程序。
- en: We can put `sqlite` into `csv` mode by typing `.mode csv`. Then, we can import
    our data from our `csv` file by typing `.import favorites.csv favorites`. It seems
    that nothing has happened!
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过输入`.mode csv`将`sqlite`置于`csv`模式。然后，我们可以通过输入`.import favorites.csv favorites`从我们的`csv`文件导入数据。看起来好像什么都没发生！
- en: We can type `.schema` to see the structure of the database.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以输入`.schema`来查看数据库的结构。
- en: You can read items from a table using the syntax `SELECT columns FROM table`.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以使用`SELECT columns FROM table`语法从表中读取项目。
- en: For example, you can type `SELECT * FROM favorites;` which will print every
    row in `favorites`.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can get a subset of the data using the command `SELECT language FROM favorites;`.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'SQL supports many commands to access data, including:'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: For example, you can type `SELECT COUNT(*) FROM favorites;`. Further, you can
    type `SELECT DISTINCT language FROM favorites;` to get a list of the individual
    languages within the database. You could even type `SELECT COUNT(DISTINCT language)
    FROM favorites;` to get a count of those.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'SQL offers additional commands we can utilize in our queries:'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Notice that we use `--` to write a comment in SQL.
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: SELECT
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For example, we can execute `SELECT COUNT(*) FROM favorites WHERE language =
    'C';`. A count is presented.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Further, we could type `SELECT COUNT(*) FROM favorites WHERE language = 'C'
    AND problem = 'Hello, World';`. Notice how the `AND` is utilized to narrow our
    results.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Similarly, we could execute `SELECT language, COUNT(*) FROM favorites GROUP
    BY language;`. This would offer a temporary table that would show the language
    and count.
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We could improve this by typing `SELECT language, COUNT(*) FROM favorites GROUP
    BY language ORDER BY COUNT(*);`. This will order the resulting table by the `count`.
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Likewise, we could execute `SELECT COUNT(*) FROM favorites WHERE language =
    'C' AND (problem = 'Hello, World' OR problem = 'Hello, It''s Me');`. Do notice
    that there are two `''` marks as to allow the use of single quotes in a way that
    does not confuse SQL.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Further, we could execute `SELECT COUNT(*) FROM favorites WHERE language = 'C'
    AND problem LIKE 'Hello, %';` to find any problems that start with `Hello,` (including
    a space).
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We can also group the values of each language by executing `SELECT language,
    COUNT(*) FROM favorites GROUP BY language;`.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We can order the output as follows: `SELECT language, COUNT(*) FROM favorites
    GROUP BY language ORDER BY COUNT(*) DESC;`.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We can even create aliases, like variables in our queries: `SELECT language,
    COUNT(*) AS n FROM favorites GROUP BY language ORDER BY n DESC;`.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Finally, we can limit our output to 1 or more values: `SELECT language, COUNT(*)
    AS n FROM favorites GROUP BY language ORDER BY n DESC LIMIT 1;`.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: INSERT
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can also `INSERT` into a SQL database utilizing the form `INSERT INTO table
    (column...) VALUES(value, ...);`.
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We can execute `INSERT INTO favorites (language, problem) VALUES ('SQL', 'Fiftyville');`.
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can verify the addition of this favorite by executing `SELECT * FROM favorites;`.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DELETE
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '`DELETE` allows you to delete parts of your data. For example, you could `DELETE
    FROM favorites WHERE Timestamp IS NULL;`. This deletes any record where the `Timestamp`
    is `NULL`.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: UPDATE
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can also utilize the `UPDATE` command to update your data.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For example, you can execute `UPDATE favorites SET language = 'SQL', problem
    = 'Fiftyville';`. This will result in overwriting all previous statements where
    C and Scratch were the favorite programming language.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Notice that these queries have immense power. Accordingly, in the real-world
    setting, you should consider who has permissions to execute certain commands and
    if you have backups available!
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注意，这些查询具有巨大的威力。因此，在实际环境中，您应该考虑谁有权限执行某些命令，以及您是否有可用的备份！
- en: IMDb
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: IMDb
- en: We can imagine a database that we might want to create to catalog various TV
    shows. We could create a spreadsheet with columns like `title`, `star`, `star`,
    `star`, `star`, and more stars. A problem with this approach is that it has a
    lot of wasted space. Some shows may have one star. Others may have dozens.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以想象一个我们可能想要创建的数据库，用于分类各种电视节目。我们可以创建一个包含诸如`title`、`star`、`star`、`star`、`star`以及更多星星的电子表格。这种方法的缺点是它有很多浪费的空间。有些节目可能只有一个明星。而有些节目可能有几十个。
- en: We could separate our database into multiple sheets. We could have a `shows`
    sheet, a `stars` sheet, and a `people` sheet. On the `people` sheet, each person
    could have a unique `id`. On the `shows` sheet, each show could have a unique
    `id` too. On a third sheet called `stars` we could relate how each show has people
    for each show by having a `show_id` and `person_id`. While this is an improvement,
    this is not an ideal database.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以将数据库分成多个工作表。我们可以有一个`shows`工作表、一个`stars`工作表和一个`people`工作表。在`people`工作表中，每个人可以有一个唯一的`id`。在`shows`工作表中，每个节目也可以有一个唯一的`id`。在名为`stars`的第三个工作表中，我们可以通过拥有`show_id`和`person_id`来关联每个节目对应的人员。虽然这是一个改进，但这并不是一个理想的数据库。
- en: 'IMDb offers a database of people, shows, writers, stars, genres, and ratings.
    Each of these tables is related to one another as follows:'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IMDb 提供了人员、节目、编剧、明星、类型和评分的数据库。这些表彼此之间如下相关：
- en: '![six boxes that represent various sql tables arrows are drawn to each showing
    their many relationships with one another](../Images/db89fb0977f2fee293de5c9dd3427a4f.png
    "imdb relationships")'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![代表各种 SQL 表的六个盒子，箭头指向每个盒子，显示它们彼此之间的多对多关系](../Images/db89fb0977f2fee293de5c9dd3427a4f.png
    "imdb relationships")'
- en: After downloading [`shows.db`](https://cdn.cs50.net/2024/fall/lectures/7/src7/imdb/shows.db),
    you can execute `sqlite3 shows.db` in your terminal window.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下载完[`shows.db`](https://cdn.cs50.net/2024/fall/lectures/7/src7/imdb/shows.db)后，你可以在终端窗口中执行`sqlite3
    shows.db`。
- en: 'Let’s zero in on the relationship between two tables within the database called
    `shows` and `ratings`. The relationship between these two tables can be illustrated
    as follows:'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们聚焦于数据库中名为`shows`和`ratings`的两个表之间的关系。这两个表之间的关系可以如下表示：
- en: '![two boxes one called shows and the other called ratings](../Images/caeb1577c462d26137d75024dc7b974a.png
    "imdb shows and ratings")'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![一个称为 shows 的盒子和一个称为 ratings 的盒子](../Images/caeb1577c462d26137d75024dc7b974a.png
    "imdb shows and ratings")'
- en: 'To illustrate the relationship between these tables, we could execute the following
    command: `SELECT * FROM ratings LIMIT 10;`. Examining the output, we could execute
    `SELECT * FROM shows LIMIT 10;`.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了说明这些表之间的关系，我们可以执行以下命令：`SELECT * FROM ratings LIMIT 10;`。检查输出后，我们可以执行`SELECT
    * FROM shows LIMIT 10;`。
- en: 'Examining `shows` and `rating`, we can see these have a one-to-one relationship:
    One show has one rating.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查`shows`和`rating`，我们可以看到它们之间存在一对一的关系：一个节目有一个评分。
- en: To understand the database, upon executing `.schema` you will find not only
    each of the tables but the individual fields inside each of these fields.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要了解数据库，在执行`.schema`后，您不仅会发现每个表，还会发现每个字段中的各个字段。
- en: More specifically, you could execute `.schema shows` to understand the fields
    inside `shows`. You can also execute `.schema ratings` to see the fields inside
    `ratings`.
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更具体地说，您可以通过执行`.schema shows`来了解`shows`内部的字段。您也可以执行`.schema ratings`来查看`ratings`内部的字段。
- en: As you can see, `show_id` exists in all of the tables. In the `shows` table,
    it is simply called `id`. This common field between all the fields is called a
    *key*. Primary keys are used to identify a unique record in a table. *Foreign
    keys* are used to build relationships between tables by pointing to the primary
    key in another table. You can see in the schema of `ratings` that `show_id` is
    a foreign key that references `id` in `shows`.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如您所见，`show_id`存在于所有表中。在`shows`表中，它简单地被称为`id`。这个在所有字段之间都存在的公共字段被称为*键*。主键用于在表中标识唯一记录。*外键*用于通过指向另一个表中的主键来建立表之间的关系。您可以在`ratings`模式的方案中看到`show_id`是一个外键，它引用了`shows`中的`id`。
- en: By storing data in a relational database, as above, data can be more efficiently
    stored.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过将数据存储在上述关系型数据库中，数据可以更有效地存储。
- en: 'In *sqlite*, we have five data types, including:'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 *sqlite* 中，我们有五种数据类型，包括：
- en: '[PRE12]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Additionally, columns can be set to add special constraints:'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，可以将列设置为添加特殊约束：
- en: '[PRE13]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: We can further play with this data to understand these relationships. Execute
    `SELECT * FROM ratings;`. There are a lot of ratings!
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以进一步利用这些数据来理解这些关系。执行`SELECT * FROM ratings;`。这里有很多评分！
- en: We can further limit this data down by executing `SELECT show_id FROM ratings
    WHERE rating >= 6.0 LIMIT 10;`. From this query, you can see that there are 10
    shows presented. However, we don’t know what show each `show_id` represents.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过执行`SELECT show_id FROM ratings WHERE rating >= 6.0 LIMIT 10;`进一步限制这些数据。从这个查询中，你可以看到有10个节目被展示。然而，我们不知道每个`show_id`代表什么节目。
- en: You can discover what shows these are by executing `SELECT * FROM shows WHERE
    id = 626124;`
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以通过执行`SELECT * FROM shows WHERE id = 626124;`来发现这些节目是什么。
- en: 'We can further our query to be more efficient by executing:'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过执行以下命令，我们可以使查询更高效：
- en: '[PRE14]'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Notice that this query nests together two queries. An inner query is used by
    an outer query.
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这个查询嵌套了两个查询。内部查询被外部查询使用。
- en: '`JOIN`s'
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`JOIN`s'
- en: We are pulling data from `shows` and `ratings`. Notice how both `shows` and
    `ratings` have an `id` in common.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们正在从`shows`和`ratings`表中获取数据。注意`shows`和`ratings`都有一个共同的`id`。
- en: How could we combine tables temporarily? Tables could be joined together using
    the `JOIN` command.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们如何临时合并表？可以使用`JOIN`命令将表连接在一起。
- en: 'Execute the following command:'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行以下命令：
- en: '[PRE15]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Notice this results in a wider table than we have previously seen.
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这会产生一个比我们之前看到的更宽的表。
- en: 'Where the previous queries have illustrated the *one-to-one* relationship between
    these keys, let’s examine some *one-to-many* relationships. Focusing on the `genres`
    table, execute the following:'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在之前的查询中已经展示了这些键之间的*一对一*关系，让我们来检查一些*一对多*关系。关注`genres`表，执行以下命令：
- en: '[PRE16]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Notice how this provides us a sense of the raw data. You might notice that one
    show has three values. This is a one-to-many relationship.
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这为我们提供了对原始数据的感觉。你可能注意到一个节目有三个值。这是一个一对多关系。
- en: We can learn more about the `genres` table by typing `.schema genres`.
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过输入`.schema genres`，我们可以了解更多关于`genres`表的信息。
- en: 'Execute the following command to learn more about the various comedies in the
    database:'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行以下命令来了解更多关于数据库中各种喜剧的信息：
- en: '[PRE17]'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Notice how this produces a list of comedies, including *Catweazle*.
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这产生了一个包括*猫怪*在内的喜剧列表。
- en: 'To learn more about Catweazle, by joining various tables through a join:'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要了解更多关于Catweazle的信息，可以通过连接各种表来实现：
- en: '[PRE18]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Notice that this results in a temporary table. It is fine to have a duplicate
    table.
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这会产生一个临时表。拥有一个重复的表是可以的。
- en: In contrast to one-to-one and one-to-many relationships, there may be *many-to-many*
    relationships.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与一对一和一对多关系相比，可能存在*多对多*关系。
- en: 'We can learn more about the show *The Office* and the actors in that show by
    executing the following command:'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过执行以下命令，我们可以了解更多关于节目*办公室*及其演员的信息：
- en: '[PRE19]'
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Notice that this results in a table that includes the names of various stars
    through nested queries.
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，这会产生一个包含通过嵌套查询的各种明星名字的表。
- en: 'We find all the shows in which Steve Carell starred:'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们找到史蒂夫·卡瑞尔主演的所有节目：
- en: '[PRE20]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This results in a list of titles of shows wherein Steve Carell starred.
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这会产生一个史蒂夫·卡瑞尔主演的节目标题列表。
- en: 'This could also be expressed in this way:'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这也可以用这种方式表达：
- en: '[PRE21]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The wildcard `%` operator can be used to find all people whose names start with
    `Steve C` one could employ the syntax `SELECT * FROM people WHERE name LIKE 'Steve
    C%';`.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用通配符`%`运算符来查找所有名字以`Steve C`开头的人，可以使用以下语法：`SELECT * FROM people WHERE name
    LIKE 'Steve C%';`。
- en: Indexes
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 索引
- en: While relational databases have the ability to be faster and more robust than
    utilizing a `CSV` file, data can be optimized within a table using *indexes*.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虽然关系数据库比使用`CSV`文件具有更快和更健壮的能力，但可以使用*索引*在表中优化数据。
- en: Indexes can be utilized to speed up our queries.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 索引可以被用来加速我们的查询。
- en: We can track the speed of our queries by executing `.timer on` in `sqlite3`.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过在`sqlite3`中执行`.timer on`来跟踪查询的速度。
- en: 'To understand how indexes can speed up our queries, run the following: `SELECT
    * FROM shows WHERE title = ''The Office'';` Notice the time that displays after
    the query executes.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要了解索引如何加速查询，运行以下命令：`SELECT * FROM shows WHERE title = 'The Office';`注意查询执行后显示的时间。
- en: Then, we can create an index with the syntax `CREATE INDEX title_index ON shows
    (title);`. This tells `sqlite3` to create an index and perform some special under-the-hood
    optimization relating to this column `title`.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后，我们可以使用以下语法创建索引：`CREATE INDEX title_index ON shows (title);`。这告诉`sqlite3`创建一个索引并对此列`title`进行一些特殊的底层优化。
- en: This will create a data structure called a *B Tree*, a data structure that looks
    similar to a binary tree. However, unlike a binary tree, there can be more than
    two child nodes.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这将创建一个名为*B树*的数据结构，其外观类似于二叉树。然而，与二叉树不同，可以有超过两个子节点。
- en: '![one node at the top from which come four children and below that there are
    three children coming from one of the nodes and two from another two from another
    and three from another](../Images/598c84c68623b872e9ac7d6958e4e8d5.png "b tree")'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![从顶部有一个节点，该节点有四个子节点，下面有三个子节点来自一个节点，两个来自另一个节点，另外两个来自另一个节点，三个来自另一个节点](../Images/598c84c68623b872e9ac7d6958e4e8d5.png
    "b tree")'
- en: 'Further, we can create indexes as follows:'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，我们可以创建索引如下：
- en: '[PRE22]'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Running the query and you will notice that the query runs much more quickly!
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行查询后，你会注意到查询运行得更快！
- en: '[PRE23]'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Unfortunately, indexing all columns would result in utilizing more storage space.
    Therefore, there is a tradeoff for enhanced speed.
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不幸的是，索引所有列将导致使用更多的存储空间。因此，在提高速度和存储空间之间有一个权衡。
- en: Using SQL in Python
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Python中使用SQL
- en: 'To assist in working with SQL in this course, the CS50 Library can be utilized
    as follows in your code:'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了帮助在这个课程中处理SQL，可以在你的代码中使用CS50库如下：
- en: '[PRE24]'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Similar to previous uses of the CS50 Library, this library will assist with
    the complicated steps of utilizing SQL within your Python code.
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与之前对CS50库的使用类似，这个库将帮助你在Python代码中利用SQL的复杂步骤。
- en: You can read more about the CS50 Library’s SQL functionality in the [documentation](https://cs50.readthedocs.io/libraries/cs50/python/#cs50.SQL).
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以在[文档](https://cs50.readthedocs.io/libraries/cs50/python/#cs50.SQL)中了解更多关于CS50库的SQL功能。
- en: Using our new knowledge of SQL, we can now leverage Python alongside.
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用我们对SQL的新知识，我们现在可以利用Python。
- en: 'Modify your code for `favorites.py` as follows:'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照以下方式修改你的`favorites.py`代码：
- en: '[PRE25]'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Notice that `db = SQL("sqlite:///favorites.db")` provides Python the location
    of the database file. Then, the line that begins with `rows` executes SQL commands
    utilizing `db.execute`. Indeed, this command passes the syntax within the quotation
    marks to the `db.execute` function. We can issue any SQL command using this syntax.
    Further, notice that `rows` is returned as a list of dictionaries. In this case,
    there is only one result, one row, returned to the rows list as a dictionary.
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，`db = SQL("sqlite:///favorites.db")`为Python提供了数据库文件的位置。然后，以`rows`开头的行执行使用`db.execute`的SQL命令。确实，这个命令将引号内的语法传递给`db.execute`函数。我们可以使用这种语法发出任何SQL命令。此外，注意`rows`作为字典列表返回。在这种情况下，只有一个结果，一行，作为字典返回到`rows`列表中。
- en: Race Conditions
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 竞争条件
- en: Utilization of SQL can sometimes result in some problems.
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有时使用SQL可能会导致一些问题。
- en: You can imagine a case where multiple users could be accessing the same database
    and executing commands at the same time.
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以想象一个场景，多个用户可能同时访问同一个数据库并执行命令。
- en: This could result in glitches where code is interrupted by other people’s actions.
    This could result in a loss of data.
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这可能导致代码被其他人的行为中断，从而造成数据丢失。
- en: Built-in SQL features such as `BEGIN TRANSACTION`, `COMMIT`, and `ROLLBACK`
    help avoid some of these race condition problems.
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内置的SQL功能如`BEGIN TRANSACTION`、`COMMIT`和`ROLLBACK`有助于避免一些这些竞争条件问题。
- en: SQL Injection Attacks
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SQL注入攻击
- en: Now, still considering the code above, you might be wondering what the `?` question
    marks do above. One of the problems that can arise in real-world applications
    of SQL is what is called an *injection attack*. An injection attack is where a
    malicious actor could input malicious SQL code.
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在，仍然考虑上面的代码，你可能想知道上面的`?`问号的作用。在SQL的现实中应用中可能出现的一个问题是所谓的*注入攻击*。注入攻击是指恶意行为者可以输入恶意的SQL代码。
- en: 'For example, consider a login screen as follows:'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如，考虑以下登录界面：
- en: '![harvard key login screen with username and password fields](../Images/00733a7c68233a83f89dbddf3dff3920.png
    "harvard key login screen")'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![哈佛密钥登录界面，包含用户名和密码字段](../Images/00733a7c68233a83f89dbddf3dff3920.png "harvard
    key login screen")'
- en: 'Without the proper protections in our own code, a bad actor could run malicious
    code. Consider the following:'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果在我们的代码中没有适当的安全措施，恶意行为者可以运行恶意代码。考虑以下：
- en: '[PRE26]'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Notice that because the `?` is in place, validation can be run on `favorite`
    before it is blindly accepted by the query.
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，因为`?`符号的位置，在查询盲目接受之前，可以在`favorite`上运行验证。
- en: You never want to utilize formatted strings in queries as above or blindly trust
    the user’s input.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你永远不希望在查询中使用上述格式化的字符串或盲目信任用户的输入。
- en: Utilizing the CS50 Library, the library will *sanitize* and remove any potentially
    malicious characters.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用CS50库，该库将*净化*并移除任何潜在的恶意字符。
- en: Summing Up
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: In this lesson, you learned more syntax related to Python. Further, you learned
    how to integrate this knowledge with data in the form of flat-file and relational
    databases. Finally, you learned about *SQL*. Specifically, we discussed…
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节课中，你学习了更多与Python相关的语法。此外，你学习了如何将这一知识整合到以平面文件和关系数据库形式存在的数据中。最后，你了解了*SQL*。具体来说，我们讨论了…
- en: Flat-file databases
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平面文件数据库
- en: Relational databases
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关系数据库
- en: SQL commands such as `SELECT`, `CREATE`, `INSERT`, `DELETE`, and `UPDATE`.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如 `SELECT`、`CREATE`、`INSERT`、`DELETE` 和 `UPDATE` 等SQL命令。
- en: Primary and foreign keys
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主键和外键
- en: '`JOIN`s'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`JOIN`s'
- en: Indexes
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 索引
- en: Using SQL in Python
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Python中使用SQL
- en: Race conditions
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 竞态条件
- en: SQL injection attacks
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SQL注入攻击
- en: See you next time!
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 次次见！
