# 4\.   渐近逼近

> 原文：[`aofa.cs.princeton.edu/40asymptotic`](https://aofa.cs.princeton.edu/40asymptotic)

本章探讨了导出问题的近似解或近似精确解的方法，这些方法使我们能够在分析算法时对感兴趣的数量进行*简洁*和*精确*的估计。

## 4.1 渐近逼近符号

以下符号，至少可以追溯到本世纪初，被广泛用于对函数的近似值进行精确陈述：

**定义。** 给定一个函数 $f(N)$，我们写

+   $g(N)=O(f(N))$ 当且仅当 $|g(N)/f(N)|$ 作为 $N\to\infty$ 时被上界限制

+   若 $g(N)=o(f(N))$ 当且仅当 $g(N)/f(N)\to 0$ 当 $N\to\infty$ 时

+   $g(N)\sim f(N)$ 当且仅当 $g(N)/f(N)\to 1$ 当 $N\to\infty$ 时。

$O$-和$o$-符号提供了表达上界（$o$ 是更强的断言）的方法，而 $\sim$-符号提供了表达渐近等价的方法。

在算法分析中，我们避免直接使用诸如“这个数量的平均值是 $O{f(N)}$”这样的用法，因为这对于预测性能而言提供的信息很少。相反，我们努力使用 $O$-符号来限定“误差”项，这些项的值远小于主要或“主导”项。非正式地说，我们期望所涉及的项应该足够小，以至于在 $N$ 很大时可以忽略不计。

*$O$-逼近.* 我们说 $g(N)=f(N)+O(h(N))$ 表示我们可以通过计算 $f(N)$ 来近似 $g(N)$，并且误差将在 $h(N)$ 的一个常数因子范围内。通常情况下，与 $O$-符号一样，涉及的常数是未指定的，但通常可以合理假设它不大。正如下文所讨论的，我们通常将此符号与 $h(N)=o(f(N))$ 一起使用。

*$o$-逼近.* 更强的陈述是说 $g(N)=f(N)+o(h(N))$ 表示我们可以通过计算 $f(N)$ 来近似 $g(N)$，并且随着 $N$ 的增大，误差相对于 $h(N)$ 会变得越来越小。涉及到一个未指定的函数来描述减小的速率，但通常可以合理假设它在数值上从不大（即使对于小的 $N$）。 

*$\sim$-逼近.* 符号 $g(N)\sim f(N)$ 用于表示最弱的非平凡 $o$-逼近 $g(N)=f(N)+o(f(N))$。

这些符号很有用，因为它们可以在不损失数学严谨性或精确结果的情况下抑��不重要的细节。如果需要更准确的答案，可以获得，但大部分详细计算通常被抑制。我们最感兴趣的是能够保持这种“潜在精度”的方法，产生的答案如果需要可以计算到任意精度。

*线性递归的渐近性.* 线性递归提供了渐近性的实用示例。任何线性递归序列 $\{a_n\}$ 都有一个有理 OGF，并且是形如 $\beta^{n}n^{j}$ 的项的线性组合。从渐近的角度来看，只需要考虑少数几个项，因为具有较大 $\beta$ 的项会指数级地支配具有较小 $\beta$ 的项。例如，对于 $$a_n=5a_{n-1}-6a_{n-2}\qquad\hbox{对于 $n>1$，其中 $a_0=0$ 且 $a_1=1$}$$ 的精确解是 $3^n-2^n$，但是近似解 $3^n$ 对于 $n>25$ 的精度在千分之一的范围内。我们只需要跟踪与绝对值或模最大的项有关的项。

**定理 4.1**（线性递归的渐近性）。假设有一个有理生成函数 $f(z)/g(z)$，其中 $f(z)$ 和 $g(z)$ 互质且 $g(0)\ne0$，具有最小模的唯一极点 $1/\beta$（即，$g(1/\alpha)=0$ 且 $\alpha\ne\beta$ 意味着 $|1/\alpha|>|1/\beta|$，或 $|\alpha|

## 4.2 渐近展开。

我们更喜欢方程$f(N)=c_0g_0(N)+O(g_1(N))$，其中$g_1(N)=o(g_0(N))$，而不是方程$f(N)=O(g_0(N))$，因为它提供了常数$c_0$，因此允许我们提供随着$N$变大而精度提高的具体估计。

由庞加莱发展的*渐近展开*概念推广了这个概念：

**定义.** 给定一系列函数$\{g_k(N)\}_{k\ge0}$，其中$g_{k+1}(N)=o(g_k(N))$对于$k\ge0$，$$f(N)\sim c_0g_0(N)+c_1g_1(N)+c_2g_2(N)+\ldots$$ 被称为$f$的渐近级数，或$f$的渐近展开。渐近级数代表了以下公式的集合 $$\eqalign{ f(N)&=O(g_0(N))\cr f(N)&=c_0g_0(N)+O(g_1(N))\cr f(N)&=c_0g_0(N)+c_1g_1(N)+O(g_2(N))\cr f(N)&=c_0g_0(N)+c_1g_1(N)+c_2g_2(N)+O(g_3(N))\cr &\hskip5pt\vdots\cr}$$，$g_k(N)$被称为*渐近尺度*。

这种一般方法允许用*任何*递减的函数无限级数来表达渐近展开（在$o$-记法意义上）。然而，我们通常对一组非常有限的函数感兴趣：事实上，当近似函数随着$N$增加而近似时，我们往往能够用$N$的递减幂来表达近似。偶尔需要其他函数，但通常我们会满足于由$N$、$\log N$、迭代对数（如$\log\log N$）和指数的幂乘积递减级数项组成的渐近尺度。

从渐近级数中取出的每个额外项都会给出更准确的渐近估计。在算法分析中常见的许多函数都有完整的渐近级数，我们主要考虑的方法是可以扩展的，原则上可以提供描述感兴趣量的渐近展开。我们可以使用$\sim$-记法简单地省略错误项的信息，或者使用$O$-记法或$o$-记法提供更具体的信息。

这个表格给出了从截断泰勒级数导出的四个基本函数的经典渐近展开。其他类似的展开可以立即从第三章中给出的生成函数中得到。在接下来的章节中，我们描述了使用这些展开操作渐近级数的方法。

| 函数 | 渐近展开 |
| --- | --- |
| 指数 | $\displaystyle e^x=1+x+{x²\over2}+{x³\over6}+O(x⁴)$ |
| 对数 | $\displaystyle\ln(1+x)=x-{x²\over2}+{x³\over3}+O(x⁴)$ |
| 二项式 | $\displaystyle(1+x)^k=1+kx+{k\choose2}x²+{k\choose3}x³+O(x⁴)$ |
| 几何 | $\displaystyle{1\over1-x}=1+x+x²+x³+O(x⁴)$ |

*例子.* 对于$N\to\infty$，展开$\ln(N-2)$，提取主导项，写成 $$\ln(N-2) = \ln N + \ln(1-{2\over N}) = \ln N - {2\over N} +O({1\over N²}).$$ 即，我们使用替换（$x = -2/N$），其中$x\to0$。

*非收敛的渐近级数.* 任何收敛级数都会导致完整的渐近近似，但非常重要的是要注意，反之*不*成立---渐近级数很可能是发散的。例如，我们可能有一个函数 $$f(N)\sim\sum_{k\ge0}{k!\over N^k}$$ 意味着（例如） $$f(N)=1+{1\over N}+{2\over N²}+{6\over N³}+O({1\over N⁴})$$ 即使无限和不收敛。为什么允许这样？如果我们从展开中取任意固定数量的项，那么从定义中暗示的相等在$N\to\infty$时是有意义的。也就是说，我们有无限数量的更好和更好的近似，但它们开始提供有用信息的点变得越来越大。

这个表格给出了在组合学和算法分析中经常遇到的特殊数列的渐近级数。我们稍后考虑许多这些展开作为操作和推导渐近级数的例子。我们在本书后面经常提到它们，因为这些数列在研究算法属性时自然产生。

| 函数 | 渐近展开 |
| --- | --- |
| 阶乘（斯特林公式） | $\displaystyle N!=\sqrt{2\pi N}\Bigl({N\over e}\Bigr)^N\Bigl(1+{1\over12N}+{1\over288N²}+O({1\over N³})\Bigr)$ |
| 斯特林公式的对数版本 | $\qquad\displaystyle \ln N!=\Bigl(N+{1\over2}\Bigr)\ln N -N + \ln\sqrt{2\pi}+{1\over 12N}+O({1\over N³})\qquad$ |
| 谐和数 | $\displaystyle H_N=\ln N + \gamma + {1\over2N} -{1\over12N²}+O({1\over N⁴})$ |
| 二项式系数 | $\displaystyle {N\choose k}={N^k\over k!}\Bigl(1+O({1\over N})\Bigr)\quad{\rm for\ }k=O(1)$ |
| 二项式系数（中心） | $\displaystyle {N\choose k}={2^N\over\sqrt{\pi N/2}}\Bigl(1+O({1\over N})\Bigr)\quad\hbox{for\ }k={N\over2}+O(1)$ |
| 二项分布的正态近似 | $\displaystyle {2N\choose N- k}{1\over 2^{2N}}={e^{-{k²/N}}\over\sqrt{\pi N}} + O({1\over N^{3/2}})$ |
| 二项分布的泊松近似 | $\displaystyle{N\choose k}p^k(1-p)^{N-k}={\lambda^ke^{-\lambda}\over k!}+o(1)\quad{\rm for\ }p = \lambda/N$ |
| 第一类斯特林数 | $\displaystyle {N\brack k}\sim{(N-1)!\over (k-1)!}(\ln N)^{k-1} \quad{\rm for\ } k = O(1)$ |
| 第二类斯特林数 | $\displaystyle {N\brace k}\sim{k^N\over k!}\quad{\rm for\ } k = O(1)$ |
| 伯努利数 | $\displaystyle B_{2N}=(-1)^{N}{(2N)!\over(2\pi)^{2N}}(-2+O(4^{-N}))$ |
| 卡特兰数 | $\displaystyle T_N\equiv{1\over N+1}{2N\choose N}={4^N\over\sqrt{\pi N³}}\Bigl(1 + O({1\over N})\Bigr)$ |
| 斐波那契数 | $\displaystyle F_N={\phi^N\over\sqrt5}+O({\phi^{-N}}) \quad{\rm where\ }\phi={1+\sqrt5\over2}$ |

## 4.3 操纵渐近展开

渐近展开的操作通常简化为应用几种基本操作之一，我们依次考虑这些操作。在示例中，我们通常会考虑具有一、两或三项（不计算$O$项）的级数。当然，这些方法也适用于更长的级数。

*简化.* 渐近级数的好坏取决于其$O$项，因此任何更小的（在渐近意义上）都可以舍弃。例如，表达式$\ln N + O(1)$在数学上等价于表达式$\ln N + \gamma + O(1)$，但更简单。

*替换.* 最简单和最常见的渐近级数来自于将适当选择的变量值代入泰勒级数展开或其他渐近级数中。例如，在几何级数中取$x=-1/N$，得到$${1\over 1-x}=1+x+x²+O({x³})\qquad\hbox{as $x\to0$}$$可得$${1\over N+1}={1\over N}-{1\over N²}+ O({1\over N³})\qquad\hbox{as $N\to\infty$}.$$ 类似地，$$e^{1/N}= 1+{1\over N}+{1\over 2N²}+{1\over 6N³}+\cdots+ {1\over k!N^k} + O({1\over N^{k+1}}).$$

*因式分解.* 当函数的“近似”值在检查时显而易见时，将函数重写为相对或绝对误差的显式形式是值得的。例如，函数$1/(N²+N)$对于大的$N$显然非常接近$1/N²$，我们可以通过写成$$\eqalign{{1\over N²+N}&={1\over N²}{1\over 1+1/N}\cr &={1\over N²}\Bigl(1+{1\over N}+O({1\over N²})\Bigr)\cr &={1\over N²}+{1\over N³}+O({1\over N⁴}).\cr}$$来明确表达。当近似值不明显时，可能需要进行简短的试错过程。

*乘法.* 将两个渐近级数相乘只是逐项相乘，然后收集项。例如，$$\eqalign{ (H_N)²&=\Bigl(\ln N+\gamma+ O({1\over N})\Bigr) \Bigl(\ln N+\gamma+O({1\over N})\Bigr)\cr &=\Bigl((\ln N)²+\gamma\ln N+O({\log N\over N})\Bigr)\cr &\qquad+\Bigl(\gamma\ln N+\gamma²+O({1\over N})\Bigr)\cr &\qquad+\Bigl(O({\log N\over N})+O({1\over N})+O({1\over N²})\Bigr)\cr &=(\ln N)²+2\gamma\ln N+\gamma²+O({\log N\over N}).\cr}$$

在这种情况下，乘积的绝对渐近精度比因子低—结果仅准确到$O({\log N/N})$。这是正常的，通常我们需要以比结果中所需的更多项开始渐近展开的推导。通常，我们使用两步过程：进行计算，如果答案精度不够，则更准确地表达原始组件并重复计算。

*除法.* 为了计算两个渐近级数的商，我们通常会将分母因式分解并重写为形式$1/(1-x)$，其中$x$是趋近于 0 的符号表达式，然后展开为几何级数，并相乘。例如，要计算$\tan x$的渐近展开，我们可以将$\sin x$的级数除以$\cos x$的级数，如下所示：$$\eqalign{ \tan x = {\sin x\over\cos x} &= {x - x³/6 +O({x⁵})\over 1 - x²/2 +O({x⁴})}\cr &= \Bigl(x - x³/6 +O({x⁵})\Bigr){1\over 1 - x²/2 +O({x⁴})}\cr &= \Bigl(x - x³/6 +O({x⁵})\Bigr)({1 + x²/2 +O({x⁴})})\cr &= x + x³/3 +O({x⁵}).\cr }$$

*指数/对数.* 将$f(x)$写为$\exp\{\ln(f(x))\}$通常是处理涉及幂次或乘积的渐近的方便起点。一个标准例子是以下对$e$的近似：$$\eqalign{ \Bigl(1+{1\over N}\Bigr)^N &= \exp\Bigl\{N\ln\Bigl(1 + {1\over N}\Bigr)\Bigr\}\cr &= \exp\Bigl\{N\Bigl({1\over N} + O({1\over N²}) \Bigr)\Bigr\} \cr &= \exp\Bigl\{1 + O({1\over N})\Bigr\}\cr &= e + O({1\over N}).\cr }$$

## 4.4 有限和的渐近逼近

经常情况下，我们能够将一个量表达为有限和，因此需要准确估计总和的值。有些总和可以精确计算。在更多情况下，精确值不可用，或者我们只能对被求和的量本身进行估计。

*尾部估计.* 当有限和中的项迅速减少时，可以通过用无限和近似总和并开发对无限尾部大小的界限来开发渐近估计。

> *例子（错位）。*
> 
> $$N!\sum_{0\le k\le N}{(-1)^k\over k!} = N!e^{-1} - R_N \quad\hbox{where}\quad R_N= N!\sum_{k>N}{(-1)^k\over k!}.$$ 通过限制各项来限制尾部$R_N$：$$|R_N|
> 
> *例子（尝试）。*
> 
> $$\sum_{1\le k\le N}{1\over 2^k-1} = \sum_{k\ge 1}{1\over 2^k-1} - R_N, \quad\hbox{where}\quad R_N=\sum_{k>N}{1\over 2^k-1}.$$ 常数$1 + 1/3 + 1/7 + 1/15 + \ldots = 1.6066\cdots$ 是对有限和的极好近似（可以轻松计算到任意精度），因为$R_N < \sum_{k>N}{1/2^{k-1}}=1/2^{N-1}.$

*利用尾部.* 当有限和中的项迅速增加时，通常最后一项就足以给出整个总和的良好渐近估计。

> *例子。*
> 
> $$\sum_{0\le k\le N} k! = N!\Bigl(1+{1\over N}+\sum_{0\le k\le N-2}{k!\over N!}\ \Bigr) = N!\Bigl(1+O({1\over N})\Bigr),$$ 因为总和中有$N-1$个项，每个项都小于$1/(N(N-1))$。

*用积分近似总和.* 当我们使用$$\int_a^b {f(x)}dx\quad\hbox{来估计}\quad\sum_{a\le k < b} {f(k)}$$时，所产生的误差有多大？这个问题的答案取决于函数$f(x)$的“平滑性”。在$a$和$b$之间的每个单位间隔中，我们使用$f(k)$来估计$f(x)$。让$\delta_k = \max_{k\le x < k+1}|f(x)-f(k)|$表示每个间隔中的最大误差，我们可以粗略估计总误差：$$\sum_{a\le k < b} {f(k)}=\int_a^b {f(x)}dx + \Delta, \qquad\hbox{其中\ }|\Delta|\le\sum_{a\le k < b}\delta_k.$$ 如果函数在整个区间$[a,\/b]$上单调增或单调减，则误差项简化为$\Delta \le |f(a)-f(b)|$。

> *例子（调和数）。*
> 
> $$H_N=\sum_{1\le k\le N}{1\over k} = \int_1^N{1\over x}dx + \Delta = \ln N + \Delta$$ 其中$|\Delta| \le 1-1/N$，一个简单的证明$H_N\sim\ln N$。
> 
> *例子（斯特林逼近（对数形式））。*
> 
> $$\ln N!=\sum_{1\le k\le N}{\ln k}= \int_1^N{\ln x}\,dx + \Delta = N\ln N - N +1+ \Delta$$，其中$|\Delta|\le\ln N$，一个简单的证明$\ln N!\sim N\ln N - N$。

误差项的更精确估计取决于函数的导数。这是下一节的主题。

## 4.5 欧拉-麦克劳林求和。

渐近分析中最强大的工具之一可以追溯到 18 世纪，使我们能够以两种不同的方式用积分近似求和。

+   函数在固定区间上定义，我们评估对应于在区间上沿着越来越多的点采样函数的和，步长越来越小，求和与积分之间的差异收敛于零（就像经典的黎曼积分）。

+   步长固定，因此积分区间变得越来越大，求和与积分之间的差异收敛到一个常数。

我们分别考虑这两种情况（尽管它们都体现了相同的基本方法）。

**定理 4.2**（欧拉-麦克劳林求和公式，第一形式）。设$f(x)$是定义在区间$[\,a,\,b\,]$上的函数，其中$a$和$b$是整数，并假设导数$f^{(i)}(x)$对$1\le i\le 2m$存在且连续，其中$m$是一个固定常数。那么$$\sum_{a\le k\le b} {f(k)} = \int_a^b {f(x)}dx +{f(a)+f(b)\over2} +\sum_{1\le i\le m}{B_{2i} \over (2i)!} f^{(2i-1)} (x)\bigm|_a^b + R_{m}，$$ 其中$B_{2i}$是伯努利数，$R_{m}$是一个满足$$|R_{m}|\le{|B_{2m}|\over(2m)!}\int_a^b|f^{(2m)}(x)|dx**定理 4.3**（欧拉-麦克劳林求和公式，第二形式）。设$f(x)$是定义在区间$\,1,\,\infty\,)$上的函数，并假设导数$f^{(i)}(x)$对$1\le i\le 2m$存在且绝对可积，其中$m$是一个固定常数。那么$$\sum_{1\le k\le N} {f(k)} = \int_1^N {f(x)}dx +{1\over2}f(N)+C_f + \sum_{1\le k\le m}{B_{2k} \over (2k)!} f^{(2k-1)} (N) + R_{m}，$$ 其中$C_f$是与函数相关的常数，$R_{2m}$是一个满足$$|R_{2m}|=O\Bigl(\int_N^\infty|f^{(2m)}(x)|dx\Bigr)。$$

> *例子（调和数）。*
> 
> 取$f(x)=1/x$。这种情况下的欧拉-麦克劳林常数被简单地称为*欧拉常数*：$$\gamma = {1\over2}-\int_1^\infty\Bigl(\{x\}-{1\over2}\Bigr){dx\over x²}。$$ 因此$$H_N=\ln N + \gamma +o(1)。$$ 常数$\gamma$约为$.57721\cdots$，并不是其他基本常数的简单函数。完整的展开为$$H_N \sim \ln N + \gamma + {1\over 2N} - {1\over12N²} + {1\over120N⁴}-\ldots。
> 
> *例子（斯特林逼近（对数形式））。*
> 
> 令$f(x)=\ln x$，得到$\ln N!$的斯特林逼近。在这种情况下，欧拉-麦克劳林常数为$$\int_1^\infty\Bigl(\{x\}-{1\over2}\Bigr){dx\over x}.$$ 这个常数*确实*是其他基本常数的一个简单函数：它等于$\ln\sqrt{2\pi}-1$。数值$\sigma=\sqrt{2\pi}$被称为*斯特林常数*。它在算法分析和许多其他应用中经常出现。因此$$\ln N!=N\ln N - N +{1\over2}\ln N + \ln\sqrt{2\pi} +o(1)。$$ 完整的展开为$$\ln N! \sim (N+{1\over 2}) \ln N - N + \ln\sqrt{2\pi}+{1\over 12N}-{1\over360\ N³}+\ldots$$，通过指数化和基本操作得到$$N! \sim \sqrt{2\pi N}\Bigl({N\over e}\Bigr)^N\Bigl(1+{1\over12N}+{1\over288N^\ 2}-{139\over5140 N³}+\ldots\Bigr)。

## 4.6 双变量渐近。

此表左侧的双变量函数在组合数学和算法分析中至关重要。右侧是对所有$k$值都成立的*均匀*逼近（见证明文本）。

| 函数 | 定义 | 均匀逼近 |
| --- | --- | --- |
| 拉马努金 Q | $$N!\over(N-k)!N^k$$ | $$e^{ -{k²/(2N)}} + O({1\over\sqrt{N}})$$ |
| 拉马努金 R | $$N!N^k\over (N+k)!$$ | $$e^{ -{k²/(2N)}} + O({1\over\sqrt{N}})$$ |
| 正态近似 | $${2N\choose N-k}={(2N)!\over (N+k)!(N-k)!}$$ | $${e^{ -{k²/N}}\over\sqrt{\pi N}} + O({1\over N^{3/2}})$$ |
| 泊松近似 | $${N\choose k}\Bigl({\lambda\over N}\Bigr)^k\Bigl(1-{\lambda\over N}\Bigr)^{N-k}$$ | $${\lambda^ke^{-\lambda}\over k!}+o(1)$$ |

对于每个函数，我们还需要*中心*展开来近似最大项（对小的$k$有效），如下表所总结。

| 函数 | 中心展开 |
| --- | --- |
| 拉马努金 Q | $$e^{ -{k²/(2N)}}\Bigl(1 + O({k\over N})+O({k³\over N²})\Bigr) \quad{\rm for\ }k=o(N^{2/3})$$ |
| 拉马努金 R | $$e^{ -{k²/(2N)}}\Bigl(1 + O({k\over N})+O({k³\over N²})\Bigr) \quad{\rm for\ }k=o(N^{2/3})$$ |
| 正态近似 | $${e^{ -{k²/N}}\over\sqrt{\pi N}}\Bigl(1 + O({{1\over N}})+O({{k⁴\over N³}})\Bigr) \quad{\rm for\ }k=o(N^{3/4})$$ |
| 泊松近似 | $${\lambda^ke^{-\lambda}\over k!}\Bigl(1+O({1\over N})+O({k\over N})\Bigr) \quad{\rm for\ }k=o(N^{1/2})$$ |

对于每个函数，以下上界对所有$N$和$k$都有效。

| 函数 | 统一上界 |
| --- | --- |
| 拉马努金 Q | $$ e^{-k(k-1)/(2N)}$$ |
| 拉马努金 R | $$ e^{-k(k+1)/(4N)}$$ |
| 正态近似 | $$ e^{-k²/(2N)}$$ |

这种结果通常用于以以下方式限制分布的尾部。给定$\epsilon>0$，对于$k>\sqrt{2N^{1+\epsilon}}$，我们有，$$ {1\over 2^{2N}}{2N\choose N-k}\le e^{-{(2N)^{\epsilon}}}. $$ 也就是说，当$k$略微快于$\sqrt{N}$增长时，分布的尾部是指数级小的。

## 4.7 拉普拉斯方法

在估计整个范围内的求和时，我们希望利用我们在范围的不同部分获得准确估计的求和项的能力。另一方面，如果我们能在整个感兴趣的范围内坚持使用单个函数，那当然更方便。在本节中，我们讨论一种通用方法，允许我们同时做到这两点，即用于估计求和和积分值的*Laplace 方法*。我们经常在算法分析中遇到可以用这种方法估计的求和。通常情况下，我们也利用我们在这些情况下用积分近似求和的能力。该方法围绕以下三个步骤进行求和评估：

+   将范围限制在包含最大求和项的区域内。

+   近似求和项并限制尾部。

+   扩展范围并限制新的尾部，以获得一个更简单的求和。

这幅图以一种概要的方式说明了这种方法。实际上，在近似求和时，涉及的函数都是阶跃函数；通常在最后会出现一个“平滑”函数，应用欧拉-麦克劳林公式。

![

*例子（拉马努金 Q 函数）*。为了近似计算$$Q(N)\equiv\sum_{1\le k\le N} {N!\over (N-k)!N^k}$$，将刚才给出的近似应用于求和的不同范围。更准确地说，定义$k_0$为一个满足$o(N^{2/3})$的整数，并将求和分为两部分：$$\sum_{1\le k\le N} {N!\over (N-k)!N^k} = \sum_{1\le k\le k_0} {N!\over (N-k)!N^k} + \sum_{k_0 < k\le N} {N!\over (N-k)!N^k}.$$ 我们分别近似这两部分，利用两部分中对$k$的不同限制来优势。对于第一（主要）项，我们使用均匀近似。对于第二项（尾部），限制$k>k_0$和项是递减的事实意味着它们都是指数级小的。$$Q(N)=\sum_{1\le k\le k_0} e^{-k²/(2N)}\Bigl(1 + O({k\over N})+ O({k³\over N²})\Bigr)+\Delta.$$ 这里我们使用$\Delta$作为一个表示指数级小但未指定的项的符号。主要项$\exp(-k²/(2N)$对于$k>k_0$也是指数级小的，我们可以将$k>k_0$的项加回去，所以我们有$$Q(N)\,=\,\sum_{k\ge1}\,\,\,e^{-k²/(2N)} + O(1).$$ 本质上，我们用近似的尾部替换了原始求和的尾部，这是合理的，因为两者都是指数级小的。剩下的求和是函数$e^{x²/2}$在间隔为$1/\sqrt{N}$的点上的值的和。因此，欧拉-麦克劳林定理提供了近似$$\sum_{k\ge1}e^{-k²/(2N)}=\sqrt{N}\int_0^\infty e^{-{x²/2}}dx + O(1).$$ 这个积分的值是众所周知的$\sqrt{\pi/2}$。将其代入上述$Q(N)$的表达式得到结果$$Q(N) = \sqrt{\pi N/2} +O(1).$$

## 4.8 算法分析中的“正常”示例

## 4.9 "Poisson" 算法分析示例

## 4.10 生成函数渐近

#### 选择的练习

## 4.2

展示$$\displaystyle{N\over N+1}=1+O\Bigl({1\over N}\Bigr)\qquad\hbox{和}\qquad \displaystyle{N\over N+1}\sim 1-{1\over N}$$。

## 4.9

如果$\alpha 0$。对于$\beta=1.2$和$\alpha=1.1$，当$\alpha^N+\beta^N$被$\beta^N$近似时，找出$N=10$和$N=100$时的绝对误差和相对误差。

## 4.14

使用定理 4.1 找到递推式$$a_n=5a_{n-1}-8a_{n-2}+4a_{n-3}\qquad\hbox{对于$n>2$，其中$a_0=1$，$a_1=2$，$a_2=4$}$$的渐近解。将初始条件$a_0$和$a_1$更改为$a_0=1$和$a_1=2$后，解决相同的递推式。

## 4.15

使用定理 4.1 找到递推式$$a_n=2a_{n-2}-a_{n-4}\qquad\hbox{对于$n>4$，其中$a_0=a_1=0$，$a_2=a_3=1$}$$的渐近解。

## 4.16

使用定理 4.1 找到递推式$$a_n=3a_{n-1}-3a_{n-2}+a_{n-3}\qquad\hbox{对于$n>2$，其中$a_0=a_1=0$，$a_2=1$}$$的渐近解。

## 4.21

当$x\to0$时，将$\ln(1-x+x²)$展开为$O\bigl(x⁴\bigr)$。

## 4.23

给出$\displaystyle{N\over N-1}\ln {N\over N-1}$的渐近展开，精确到$\displaystyle O\bigl({1\over N⁴}\bigr)$。

## 4.38

计算$(3N)!/(N!)³$的渐近展开，精确到相对精度$\displaystyle\Bigl(1+ O({1\over N})\Bigr)$。

## 4.39

$\displaystyle\Bigl(1-{\lambda\over N}\Bigr)^N$的近似值是多少？

## 4.50

给出$\sum_{0\le k\le N}{2^k/(2^k+1)}$的渐近估计。

## 4.58

使用欧拉-麦克劳林求和估计$$\sum_{1\le k\le N}{\sqrt{k}},\qquad \sum_{1\le k\le N}{1\over\sqrt{k}},\quad\hbox{和}\quad \sum_{1\le k\le N}{1\over\root3\of{k}}$$，精确到$O\bigl(1/N²\bigr)$。

## 4.71

证明对于$k = o(N^{2/3})$，有$${(N-k)^k(N-k)!\over N!} = e^{ - {k²\over 2N}}\Bigl( 1 + O({k\over N}) + O({k³\over N²})\Bigr) $$. 通过与定理 4.5、4.8 的证明以及定理 4.4 的推论的相同论证，您可以将此推导扩展到证明$$ P(N)=\sum_{0\le k < N} {(N-k)^k(N-k)!\over N!}=\sqrt{\pi N/2}+O(1)$$

#### 复习问题

## Q4.1

分别给出以下各项的$O({1\over N})$的渐近展开：（*a*）$H_N$（*b*）$\exp(H_{2N} - H_N) - 1$（*c*）$\exp(H_N)$（*d*）$\exp({1\over N})$（*e*）$(1 - {1\over N})^{-1}$

## Q4.2

给出以下各项的值，保留三位小数：(*a*) $1.01^{10}$ (*b*) $1.05^{10}$ (*c*) $1.01^{20}$ (*d*) $1.01^{50}$ (*e*) $1.01^{100}$

## Q4.3

*不要使用计算机或计算器解决这个问题。* 对于下面的每个表达式，请从以下列表中给出最接近的值：1.716924, 1.000145, 1.000023, 1.010050, 1.00111, 1.000007, 1.007000\. $$e^{.01}$$ $$\ln(1000)/\ln(999)$$ $$1.001^{1000}-1$$ $$(100+\ln(100!))/(100\ln 100))$$ $$\ln(2.7183)$$

## Q4.4

(A. Yan) 给出${3N\choose N}$的渐近展开式，精确到$\Bigl(1 + O({1\over N})\Bigr)$。
