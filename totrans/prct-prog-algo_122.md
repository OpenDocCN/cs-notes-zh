# 3\. 生成函数

> 原文：[`aofa.cs.princeton.edu/30gf`](https://aofa.cs.princeton.edu/30gf)

本章介绍了算法分析和组合学中的一个核心概念：*生成函数* —— 这是算法研究对象和发现其性质所必需的分析方法之间的必要而自然的联系。

## 3.1 普通生成函数

在算法分析中，我们经常的目标是推导出一系列量 $a_0, a_1, a_2, \ldots$ 的特定表达式，这些量衡量了某些性能参数。在本章中，我们看到了使用代表整个序列的单个数学对象的好处。

**定义。** 给定一个序列 $a_0, a_1, a_2, \ldots, a_k, \ldots$，函数 $$A(z)=\sum_{k\ge0}a_k z^k$$ 被称为该序列的*普通生成函数（OGF）*。我们使用记号 $[z^k]A(z)$ 表示系数 $a_k$。

| 序列 | OGF |
| --- | --- |
| $$1,\,1,\,1,\,1,\,\ldots,\,1,\,\ldots$$ | $${1\over 1-z}=\sum_{N\ge0}z^N$$ |
| $$0,\,1,\,2,\,3,\,4,\,\ldots,\,N,\,\ldots$$ | $${z\over(1-z)²}=\sum_{N\ge1}Nz^N$$ |
| $$0,\,0,\,1,\,3,\,6,\,10,\,\ldots,\,{N\choose2},\,\ldots$$ | $${z²\over(1-z)³}=\sum_{N\ge2}{N\choose2}z^N$$ |
| $$0,\,\ldots,\,0,\,1,\,M+1,\,\ldots,\,{N\choose M},\,\ldots$$ | $${z^M\over(1-z)^{M+1}}=\sum_{N\ge M}{N\choose M}z^N$$ |
| $$1,\,M,\,{M\choose 2}\,\ldots,\,{M\choose N},\,\ldots,\,M,\,1$$ | $${(1+z)^M}=\sum_{N\ge0}{M\choose N}z^N$$ |
| $$1,\,M+1,\,{M+2\choose2},\,{M+3\choose3},\,\ldots$$ | $${1\over(1-z)^{M+1}}=\sum_{N\ge 0}{N+M\choose N}z^N$$ |
| $$1,\,0,\,1,\,0,\,\ldots,\,1,\,0,\,\ldots$$ | $${1\over 1-z²}=\sum_{N\ge0}z^{2N}$$ |
| $$1,\,c,\,c²,\,c³,\,\ldots,\,c^N,\,\ldots$$ | $${1\over1-cz}=\sum_{N\ge0}c^Nz^N$$ |
| $$1,\,1,\,{1\over2!},\,{1\over3!},\,{1\over4!},\,\ldots,\,{1\over N!},\,\ldots$$ | $$e^z=\sum_{N\ge0}{\displaystyle z^N\over N!}$$ |
| $$0,\,1,\,{1\over2},\,{1\over3},\,{1\over4},\,\ldots,\,{1\over N},\,\ldots$$ | $$\ln{1\over1-z}=\sum_{N\ge1}{\displaystyle z^N\over N}$$ |
| $$0,\,1,\,1+{1\over2},\,1+{1\over2}+{1\over3},\,\ldots,\,H_N,\,\ldots$$ | $${1\over1-z}\ln{1\over1-z}=\sum_{N\ge1}H_Nz^N$$ |
| $$0,\,0,\,1,\,3({1\over2}+{1\over3}),\,4({1\over2}+{1\over3}+{1\over4}),\,\ldots$$ | $${z\over(1-z)²}\ln{1\over1-z}=\sum_{N\ge0}N(H_N-1)z^N$$ |

给定代表序列 $a_0,a_1,\ldots,a_k,\ldots$ 和 $b_0,b_1,\ldots,b_k,\ldots$ 的生成函数 $A(z)=\sum_{k\ge0}a_kz^k$ 和 $B(z)=\sum_{k\ge0}b_kz^k$，我们可以进行一些简单的转换以获得其他序列的生成函数。

| 操作 | 结果 |
| --- | --- |
| *右移* | $$zA(z)=\sum_{n\ge1}a_{n-1}z^n$$ |
| *左移* | $${A(z)-a_0\over z}=\sum_{n\ge0}a_{n+1}z^n$$ |
| *指标乘法（微分）* | $$A^\prime(z)=\sum_{n\ge0}(n+1)a_{n+1}z^n$$ |
| *指标除法（积分）* | $$\int_0^zA(t)dt=\sum_{n\ge1}{a_{n-1}\over n}z^n$$ |
| *缩放* | $$A(\lambda z)=\sum_{n\ge0}\lambda^na_nz^n$$ |
| *加法* | $$A(z)+B(z)=\sum_{n\ge0}(a_n+b_n)z^n$$ |
| *差分* | $${(1-z)A(z)}=a_0+\sum_{n\ge1}(a_n-a_{n-1})z^n$$ |
| *卷积* | $${A(z)B(z)}=\sum_{n\ge0}\Bigl(\,\sum_{0\le k\le n}a_kb_{n-k}\Bigr)z^n$$ |
| *部分和* | $${A(z)\over1-z}=\sum_{n\ge0}\Bigl(\,\sum_{0\le k\le n}a_k\Bigr)z^n$$ |

## 3.2 指数生成函数

有些序列更方便地通过涉及归一化因子的生成函数处理：

**定义。** 给定一个序列 $a_0, a_1, a_2, \ldots, a_k, \ldots$，函数 $$A(z)=\sum_{k\ge0}a_k {z^k\over k!}$$ 被称为该序列的*指数生成函数（EGF）*。我们使用记号 $k![z^k]A(z)$ 表示系数 $a_k$。

| 序列 | EGF |
| --- | --- |
| $$1,\,1,\,1,\,1,\,\ldots,\,1,\,\ldots$$ | $$e^z=\sum_{N\ge0}{z^N\over N!}$$ |
| $$0,\,1,\,2,\,3,\,4,\,\ldots,\,N,\,\ldots$$ | $$ze^z=\sum_{N\ge1}{z^N\over(N-1)!}$$ |
| $$0,\,0,\,1,\,3,\,6,\,10,\,\ldots,\,{N\choose2},\,\ldots$$ | $${1\over2}z²e^z={1\over2}\sum_{N\ge2}{z^N\over(N-2)!}$$ |
| $$\qquad0,\,\ldots,\,0,\,1,\,M+1,\,\ldots,\,{N\choose M},\,\ldots\qquad$$ | $${1\over M!}z^Me^z={1\over M!}\sum_{N\ge M}{z^N\over(N-M)!}$$ |
| $$1,\,0,\,1,\,0,\,\ldots,\,1,\,0,\,\ldots$$ | $$\qquad{1\over2}(e^z+e^{-z})=\sum_{N\ge0}{1+(-1)^N\over2}{z^{N}\over N!}\qquad$$ |
| $$1,\,c,\,c²,\,c³,\,\ldots,\,c^N,\,\ldots$$ | $$e^{cz}=\sum_{N\ge0}{c^Nz^N\over N!}$$ |
| $$0,\,1,\,{1\over2},\,{1\over3},\,\ldots,\,{1\over N+1},\,\ldots$$ | $${\displaystyle e^z-1\over z}=\sum_{N\ge0}{\displaystyle z^N\over (N+1)!}$$ |
| $$1,\,2,\,6,\,24,\,\ldots,\,N!,\,\ldots$$ | $${\displaystyle 1\over 1-z}=\sum_{N\ge0}{\displaystyle N!z^N\over N!}$$ |

与 OGFs 一样，对这些基本函数进行简单操作可以得到实践中出现的大部分 EGFs。请注意，EGFs 的左/右移操作与 OGFs 的索引乘法/除法操作相同，反之亦然。

| 操作 | 结果 |
| --- | --- |
| *右移（积分）* | $$\int_0^zA(t)dt=\sum_{n\ge1}a_{n-1}{z^n\over n!}$$ |
| *左移（微分）* | $$A^\prime(z)=\sum_{n\ge0}a_{n+1}{z^n\over n!}$$ |
| *索引乘法* | $$zA(z)=\sum_{n\ge0}na_{n-1}{z^n\over n!}$$ |
| *索引除法* | $$(A(z)-A(0))/z=\sum_{n\ge1}{a_{n+1}\over n+1}{z^n\over n!}$$ |
| *加法* | $$A(z)+B(z)=\sum_{n\ge0}(a_n+b_n){z^n\over n!}$$ |
| *差分* | $$A^\prime(z)-A(z)=\sum_{n\ge0}(a_{n+1}-a_n){z^n\over n!}$$ |
| *二项式卷积* | $$\qquad{A(z)B(z)}=\sum_{n\ge0}\biggl(\>\sum_{0\le k\le n}{n\choose k}a_kb_{n-k}\biggr){z^n\over n!}\qquad$$ |
| *二项式求和* | $$e^zA(z)=\sum_{n\ge0}\biggl(\>\sum_{0\le k\le n}{n\choose k}a_k\biggr){z^n\over n!}$$ |

## 3.3 递归的生成函数解法

生成函数为解决许多递归关系提供了一种机械方法。给定描述某个序列$\{a_n\}_{n\ge0}$的递归，我们通常可以通过执行以下步骤来开发解决方案：

+   将递归的两边都乘以$z^n$并在$n$上求和。

+   评估求和以导出 OGF 满足的方程。

+   解方程以得出 OGF 的显式公式。

+   将 OGF 表示为幂级数以获得系数（原始序列的成员）的表达式。

相同的方法适用于 EGFs，其中我们在第一步中乘以$z^n/n!$并在$n$上求和。OGFs 或 EGFs 哪个更方便取决于递归。

*例子.* $$a_n=5a_{n-1}-6a_{n-2}\qquad\hbox{对于$n>1$，其中$a_0=0$且$a_1=1$}$$ 使用生成函数$a(z)=\sum_{n\ge0}a_nz^n$。将递归的两边都乘以$z^n$并在$n$上求和，得到方程$$a(z)={z\over 1-5z+6z²}={z\over(1-3z)(1-2z)}={1\over 1-3z}-{1\over 1-2z}$$（通过部分分式）因此我们必须有$a_n=3^n-2^n$。

一般来说，我们可以通过将生成函数$a(z)$表示为有理函数$f(z)/g(z)$，然后展开来解决线性递归$$a_n=x_1a_{n-1}+x_2a_{n-2}+\ldots+x_ta_{n-t}$$。

+   从递归中推导$g(z)$：$g(z)=1-x_1z-x_2z²-\ldots-x_tz^t$

+   从递归中计算$f(z)$得到$g(z)$和初始条件。

+   消除$f(z)/g(z)$中的公共因子。

+   使用部分分式将$f(z)/g(z)$表示为$(1-\beta z)^{-j}$形式的项的线性组合。

+   展开部分分式展开中的每一项，使用$$z^n^{-j}={n+j-1\choose j-1}\beta^n$$。

注意根可能是复数。

*例子.* $$a_n=2a_{n-1}-a_{n-2}+2a_{n-3}\qquad \hbox{对于$n>2$，其中$a_0=1$，$a_1=0$，$a_2=-1$}.$$ 这给出 $$g(z)=1-2z+z²-2z³=(1+z²)(1-2z)$$ 和 $$f(z)=(1-z⁴)(1-2z)\pmod{z⁴}=(1-2z),$$ 所以 $$a(z)={f(z)\over g(z)}={1\over1+z²}={1\over2}\Bigl({1\over1-iz}-{1\over1+iz}\Bigr),$$ 而 $a_n={1\over2}(i^n+(-i)^n)$。因此，$a_n$ 在$n$为奇数时为$0$，在$n$为 4 的倍数时为$1$，在 n 为偶数但不是 4 的倍数时为$-1$（这也直接从形式$a(z)=1/(1+z²)$得出）。对于初始条件$a_0=1$，$a_1=2$，和$a_2=3$，我们得到$f(z)=1$，因此解的增长类似于$2^n$，但由于复根引起的周期性变化项。

## 3.4 展开生成函数。

给定生成函数的显式函数形式，我们希望找到相关序列的一般机制。这个过程称为“展开”生成函数，因为我们将其从紧凑的函数形式转化为无限系列的项。许多函数可以通过泰勒定理的组合轻松处理 $$f(z)=f(0)+f^{\prime}(0)z+{f^{\prime\prime}(0)\over2!}z² +{f^{\prime\prime\prime}(0)\over 3!}z³ +{f^{\prime\prime\prime\prime}(0)\over 4!}z⁴+\ldots.$$ 和表格中给出的基本恒等式和变换的代数运算来处理。对于更复杂的函数，解析组合学的理论允许我们开发系数的近似而不展开。

## 3.5 生成函数的变换

## 3.6 生成函数上的函数方程

## 3.7 用 OGFs 解决快速排序中的中位数三分位数

## 3.8 生成函数计数

生成函数提供了一种系统计算组合对象的方法。为了说明，我们考虑一个经典的组合问题，它也对应于本书第五章和其他几个地方将要考虑的基本数据结构。*二叉树*是一种递归定义的结构，要么是单个*外部节点*，要么是连接到两个二叉树（*左子树*和*右子树*）的*内部节点*。二叉树出现在组合学和算法分析中的许多问题中：例如，如果内部节点对应于二元算术运算符，外部节点对应于变量，则二叉树对应于算术表达式。问题是，有多少具有$N$个外部节点的��叉树？！[](../Images/9c1f679c97023ff0260500192d36e032.png)

*计算二叉树（带有递归）。* 让$T_N$表示具有$N+1$个外部节点的二叉树的数量：$T_0=1$，$T_1=1$，$T_2=2$，$T_3=5$，和$T_4=14$。如果具有$N+1$个外部节点的二叉树中的左子树具有$k$个外部节点（有$T_{k-1}$个不同的这样的树），那么右子树必须具有$N-k+1$个外部节点（有$T_{N-k}$个可能性），因此$T_N$必须满足 $$T_N = \sum_{1\le k\le N}T_{k-1}T_{N-k} \qquad\hbox{对于$N>0$，其中$T_0=1$}.$$ 将其乘以$z^N$并在$N$上求和得到非线性函数方程 $$T(z)=zT(z)²+1.$$ 这很容易用二次方程解决： $$zT(z)={1\over2}(1\pm\sqrt{1-4z}).$$ 为了在$z=0$时得到相等，我们取带有负号的解。为了提取系数，使用具有指数$1\over2$的二项式定理（牛顿公式）： $$zT(z)=-{1\over2}\sum_{N\ge1}{{1\over2}\choose N}(-4z)^N.$$ 将系数设置为相等得到 $$\eqalign{T_N&=-{1\over2}{{1\over2}\choose N+1}(-4)^{N+1}\cr &=-{1\over2}{{1\over2}({1\over2}-1)({1\over2}-2)\ldots({1\over2}-N)(-4)^{N+1}\over (N+1)!}\cr &={1\cdot 3\cdot 5\cdots(2N-1)\cdot2^{N}\over (N+1)!}\cr &={1\over N+1}{1\cdot 3\cdot 5\cdots(2N-1)\over N!}\, {2\cdot 4\cdot 6\cdots2N\over1\cdot 2\cdot 3\,\cdots\,N\,}\cr &={1\over N+1}{2N\choose N}.\cr}$$

这些数字被称为*卡特兰数*。在下一章中，我们将看到近似值为$T_{N}\approx 4^N/N\sqrt{\pi N}$。

*计数二叉树（直接）。* 定义 ${\cal T}$ 为所有二叉树的集合，并采用记号 $|t|$ 表示 $t\in{\cal T}$ 时 $t$ 中内部节点的数量。 然后我们有以下推导： $$\eqalign{T(z)&=\sum_{t\in{\cal T}}z^{|t|}\cr &=1+\sum_{t_L\in{\cal T}}\sum_{t_R\in{\cal T}}z^{|t_L|+|t_R|+1}\cr &=1+zT(z)²\cr}$$ 第一行是从其定义中另一种表达 $T(z)$ 的方式。 每棵具有恰好 $k$ 个外部节点的树都会对 $z^k$ 的系数贡献 $1$，因此和式中 $z^k$ 的系数“计数”具有 $k$ 个内部节点的树的数量。 第二行来自于二叉树的递归定义：一个二叉树要么没有内部节点（这解释了 $1$），要么可以分解为两个独立的二叉树，其内部节点包括原始树的内部节点，再加上一个根节点。 第三行是因为索引变量 $t_L$ 和 $t_R$ 是独立的。 *仔细研究这个基本例子*，因为它是我们接下来考虑的一般框架的“招牌儿童”。

## 符号方法

*符号方法* 是将组合对象的形式定义转化为生成函数上的函数方程的强大方法。

*未标记的对象。* 在使用生成函数进行计数时，我们考虑组合对象的类别，每个对象都定义了一个“大小”的概念。 对于类别 $\cal A$，我们用 $a_n$ 表示大小为 $n$ 的类别的成员数量。 然后我们对 OGF 感兴趣 $$A(z)=\sum_{n\ge 0}a_nz^n=\sum_{a\in\cal A}z^{|a|}.$$ 给定两个组合对象类别 $\cal A$ 和 $\cal B$，我们可以用 *不相交并集* 运算 $\cal A +\cal B$ 将它们组合在一起，得到由 $\cal A$ 和 $\cal B$ 的成员的不相交副本组成的类别，用 *笛卡尔积* 运算 $\cal A \times\cal B$ 得到由对象的有序对（一个来自 $\cal A$，一个来自 $\cal B$）组成的类别，以及用 *序列* 运算得到由 $\cal A$ 的对象序列组成的类别。 这些构造性定义直接导致了生成函数 $A(z)$ 和 $B(z)$ 的以下函数关系。

+   $A(z)+B(z)$ 是枚举 $\cal A +\cal B$ 的 OGF

+   $A(z)B(z)$ 是枚举 $\cal A \times \cal B$ 的 OGF

+   $\displaystyle{1\over 1-A(z)}$ 是枚举 $\cal A$ 的对象序列的 OGF

*基本构件。* 组合构造最终源自这些起始点：

+   空类 $\phi$，OGF 为 $0$。

+   空对象 $\epsilon$，OGF 为 $1$。

+   原子对象如 $0$，$1$ 或 $\bullet$，OGF 为 $z$。

符号方程将这些与使用不相交并集、笛卡尔积、序列和其他运算的符号类名结合起来的符号方程直接转化为生成函数上的函数方程。

*例子。* 让 $\cal G$ 是没有连续 $0$ 位的二进制字符串类别。 这样的字符串要么是 $\epsilon$，一个单独的 $0$，要么是 $1$ 或 $01$，后跟一个没有连续 $0$ 位的字符串。 符号上，$${\cal G} = \epsilon + \{0\} + \{1, 01\}\times{\cal G}.$$ 因此 $$G(z) = 1 + z + (z + z²)G(z).$$ 我们有 $G(z)=(1+z)/(1-z-z²)$，这直接导致长度为 $N$ 的字符串中没有连续 $0$ 位的数量是 $F_{N}+F_{N+1}=F_{N+2}$，即斐波那契数。

*标记对象.* 另一种范式是假设个体项目{\it 是}可区分的---它们是{\it 标记的}，因此，当组装成组合对象时，项目出现的顺序是重要的。标记对象通常由指数生成函数枚举。对于标记类$\cal A$，我们对 EGF 感兴趣$$A(z)=\sum_{n\ge 0}a_n{z^n\over n!}=\sum_{a\in\cal A}{z^{|a|}\over |a|!}.$$ 当我们组合两个标记对象类$\cal A$和$\cal B$时，我们需要以一致的方式重新标记，以便如果生成的对象大小为$N$，则只出现标签$1$到$N$。*不相交并*操作本质上相同，但*乘积*操作涉及重新标记，因此我们使用不同的符号（$\cal A \star \cal B$）。再次，定义直接导致生成函数上的函数关系。

+   $A(z)+B(z)$是枚举$\cal A +\cal B$的 EGF

+   $A(z)B(z)$是枚举$\cal A \star \cal B$的 EGF

+   $\displaystyle{1\over 1-A(z)}$是枚举来自$\cal A$的对象序列的 EGF

+   $\displaystyle{e^{A(z)}}$是枚举$\cal A$的对象集合的 EGF

详细内容和示例请参见第六章。

## 3.10 拉格朗日反演。

符号方法清楚地表明，我们经常面临从通过函数方程隐式定义的生成函数中提取系数的问题。以下通用工具可用于此任务，并且在树枚举方面尤为重要。

> **拉格朗日反演定理。** 如果生成函数$A(z)=\sum_{n\ge0}a_nz^n$满足函数方程$z = f(A(z))$，其中$f(z)$满足$f(0)=0$且$f^{\prime}(0)\ne0$，那么$$a_n \equiv [z^n]A(z) = {1\over n}[u^{n-1}]\Bigl({u\over f(u)}\Bigr)^n.$$ 同样，$$z^n)^m = {m\over n}[u^{n-m}]\Bigl({u\over f(u)}\Bigr)^n.$$ 和$$[z^n]g(A(z)) = {1\over n}[u^{n-1}]g^\prime(u)\Bigl({u\over f(u)}\Bigr)^n.$$

函数$f$的*函数逆*是满足$f^{-1}(f(z))=f(f^{-1}(z))=z$的函数$f^{-1}$。将方程$z=f(A(z))$两边应用$f^{-1$，我们可以看出函数$A(z)$是$f(z)$的函数逆。在这个意义上，拉格朗日定理是一个反转幂级数的通用工具。它的惊人之处在于提供了函数逆的系数与该函数幂次之间的直接关系。

*例子.* 让$T^{[2]}(z)=zT(z)$是计算外部节点的二叉树的 OGF。将函数方程$T^{[2]}(z)=z+T^{[2]}(z)²$重写为$$z = T^{[2]}(z)-T^{[2]}(z)²$$，我们可以应用拉格朗日反演，其中$f(u)=u-u²$。这给出结果$$[z^n]T^{[2]}(z) = {1\over n}[u^{n-1}]\Bigl({u\over u-u²}\Bigr)^n = {1\over n}[u^{n-1}]\Bigl({1\over 1-u}\Bigr)^n.$$ 现在，$${u^{n-1}\over(1-u)^n}=\sum_{k\ge n-1}{k\choose n-1}u^k$$ 所以，考虑$k=2n-2$的项，$$[u^{n-1}]\Bigl({1\over 1-u}\Bigr)^n = {2n-2\choose n-1} \quad\hbox{因此}\quad [z^n]T^{[2]}(z) = {1\over n}{2n-2\choose n-1}$$，如预期。

## 3.11 概率生成函数

## 3.12 双变量生成函数

## 3.13 特殊函数

生成函数长期以来在组合学、概率论和解析数论中被广泛使用；因此，已经开发出了丰富的数学工具，这些工具对算法分析非常重要。我们既将生成函数用作*组合*工具来帮助精确计算感兴趣的数量，又将其用作*解析*工具来提供解决方案。因此，它们在算法分析中的作用至关重要。

#### 选定练习

## 3.1

找到以下序列的每个 OGF：$$\{2^{k+1}\}_{k\ge0}, \qquad\{k2^{k+1}\}_{k\ge0}, \qquad\{kH_k\}_{k\ge1}, \qquad\{k³\}_{k\ge2}.$$

## 3.2

找到以下 OGFs 的$[z^N]$：$${1\over(1-3z)^{4}}, \qquad(1- z)²\ln{1\over1-z}, \qquad{1\over(1-2z²)²}.$$

## 3.4

证明$$\sum_{1\le k\le N}H_k = (N+1)(H_{N+1}-1).$$

## 3.6

找到$$\Bigl\{\sum_{0< k< n}{1\over k(n-k)}\Bigr\}_{n>1}$$的 OGF。

## 3.7

找到$\{{H_k/k}\}_{k\ge1}$的 OGF。

## 3.8

找到以下 OGFs 的$[z^N]$：$ {1\over1-z}\Bigl(\ln{1\over1-z}\Bigr)²$和$\Bigl(\ln{1\over1-z}\Bigr)³$。在这些展开中使用记号$$H_N^{(2)}\equiv 1 + {1\over2²} + {1\over3²} + \ldots + {1\over N²}$$代表出现的“广义调和数”。

## 3.9

找到以下序列的 EGF：$$\{2^{k+1}\}_{k\ge0}, \qquad\{k2^{k+1}\}_{k\ge0}, \qquad\{k³\}_{k\ge2}.$$

## 3.10

找到$1, 3, 5, 7, \ldots$和$0, 2, 4, 6, \ldots$的 EGF。

## 3.11

对于以下 EGF，找到$N![z^N]A(z)$：$$A(z)={1\over 1-z}\ln{1\over 1-z}, \qquad A(z)=\Bigl(\ln{1\over 1-z}\Bigr)², \qquad A(z)=e^{z+z²}.$$

## 3.16

使用生成函数解决以下递推关系：$$\displaylines{ a_n = -a_{n-1} +6a_{n-2}\qquad\hbox{对于$n>1$，其中$a_0=0$，$a_1=1$};\cr a_n = 11a_{n-2} -6a_{n-3}\qquad\hbox{对于$n>2$，其中$a_0=0$，$a_1=a_2=1$};\cr a_n = 3a_{n-1} -4a_{n-2}\qquad\hbox{对于$n>1$，其中$a_0=0$，$a_1=1$};\cr a_n = a_{n-1} -a_{n-2}\qquad\hbox{对于$n>1$，其中$a_0=0$，$a_1=1$}.\cr }$$

## 3.17

解决递推关系$$a_n=5a_{n-1}-8a_{n-2}+4a_{n-3}\qquad\hbox{对于$n>2$，其中$a_0=1$，$a_1=2$，$a_2=4$}.$

## 3.18

解决递推关系$$a_n=2a_{n-2}-a_{n-4}\qquad\hbox{对于$n>4$，其中$a_0=a_1=0$，$a_2=a_3=1$}.\ $$

## 3.19

解决递推关系$$a_n=6a_{n-1}-12a_{n-2}+18a_{n-3}-27a_{n-4}\quad\hbox{对于$n>4$}$，其中$a_0=0$，$a_1=a_2=a_3=1$。

## 3.20

解决递推关系$$a_n=3a_{n-1}-3a_{n-2}+a_{n-3}\quad\hbox{对于$n>2$}$，其中$a_0=a_1=0$，$a_2=1$。将初始条件$a_1$更改为$a_1=1$后，解决相同的递推关系。

## 3.22

使用生成函数解决递推关系$$na_n = (n-2)a_{n-1} + 2\quad{\rm for}\ n>1{\rm \ with\ } a_1=1.$$

## 3.25

使用泰勒定理找到以下函数的展开式：$$\sin(z),\qquad 2^z,\qquad ze^z.$$

## 3.27

使用泰勒定理直接验证$$H(z)={1\over1-z}\ln{1\over1-z}$$是调和数的生成函数。

## 3.28

找到以下表达式的值：$$[z^n]{1\over\sqrt{1-z}}\ln{1\over1-z}.$$ *提示.* 展开$(1-z)^{-\alpha}$并对$\alpha$求导。

## 3.55

讨论$[z^N]D(z)$的表达形式。

## 3.56

编写一个高效的计算机程序，可以计算给定$N$的$[z^N]D(z)$。

## 3.58

[欧拉] 证明$${1\over1-z}=(1+z)(1+z²)(1+z⁴)(1+z⁸)\cdots.$$ 给出前$t$个因子的乘积的闭合形式。这个恒等式有时被称为“计算机科学家的恒等式”。为什么？

## 3.60

将$(1-z)(1-z²)(1-z⁴)(1-z⁸)\cdots$表示为$N$的二进制表示形式。

#### 复习问题

## Q3.1

假设$a_n$满足$a_n = 9a_{n-1}-20a_{n-2} + n\quad{\rm for}\ n>1{\rm \ with\ } a_0=0 {\rm \ and\ } a_1=1 .$ 那么$\lim_{n\to\infty}a_n/a_{n+1}$是多少？

## Q3.2

计算$[z^n]\sum_{0\le k\le n}{2k\choose k}{2n-2k\choose n-k}$的值是多少？

## Q3.3

*不要使用计算代数解决这个问题。* 给出以下序列的 EGF：

**A. **0, -1, 1, -1, 1, -1, . . .

**B. **0, 1, 3, 7, 15, 31, 63, . . .

**C. **0, 1, 2, 3, 4, 5, 6, . . .

**D. **0, 1, 4, 9, 16, 25, 36, . . .

**E. **0, 1, 2, 6, 24, 120, 720, . . .

对于每个序列，使用以下列表中的一个函数：$(e^z-e^{-z})/2$，$ze^z$，$e^{2z}-e^z$，$(z²+z)e^z$，$e^{-z}-1$，$z/(1-z)$，$e^{z²}-1$。

## Q3.4

(D. 卡特) 对于$n>0$，找到$[z^n]\bigl(1-{1\over z}\bigr)\ln(1-2z)$。
