- en: Lecture 5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://cs50.harvard.edu/r/notes/5/](https://cs50.harvard.edu/r/notes/5/)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[Welcome!](#welcome)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[ggplot2](#ggplot2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Scales](#scales)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Labels](#labels)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Fill](#fill)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Themes](#themes)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Saving Your Plot](#saving-your-plot)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Point](#point)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Visualizing Over Time](#visualizing-over-time)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Summing Up](#summing-up)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Welcome!
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Welcome back to CS50’s Introduction to Programming with R!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Today, we will be learning about visualizing data. A good visualization can
    help us interpret and understand data in a whole new way.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ggplot2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `plot` in `ggplot` means that we are going to *plot* our data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `gg` in `ggplot` references a *grammar of graphics* where individual components
    of graphics can be gathered together to visualize data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There are many components that make up this grammar of graphics, starting with
    *data*.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Another component is *geometries*. These are the various types of graphical
    representation options for plots. These include columns, points, and lines.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Finally, *aesthetic mappings* are the relationships between the data and visual
    features of our plot. For example, in a plot, a horizontal `x` axis may represent
    each candidate. Then, a vertical `y` axis may be associated with the number of
    votes for each candidate. It is through this relationship between data and geometries
    that we are able to visualize and understand the aesthetic map of our plot. You
    may be able to imagine times when poorly designed plots have been shown to you:
    when the mapping is incorrect, data is more challenging to interpret and understand.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Download the lecture’s source files and run `library("tidyverse")` in the R
    console such that the `tidyverse` is loaded into memory. Then, create a visualization
    as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `votes.csv` is loaded into `votes`. When `ggplot` is run, nothing
    is currently visualized.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'We can provide inputs to `ggplot` as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `votes` is provided to `ggplot`. Still, nothing is visualized.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'We need to tell `ggplot` what type of plot we want:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice that `geom_col` specifies that the data should be visualized with a column
    geometry. However, at this point, an error will result. The error indicates that
    we need to designate aesthetic mappings.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Notice, too, that the `+` operator has a new meaning: using the `+` operator
    adds a layer on top of the base layer of your plot.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To designate aesthetic mappings, we can define them as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how various aesthetic mappings, designated by `aes`, are defined within
    the parenthesis. For example, `x = candidate` and `y = votes` are both aesthetic
    mappings. Now, `ggplot` knows which data maps to which aesthetic features of our
    plot.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Running the above code, our first visualization finally appears!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scales
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Notice how `ggplot` has decided that the values of the `votes` axis range from
    `0` to `200`. What if we wanted to provide more headroom, such that we could visualize
    up to `250`? Let’s learn about **Scales**.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scales can be *continuous*, ranging from one number to another, or *discrete*,
    which means categorical.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Continuous scales have *limits*. For example, the data provided in `votes`
    ranges from `0` to `200`. Hence, we can modify these limits as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how the scale of `y` is modified via `scale_y_continuous` to range from
    `0` to `250`. This, again, is provided via a new layer with the `+` operator.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Labels
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Additionally, one can add labels to the plot. Consider the following:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how labels are provided for `x`, `y`, and `title`. These are added as
    a new layer via the `+` operator.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Fill
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The fill color can also be changed, depending on the `candidate` name. Consider
    the following:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice that the `fill` is dependent upon the `candidate` via the `aes` function.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'We may wish to adjust the `fill` color to be friendly for color blindness.
    We can do so as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how the `viridis` scale is provided via `scale_fill_viridis_d` function.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Themes
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'One can also modify the themes being used by `ggplot`. You can do so as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice that `theme_classic` is provided. ggplot2 [offers several themes](https://ggplot2.tidyverse.org/reference/ggtheme.html).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Saving Your Plot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Finally, plots can be saved.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how the entire plot is designated as `p`. Then, `ggsave` is employed,
    naming the file name, the plot (in this case, `p`), height, width, and the units.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: By executing this code, you have saved your first plot. Congratulations!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Point
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now, let’s look at a new type of geometry called `point`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Imagine data where candy’s price percentile and sugar percentile are represented.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can imagine how the `sugar` percentile can be mapped on the `y` axis while
    the `price` percentile can be noted on the `x` axis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This can be realized in code form as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how the data `candy` is provided to the `ggplot` function. Then, the
    aesthetic mappings are set with the `aes` function. `price_percentile`, for example,
    is assigned to the `x` axis. Finally, the `geom_point` function is run.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Running this code results in points being represented in a plot.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Labels can be added as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `labs` (labels) for `x`, `y`, and `title` are provided. Also, a theme
    is named.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, a number of points do overlap. `jitter` can be used to help visualize
    points that overlap:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `geom_point` is replaced with `geom_jitter`. This allows for the
    visualization of points that overlap.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'We can add color aesthetics to our points:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how all points are changed to one color.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Further, we can change the size and shape of our points:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `shape` and `size` are changed. You can reference the [documentation](https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec)
    to learn more about which numbers correspond to which shapes.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Visualizing Over Time
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can imagine how data can be represented over time.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For example, consider how data regarding Hurricane Anita may be represented
    over time.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We could plot as we did prior with points:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `timestamp` and `wind` speed are placed in points over time.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'While this visualization is useful, it could be more useful to present with
    lines showing whether wind speed increased or decreased. Each point can be connected
    with a line as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice `geom_line` is employed as a new layer.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: What results is a series of lines that change direction at each timestamp. What
    if we could combine both `point` and `line`? Well, indeed, we can!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how a layer with lines is added via `geom_line`. Then, `geom_point` is
    added as a layer using `deepskyblue4`.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Aesthetics can be modified in various ways:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how the `linetype` and `linewidth` are modified. Then, the `size` of
    the points is changed. You can reference the [documentation](https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html#linetype)
    to learn more about various line types.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'As with our prior plots today, we can add labels and a theme:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how `labs` allows us to designate labels for `y`, `x`, and `title`. Then,
    `theme_classic` is enabled.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: As a final flourish, we can also add a horizontal line to demarcate the hurricane
    status. When did Hurricane Anita become a hurricane?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Notice how a new layer is added to display a line at `yintercept = 64`, to designate
    that anything 64 or higher is considered a hurricane. The `linetype` is designated
    as `3` or dotted.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Summing Up
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this lesson, you learned how to visualize data in R. Specifically, you learned
    about:'
  prefs: []
  type: TYPE_NORMAL
- en: ggplot2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scales
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Labels
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fill
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Themes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Point
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Visualizing over time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: See you next time when we discuss how to test our programs.
  prefs: []
  type: TYPE_NORMAL
