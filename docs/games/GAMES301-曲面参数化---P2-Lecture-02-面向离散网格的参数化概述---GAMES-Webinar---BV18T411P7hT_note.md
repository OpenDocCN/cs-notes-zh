![](img/b6abd4be51a5ae12e3e76b6ebc26dd80_0.png)

![](img/b6abd4be51a5ae12e3e76b6ebc26dd80_2.png)

# GAMES301-曲面参数化 - P2：Lecture 02 面向离散网格的参数化概述 📐

## 概述

在本节课中，我们将学习面向离散网格的参数化的基本概念。我们将介绍离散网格的表示方法、映射的定义、映射扭曲的度量方式，以及几种经典的参数化方法。课程内容旨在为初学者打下坚实的基础。

---

## 离散网格介绍

首先，我们来介绍离散网格。离散网格由几何和拓扑两部分决定。对于流形网格，几何主要由顶点的位置描述，而拓扑则由顶点之间的连接关系（如图的概念）描述。常见的离散网格主要有四大类：三角形网格、四边形网格、四面体网格和六面体网格。

三角形网格和四边形网格是表面网格，内部没有填充。四面体网格和六面体网格则是体网格，内部由相应的单元填充。在实际应用中，也可能存在混合类型的网格。

---

## 映射的定义

上一节我们介绍了离散网格，本节中我们来看看映射的定义。映射通常指将一个定义域（如输入网格）变换到另一个区域（如变形后的网格）的过程。从网格的角度看，映射就是将输入网格变形为另一个网格。

在变形过程中，拓扑和几何都可以是变量。但在一般情况下，我们假设映射前后网格的拓扑（连接关系）保持不变，因此求解的变量只有网格的几何部分，即每个顶点的新位置。

例如，在六面体网格质量提升的例子中，输入网格通过改变顶点位置，使输出网格的单元更接近立方体，从而提升质量。

---

## 线性网格与线性映射

对于三角形网格或四面体网格这类线性网格，映射前后的网格都是直边网格。因此，在每个三角形或四面体单元上的映射是一个线性映射。整个映射则是分片线性的，并且是C0连续的。

在每个三角形上建立局部坐标系后，线性映射可以表示为一个雅可比矩阵。对于三角形，雅可比矩阵是一个2x2的矩阵；对于四面体，是一个3x3的矩阵。雅可比矩阵的行列式具有明确的几何意义：它等于映射后单元的面积（或体积）除以映射前单元的面积（或体积）。

---

## 映射的扭曲度量

我们关心映射是否对输入产生了扭曲。为此，我们引入几种理想的映射类型及其扭曲度量方式。

以下是几种映射类型及其对应的雅可比矩阵条件：

*   **等距映射**：要求雅可比矩阵是一个旋转矩阵（不考虑镜像）。这等价于**保角且保面积**。
*   **共形映射**：要求雅可比矩阵是一个相似变换（旋转加均匀缩放）。
*   **保面积映射**：要求雅可比矩阵的行列式等于1。

为了具体度量扭曲，我们引入带符号的奇异值分解（SVD）。雅可比矩阵 `J` 可以分解为 `J = U Σ V^T`，其中 `U` 和 `V` 是旋转矩阵，`Σ` 是对角矩阵，其对角线元素 `σ1, σ2`（奇异值）描述了映射在不同主轴方向上的缩放。

基于奇异值，我们可以定义扭曲能量：

*   **共形扭曲能量**：度量 `σ1` 与 `σ2` 的差异。常见形式有 `(σ1 - σ2)^2` 或 `σ1/σ2 + σ2/σ1`（对称狄利克雷能量）。
*   **等距扭曲能量**：度量 `σ1, σ2` 与1的差异。常见形式有 `(σ1-1)^2 + (σ2-1)^2`（As-Rigid-As-Possible能量）或 `σ1^2 + 1/σ1^2`（对称狄利克雷能量）。
*   **保面积扭曲能量**：度量 `σ1*σ2` 与1的差异。常见形式有 `(σ1*σ2 - 1)^2`。

等距映射可以看作是共形映射与保面积映射的结合。

---

## 映射的约束条件

在求解映射时，我们通常希望满足一些约束条件，以保证映射的合理性与可用性。

以下是三种重要的约束条件：

1.  **无翻转**：要求映射前后每个单元的有向面积（或体积）符号相同。这等价于要求雅可比矩阵的行列式大于零。翻转在物理上是不可能的，也会导致纹理映射等问题。
2.  **局部单射**：在无翻转的基础上，进一步要求映射在每个顶点的局部邻域内是一一对应的。对于边界点，这要求其邻域三角形在参数平面上的内角和小于 `2π`。
3.  **全局单射**：要求整个映射是一一对应的，即映射后的网格没有自相交。这对于纹理映射等应用至关重要。

---

## 参数化问题的一般形式

综合以上内容，参数化问题通常可以表述为一个带约束的优化问题。

*   **目标函数**：最小化某种扭曲能量（如共形扭曲、等距扭曲）。
*   **约束条件**：包括基本约束（如无翻转、全局单射）和特定约束（如固定某些顶点的位置、边界对齐等）。

然而，这个优化问题通常是非凸、非线性的，求解比较困难。例如，无翻转约束（行列式>0）是一个二次非凸约束；许多扭曲能量是有理分式形式。

---

## 经典参数化方法简介

接下来，我们将介绍三种经典的参数化方法，它们主要关注降低扭曲，但未必严格保证全局单射。

### Tutte参数化方法

这是一种基于图论的方法，它提供了一个保证全局单射的充分条件。

**定理**：给定一个与圆盘同胚的三角形网格，如果将边界顶点按顺序固定在一个凸多边形（如圆、正方形）的边界上，并且每个内部顶点的坐标是其所有邻接顶点坐标的凸组合（即权重非负且和为1），那么由此得到的参数化是全局单射的。

求解时，边界顶点位置已知，为每个内部顶点根据其邻接关系建立线性方程，最终求解一个线性方程组即可得到所有内部顶点的UV坐标。这是第一次作业的内容。

### 基于角度的展平方法

这种方法的核心思想是，如果知道了参数化后网格所有三角形的内角，那么只需确定一条边的长度，就能唯一地重建出整个参数化坐标。因此，算法分为两步：

1.  **优化角度**：寻找一组新的三角形内角，使其尽量接近原始网格的内角（以保持共形性），同时满足平面三角网格的几何约束（如每个三角形内角和为π，每个内部顶点周围内角和为2π等）。
2.  **从角度重建坐标**：利用优化后的角度，通过求解一个线性最小二乘问题来恢复顶点的UV坐标。重建时需要固定两个顶点以消除旋转和平移自由度。

### 最小二乘共形映射方法

该方法直接基于共形映射的数学条件——柯西-黎曼方程。在离散设置下，它要求每个顶点满足一组线性关系。通过最小化这些线性关系的不满足程度（即最小二乘），可以得到参数化坐标。

目标函数是二次的，因此最终归结为求解一个线性方程组。同样，需要固定两个顶点以消除刚体变换自由度。

### 尽可能刚性方法

该方法的目标是让映射尽可能接近一个等距变换（刚性变换）。它通过交替迭代两步来求解：

1.  **局部步**：固定当前参数化坐标，为每个三角形计算一个最优的旋转矩阵（或相似变换矩阵），以最佳逼近该三角形当前的雅可比矩阵。这可以通过对雅可比矩阵进行带符号的SVD分解来实现。
2.  **全局步**：固定每个三角形上计算出的最优变换矩阵，重新求解所有顶点的参数化坐标，使得每个三角形的雅可比矩阵尽可能接近上一步指定的变换。这一步需要求解一个线性最小二乘问题。

这种局部-全局交替迭代的策略在许多几何处理问题中都有应用。

---

![](img/b6abd4be51a5ae12e3e76b6ebc26dd80_4.png)

## 总结

![](img/b6abd4be51a5ae12e3e76b6ebc26dd80_6.png)

本节课我们一起学习了面向离散网格参数化的基础知识。我们首先了解了离散网格的表示和映射的定义，然后学习了如何通过雅可比矩阵和奇异值分解来度量映射的扭曲（共形、等距、保面积）。接着，我们探讨了参数化中重要的约束条件：无翻转、局部单射和全局单射。最后，我们概述了四种经典的参数化方法：Tutte参数化、基于角度的展平方法、最小二乘共形映射以及尽可能刚性方法，理解了它们的基本思想和求解框架。这些内容为我们后续学习更深入的参数化技术奠定了基础。