![](img/7389f51b7bfb00ed9b7b624668d7606f_0.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_2.png)

# GAMES102：几何建模与处理 - P3：参数曲线拟合 📈

在本节课中，我们将要学习如何将函数拟合的概念从一元函数推广到多元函数，并最终聚焦于参数曲线拟合这一核心主题。我们将理解如何用数学方法描述和拟合空间中的曲线，并探讨参数化的重要性。

## 课程回顾与引入

上一节我们介绍了单变量函数的拟合问题。回顾前两次课程，我们主要讨论了定义域和值域都是实数的一元函数。理解这种函数形式是基础，因为高维函数可以看作是它的推广。

函数拟合主要涉及三个关键问题：
1.  **函数集合的选择**：需要确定从哪个函数集合中寻找目标函数。这个集合需要有良好的结构（如线性结构）和强大的表达能力。
2.  **度量标准**：需要定义一个损失函数来度量候选函数与数据之间的逼近程度。除了逼近误差，还可能加入对函数光滑性或系数大小的约束，即正则项。
3.  **求解方法**：将拟合问题转化为优化问题求解。如果能量函数是系数的二次型，则变为解线性方程组；如果是复杂的非线性非凸问题，则需使用梯度下降等数值方法寻找局部最优解。

理解了这些，我们就可以将视野扩展到更一般的情况。

## 从一元到多元函数

本节中，我们来看看当函数的输入变量从一个变为多个时，情况有何变化。多元函数是从 **R^n** 映射到 **R** 的函数，例如 `z = f(x, y)`。我们可以将其可视化：`x` 和 `y` 构成平面，`f(x, y)` 作为高度，形成三维空间中的一个曲面。

对于更高维度的输入（如 `g = f(x, y, z)`），我们无法直接可视化，但可以研究其数学性质，如偏导和梯度。在实际问题中，变量维度 `n` 可能非常大（如图像处理中的像素），这时直观理解变得困难，需要依靠数学方法。

### 多元函数的基函数构造

如何为多元函数定义基函数？最常用的方法是**张量积**。

假设我们有两个一维基函数集合：关于 `u` 的 `{b1(u), b2(u), b3(u)}` 和关于 `v` 的 `{b1(v), b2(v), b3(v)}`。通过两两相乘，我们可以构造二元基函数：
```
bij(u, v) = bi(u) * bj(v)
```
其中 `i, j = 1, 2, 3`。这样就得到了9个二元基函数，它们的线性组合可以表示一个二元函数。通常，为了简便，两个方向会使用相同的基函数集合。

**张量积的优缺点**：
*   **优点**：只需定义好一维基函数，就能自动构造多维基函数。
*   **缺点**：基函数数量随变量维度呈平方级增长。例如，100维输入需要约 `100^2 = 10000` 个基函数，这在计算上难以承受。这就是传统方法处理高维数据时面临的“维数灾难”。

### 神经网络的启示

神经网络巧妙地绕过了维数灾难问题。它使用统一的激活函数（如 Sigmoid 或 ReLU），通过权重和偏置的线性组合对输入进行仿射变换，再经过激活函数，形成新的基函数。一个简单的单隐层网络可以表示为：
```python
# 伪代码示意：单隐层神经网络前向传播
hidden = sigma(W1 * input + b1)  # 仿射变换 + 激活函数
output = W2 * hidden + b2         # 线性组合输出
```
其中，`sigma` 是激活函数，`W1, b1, W2, b2` 是待学习的参数。隐层节点数 `m` 控制了模型的表达能力。`m` 太小会导致欠拟合，太大会导致过拟合，需要通过调参来平衡。深度神经网络则是多个这样的函数复合而成。

神经网络的本质就是用一种参数化的、表达能力强大的函数族来进行拟合，尤其擅长处理高维数据。

## 向量值函数与参数曲线

现在，我们进入本节课的核心：向量值函数。这类函数的输入是一个实数，输出是一个高维向量，即映射 **R → R^m**。

可以将其理解为 `m` 个独立的单变量函数：
```
P(t) = ( x1(t), x2(t), ..., xm(t) )
```
每个分量 `xi(t)` 都是关于参数 `t` 的函数。

### 几何解释：参数曲线

向量值函数有清晰的几何意义。当 `m=2` 时，`P(t) = (x(t), y(t))` 表示平面中的一条曲线。当 `m=3` 时，`P(t) = (x(t), y(t), z(t))` 表示空间中的一条曲线。参数 `t` 可以理解为时间，曲线就是质点随时间运动的轨迹。

**关键概念**：虽然曲线上的点位于高维空间（如三维），但曲线本身的**本质维度是1**，因为它是由单个参数 `t` 描述的。我们所在的高维空间称为**嵌入空间**。参数曲线强大的地方在于，它可以描述非常复杂的、甚至非函数型的曲线（例如一个闭合圆）。

类似地，**参数曲面**是由两个参数 `(u, v)` 描述的曲面，其本质维度是2，例如球面。更一般地，一个从 **R^n** 映射到 **R^m** 的参数化表示，描述了 `n` 维流形在 `m` 维空间中的嵌入。

## 参数曲线拟合问题

理解了参数曲线，我们现在来解决如何用参数曲线拟合给定的一系列有序点 `{P_i = (x_i, y_i)}`。

问题可以表述为：寻找一个参数曲线 `P(t) = (x(t), y(t))` 和一组参数值 `{t_i}`，使得曲线在 `t_i` 处的值 `P(t_i)` 尽可能接近数据点 `P_i`。

损失函数可以定义为所有数据点误差的平方和：
```
Loss = Σ_i || P(t_i) - P_i ||^2
```
其中 `||.||` 表示向量的模长。`x(t)` 和 `y(t)` 可以分别用我们之前学过的基函数组合来表示，例如多项式基函数。

### 关键挑战：参数化

上述问题中，数据点 `P_i` 是已知的，但对应的参数值 `t_i` 是未知的。为每个数据点分配一个参数值 `t_i` 的过程，就叫做**参数化**。参数化本质上是将高维数据点降维到一维参数域，且要求这种映射能保留数据的结构信息。

以下是几种常见的参数化方法：

![](img/7389f51b7bfb00ed9b7b624668d7606f_4.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_6.png)

*   **均匀参数化**：最简单直接。假设参数 `t` 在 `[0, 1]` 区间均匀分布，`t_i = i / (n-1)`。这种方法忽略了点与点之间的实际距离。
*   **弦长参数化**：更符合几何直觉。根据相邻点之间的弦长（欧氏距离）比例来分配参数。
    ```
    总弦长 L = Σ_i || P_{i+1} - P_i ||
    第k点的参数 t_k = (Σ_{i=0}^{k-1} || P_{i+1} - P_i ||) / L
    ```
*   **中心参数化**：一种更复杂的参数化方法，旨在产生更光滑的拟合曲线。

![](img/7389f51b7bfb00ed9b7b624668d7606f_8.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_10.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_12.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_14.png)

**参数化的重要性**：不同的参数化方法会导致完全不同的拟合结果。均匀参数化在点分布不均匀时容易产生扭曲；弦长参数化通常能产生更自然的曲线；中心参数化可能在某些情况下得到最光滑的结果。选择好的参数化是曲线拟合成功的关键。

![](img/7389f51b7bfb00ed9b7b624668d7606f_16.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_18.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_20.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_22.png)

## 参数化的广泛应用

![](img/7389f51b7bfb00ed9b7b624668d7606f_24.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_26.png)

参数化不仅是曲线拟合的核心步骤，在几何处理中还有更广泛的应用：

![](img/7389f51b7bfb00ed9b7b624668d7606f_28.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_30.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_32.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_34.png)

*   **曲面参数化**：将三维曲面映射到二维平面，同时尽可能保持几何属性（如角度、面积）。这对于纹理映射至关重要。
*   **流形学习**：对于高维数据，寻找其低维本质参数（流形结构），类似于自编码器（Autoencoder）的目标。如果降维后的维度低于数据的本质维度，信息将无法无损恢复。
*   **几何设计**：在工业设计中（如汽车、飞机叶片），外形通常由艺术家绘制草图，然后需要转化为精确的数学参数曲面进行制造。历史上，设计师使用物理样条（富有弹性的木条或金属条）来绘制光滑曲线，而数学上的**样条函数**（特别是三次样条）正是由此启发而来，它用分段多项式来拼接出一条整体光滑的曲线。这将是后续课程的重要内容。

![](img/7389f51b7bfb00ed9b7b624668d7606f_36.png)

## 课程总结

![](img/7389f51b7bfb00ed9b7b624668d7606f_38.png)

本节课中，我们一起学习了参数曲线拟合的核心思想。我们从一元函数拟合出发，推广到多元函数和向量值函数，并理解了参数曲线的几何意义。我们明确了拟合参数曲线的关键步骤：**参数化**和**函数拟合**，并介绍了均匀、弦长等参数化方法。最后，我们看到了参数化在曲面纹理映射、流形学习以及几何设计中的重要作用。

![](img/7389f51b7bfb00ed9b7b624668d7606f_40.png)

通过本课，希望大家能建立起一个统一的观点：无论是简单的函数拟合，还是复杂的神经网络、曲线曲面建模，其数学本质都是在某个函数空间中寻找对目标数据的最佳逼近。理解了这一点，就能更好地掌握后续更深入的几何建模与处理方法。

![](img/7389f51b7bfb00ed9b7b624668d7606f_42.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_44.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_45.png)

![](img/7389f51b7bfb00ed9b7b624668d7606f_46.png)

---
**附：作业三简介**
请实现参数曲线拟合。给定一系列有序的二维点，分别使用均匀、弦长参数化方法为点分配参数，然后利用多项式基函数分别拟合 `x(t)` 和 `y(t)`，最终得到拟合曲线。比较不同参数化方法对拟合结果的影响。