# GAMES001-图形学中的数学 - P3：计算几何 - GAMES-Webinar - BV1MF4m1V7e3

![](img/38f2e25ae223d12d3c0c7e7893b9577a_0.png)

同学们好，今天是3月18号，然后我们今天来进入一个比较轻松愉快的话题，计算几何，然后今天的内容应该不会再像前两节课那样，需要额将近两个小时的时间了，现在应该可以就是啊准时下课啊，我希望如此啊。

然后我们先进入这个第一环节，第一个部分呃，首先我们来看就是我们说计算几何，那么什么是计算几何呢，呃有过信息学竞赛经验，或者是大学生程序设计竞赛经验的同学，应该对计算机和都不是很陌生。

然后所谓图形学当中的计算几何呢，它其实就是这个这个OI中的计算机，和它之间有一定的关系，呃，有有一定的区别，但是区别并不是很大，呃我觉得图形学计算几何，最主要是它在三维的问题上，会比OI有更多的要求。

但是呃我们所说的二维计算几何，仍然是这个三维计算几何的基础，所以呃今天的课程，我会就这个oi中的计算几何，和图形学当中的计算几何，然后去解决一些就是我们图形学所关心的问题。

诸如OI中的有一些比较偏门的算法，我们不会去讲，然后我们也会扩充一些有关三维的知识，然后我们的核心可能要放在，如何把二二维的计算机和拓展到三维，这个问题上，然后我们首先来看呃，其实计算几何这个东西。

它从本质上说它不是数学，虽然我们除了它的图形学中的数学，但它它就是一门计算机科学下的一个研究分支，或者说更进一步的说，他甚至就是图形学的一个研究分支，计算几何，但是它所用到的东西却是直接接触到数学的。

然后我们可以看到今天的我们从头到尾讲解，不会出现代码，我们只会去讲这个算法，然后以及一些最基础的解析几何的知识，所以呃从这个角度上来看，它又是竖写的呃，计算几何的历史呢，其实到现在也并不是特别的久。

大概也就50多年的时间，然后他关心的是那些解决几何问题的算法，然后包括这些三角剖分啊，图包啊，扫描线啊这些东西，他们都是计算几何，然后呃相比于别的算法，它的特点主要在于它需要处理实数，而不是整数。

并且呢他需要关心向量，当然这个向量和我们线性代数基础里面所讲的，那种高维向量不同，它主要指的是低维的向量，并且啊就是他主要关心的是这种低位向量，不是标量，为什么需要计算几何这一门这个研究分支呢。

主要是我们希望在计算机中，降低解决几何问题的复杂度和数值误差，然后我们今天呢主要关心的是第一部分，也就是如何降低在计算机中，解决几何问题的复杂度，关于数值误差的部分呢，哦应该会有别的更专业的课程去讲解。

而且他也超过了我们这个图形学中的数学，这个范畴好，那么下面就进入这个计算几何的世界啊，计算几何，最上来我们需要给出的是有关点线面，这些最基本的几何体的表示呃，为了定义这些几何体呢，我们首先要确定坐标系。

然后坐标系其实是由这个原点和坐标轴，所构成的，原点的选取，当然理论上说是任意的，那么所以呃最关心的点，它就在于如何去选取坐标轴呃，按照我们在线性代数基础的课，里面所讲解的内容。

我们希望这个选取的坐标轴它尽量是，这个单位正交的对吧，因为单位正交的它的内积就会非常的好算，所以我们希望这个东西它是单位正交的，那我们把单位正交基底的这样坐标轴，叫做笛卡尔坐标，然后笛卡尔坐标的三维。

在三维的笛卡尔坐标就是XYZ这三个轴，然后在XYZ这三个轴当中，一般情况下我们会以RGB，你看它正好是和RGB3种颜色对应的，就是当大家看到一个图形学应用当中，没有给你标谁是X谁是Y谁是Z。

但是给你画了红线绿线蓝线的话，那么它就是确定了他的这个软件的XYZ，是怎样排布的，然后这里我我就以列举的形式，给出了一些常用的图形学软件的事例，呃首先呢就是就是呃，这个以Y轴为竖直方向。

然后以右手系的这样的这个软件呢，主要是由胡迪尼和玛雅，然后我们可以看到它的形式大概就是啊，这个Y轴是竖直方向，然后右手系就是X的正方向指向屏幕的右侧，然后Y的正方向指向屏幕的上方。

而Z的正方向垂直于屏幕朝外，然后Y轴为竖直方向，还有左手系，左手系的也有很多的代表是unity three d，它是它和上面的这种唯一的区别，在于Z轴的正方向是垂直于屏幕朝内的。

就是用我们高中物理熟悉的这个符号的话，它们Z轴方向分别是这样，然后呃这两种，我觉得对大家来说都算是比较直观的对吧，然后还有不太直观的就是取Z轴为竖直方向，然后呃取右也取右手系的这样的一种坐标价。

选取它以blender为主，然后这种是Z的正方向指向屏幕的上方，Y的正方向垂直于屏幕朝内，与上面那种相反的呢是Z轴为竖直方向，左手系的，而这种是以unreal为主要势力的这种软件。

然后我们可以看到这以上的四种坐标系，可以说都有自己很具有代表性的这个图形应用，比如说胡迪尼啊，这个unity啊，Blender unreal，他们竟然都是不一样的，所以大家在使用这些图形写软件的时候。

一定要先搞清楚他们的坐标轴，到底是按照什么方向去选取，然后在更底层的API里面，open gl和DVD，一般情况下我默认open gl是右手系，DCD是左手系，但是这其实并不是说。

他的这个API内部规定了这些东西，而是呃它有一些他们自己的官方实现的库，是做了如上如上的假设，所以我们一般认为open gl是右手，PRDCD是左手系，然后至于到底什么叫右手系，什么叫左手系，呃。

我这里应该有一幅图，可能是这个这个网站有没有同步，我看看能不能关掉PPT同步一下好了，现在大家应该能看到这个右上角的图了啊，就是所谓的左手系，就是呃其实有两种，这个用左手和右手去辨别坐标系朝向的。

取向的方法，第一种是呃就就是我在这个PPT上放出来的，如果我们把这个这个左手握拳，然后呃让这个除了拇指以外的四指，从X方向往Y方向转，那么此时拇指的朝向就是Z轴方向，然后相应的如如果右手握拳。

右手的四指从X往Y方向转，那么拇指指向的方向是Z轴方向，然后这就是左手系和右手系的确定方式，然后个人感觉这种确定方法是比较简单的，然后除此以外还有用三个手指的那个做法，但我觉得那个就是就是。

至少我个人握起来不是非常舒服，所以我比较推荐的是这样确定坐标系的方法，我们来进入下一个，然后确定坐标系之后，我们就可以定义点了，然后点呢其实一般情况下，我们可以把它等同于使用。

因为它可以看成是从原点到这个点的位置，但是呢我在一些这个图形学所使用的API里面，或者一些第三方库里面，他们往往会把点和矢量的概念进行区分，然后他可能会定义两两种不同的数据结构，一种叫point。

一种叫vector，然后此时呢他们的point相减会得到vector，point相加是未定义的，而point正加减一个vector，得到一个point，vector加减一个point也是未定义的。

他们可能会这样去做一些规定，然后这个需要大家在使用这些库的时候，要提前看一下它是否采用了这样的方法，然后定一个点我们就可以定义线，无论是在二维还是三维，我们都可以把直线或者射线定义为，从一个点出发。

沿着某个方向向量，并且有一个参数T如此的参数方程来规定啊，对于直线和射线，唯一的区别就在于，直线的T取值范围是负无穷到正无穷，而射线的T取值范围是零到正无穷，然后呃很对于直线来说。

这个P点可以是它上面的任何一个点，而射线呢它必须是这个射线发射的端点，线段呢就是有两个端点的所谓直线，然后我们的定义方法也是类似的，我们可以用参数方程来定义，如果现在有两个单点，一个叫P1。

一个P2的话，我们很容易把它的参数方程定义成P1，加上T倍的P2减P，然后我们合并一下同类项，就得到了是这个一减T倍的P1，加上T倍的P2，然后P1P2分别是现在的两个端点，就是现在的表示。

这些对二维和三维都是成立的，然后面面是一个三维的量，就是它不存在二维的编码，然后无穷大的平面，我们可以用这个影视方程来，这是个隐式方程，我们可以看到这里并没有参数，无穷大的平面可以用平面上任意一点P。

然后前面有个点X是外面的，就是某一个点，也就是说某一个点，如果它和平面上的某一个点P相减得到的差，在点乘平面的法向量是零，那么我们就这个点就一定是在平面上，然后这一点也很容易证明。

因为平面的法向量会垂直于平面内的，所有的线向量，然后如此呢，我们又可以定义半平面，所谓半平面，它其实不是平面，而是一半的空间，此时我们说X减P点乘normal是小于等于零的。

那其实指的是这一个平面以下的所有的空间，这个时候法向量的正负就有意义了，因为如果我们把这个法向量取负号的话，它其实指代的就是原来的上半部分空间，然后类似的既然直线可以给它限缩到线段上。

那么平面也可以给它限缩到三角三角面片内，如右图所示，我们的这个三角面有P一P二P33个顶点，然后我们类似的可以把它写成参数方程的形式，一加上UV的P2减P加上V倍的P3减P，然后合并同类项。

得到一减U减VP加UP2加VP3，然后此时这个方程就是这个三角面的参数方程，然后我们看到这个方程它不是特别的对称，就是这个形式看起来并不是特别的好看，然后或者其实我们也并不是特别明白。

为什么我们一定得这么取，只能这么取呃，其实上面这个过程可以把它看成是以下的这个，这几条操作的合并，因为我们是想将X限制在P1P2，P3这三个顶点决定三角形之内，所以我们相当于说是。

我们要先要在P1和P2之间找一个点，我们在P1和P2之间找一个点，然后这个点它显然满足线段的参数方程，它等于一减T1撇位的P1，加上T撇位的P2，然后我们再在这个点叫X1撇。

我们再在X1撇和P3之间找一个点，这个点就是X，然后X满足的也是X撇和P3的这个线段，的参数方程，所以它等于一减T乘一减T1撇的倍数，P加上一减T乘T1撇的倍率，P2加TP3。

如果我们令U等于一减T乘一减T1撇的话，V等于T1撇，减TT1撇的话，然后我们最终就会得到X等于UP1加VP，二加WP3，然后我们很容易验证，上面的U加V加W是等于一的，也就是说通过这样的方式。

我们可以构造出一个在这个P1P2，P3这个三角形内的一个点，并且此时使得它的每一个这个顶点的权重，相加的和等于一，当然由于我们上面以上这个过程，我们用的都是一减T1撇和T1撇。

所以UVW也必然都是在零和一之间的量，它不可能是小于零或者大于，然后定义了点线面之后，我们还要看点线面之间的关系呃，首先我们看这个点与直线的距离，就是在本次课件中，如果我在标题上没有标明。

这个是2D或者3D的话，那么它基本上是意味着，他对于2D或者3D都是通用的，就是我们为什么要如此的去定义直线，如此的去定义这个平面，如此去定义点呢，就就在于我们用这个方法去计算距离的公式。

对于维度是无关的，不管你在这个二维还是三维下，都可以用同样的方法去计算，首先我们来看点与直线的距离，给定一点P，给定一个直线的参数方程X等于O加TD，那么这个点与这个直线的距离，可以用P减O叉乘D。

然后再比上D的这个模，来确定这个事情是为什么呢，我们可以看右边这幅图，P减O就是这个虚线，P减O就是P在这里，O在这里P减O是这个虚线P减O叉乘D，我们得到的是什么呢，其实是P减O叉乘D。

我们把得到的其实是这个三角形的面积乘二，对吧，我们德尔其实是这个三角形的面积乘二，然后这个三角形的面积长二，如果我们再除以D的模长，我们得到的就是这个三角形沿D这条边的高，那其实这个边的高根据定义。

它就是PP点到这条直线的距离，然后类似的，既然我们已经知道距离可以这么算了，我们也可以算他在直线上的投影，在直线上投影的方式呢是呃要怎么去做呢，我们其实就相当于说我们要找一个点，在直线上找一个点。

然后他和P点之间的差，向量和D这个向量正好是垂直的，也就是说我们要满足这个条件，然后把这个条件给展开，就得到了一个关于T的一次方程，然后我们再整理一下，就直接得到这个式子，也就是说。

然后就我们再把T带回到直线的方程里面，就可以得到这个切啊，直线外一点在直线上投影的位置，坐标的计算方程，那么如何去计算点与射线的距离呢，其实和之前是一样的对吧，其实我们需要先确定这个T是什么。

然后如果T大于等于零，它就是到直线的距离，如果是T小于零，说明我说明它比如说这个射线的端点在这里，而我们取到的这个最小值点在这里，那么它的最近距离，就是直接取它和射线的端点的距离对。

这就是点与线的距离的计算方式，然后接下来我们来看线与线的位置关系，呃这个位置关系主要是在2D当中去确定的，呃，我们首先来看共端点的射线和，或者说是线段的绕叙，我们假设射线一二的端点都为O。

然后它们的方向向量分别为第一和第二，然后或者是我们可以设现代一的端点是op1，现在二的端点是op2，不管这两种方向，两种定义都会得到右边这幅图这样的结果，然后我们可以直接拿第一去差乘第二。

注意这里的叉叉乘是限缩在二维翼下的尾，插成，它等于X1Y2减X2Y1，得到的是一个实数啊，这个大家应该上节课都都讲过了，所以啊我放在这里再提示一下，然后我们用这个叉乘得到的结果是一个实数，如果它大于零。

这就说明这个射线二在射线一的左边，所谓左是说逆时针的转角是小于180度的，如果是小于零的，他意思是说射线二在射线一的右边，然后这个U的意思是指，顺时针能转角小于180度，如果是等于零的话。

它说说明射线二与射线一重合或者是反方向，那么如何判定是重合还是反方向呢，我们这时候就需要通过点乘来进一步判断，因为在点乘的情况下，如果是重合得到的点乘值是大于零，而我是反方向得到的点乘值是小于零。

我们再来看直线与直线的交点，在二维当中，我们有两条直线，它们的参数方程分别是X1等于O1加TED，X2等于O2加T2D2，然后他们两个的交点所满足的公式是这样的，就是我们可以任取其中一个。

直线上的这个参数方程，比如说呃在直线二上，我们去找一点，它满足O2加T2，第二它在这个这个位置上，然后我们想说它也落在直线一上，它其实就是说它和直线一的端点之间的差，向量和第一是平行的。

所以我们就列出了这个式子O2加T2D2，比如说我们得到这个点，然后它会得到这个点，这个点和O1相减，我们又得到一个向量，这个向量和D1是平行的，它就说明它落在直线一上，然后我们把这个式子展开展开。

得到这个式子，得到这个式子以后，我们又可以呃，它也是一个关于T2的线性方程，所以我们这个稍微化简一下，就得到了T2长，这样，然后我们直接取P等于O2加T2D2，就能算出来这两条直线的交点位置。

我们可以看到这个这个计算方式，还是比较的简洁的呃，另外有时候我们需要去判断两条线段，它之间是不是相交的呃，除了求出交点，然后来判断它有没有焦点之外，还有没有别的做法呢。

然后借助于这个计算二维的计算几何的算法，我们有这个现在的跨域测试这样一种手段啊，我们取现在一的端点是P1和Q1，取现在二的端点是P2和Q2，然后我们将S1取为Q1减去P1，X乘上P2减P这是什么意思呢。

Q1减P1就是现代一的这个向量，而P2减P1是这个项，然后Q1减P，还是刚刚这个RQ2减P是这个项目，所以他意思是说，我们要求P1Q1所对应的向量，在P1Q2和P1P2这两个向量之间。

他希望这个向量在这两个向量之间，然后S2类似的，我们还需要这个Q2减P2这个向量，这个向量，在这边P1减P2和Q1减P2，这两个向量之间，如果这两个条件都能满足的话。

那么他一定说明这个这两个线段是有交点的，如果这两个是不满足的话，他一定是没有交点，而如果它是取等号的，其实说明焦点就是在端点处发生，我们才会取等号，就是现在的快递测试，然后可以看到这里面。

我们并没有做任何的这个呃除法除法运算，我们就直接是通过这几次差成就，判断了两个线段是不是相交，然后避免了很多这个呃，求出交点，然后再讨论大于零小于零这样的情况，然后既然我们已经会算这个二维的直线。

之间的距离了，那我们再来看三维的线与线之间的位置关系，首先我们来看异面直线之间的距离，然后还是一样，我们先给出两条直线的参数方程，第一个是X1等于O1加T1，D1D2是X2等于O2加T2。

第二然后我们计算这两条异面直线的距离的法，一是求两个直线的公垂线，并且把它投影到这个这个公垂线的，所决定的向量上，这这个事情是是什么样的逻辑呢，比如说我们有一个异面直线是J的直线。

B有个异面直线J的直线A，我们首先求这两条直线的公垂线，也就是我们会求出这个法向normal，然后这个法向normal会决定一个平面的朝向，我们再把B和A上任取一个点，任取一个点。

他们俩之间的这个向量投影到N上，得到的必然就是B和A之间的最近距离，这是法医，然后法二呢就是联立方程，我们索性我们把T1和T2都当做未知数，然后求出它们俩之间的模长的表达式。

然后对这个表达式T1T2分别求求偏导，然后令它为零，这是第二种求法，既然我们已已知异面直线之间距离的计算方式，我们就可以去讨论，意面线段之间距离的计算方式了，呃一面线段呢其实也是一样的。

我们可以把它投影到一个同平面平面内，然后去做快递测试，然后如果它是这个在同平面内是这个相交的，那么跟上面一样，它的异面直线距离，仍然可以用这个法医去求一面，现在距离仍然是这个法医所决定的。

如果它不是相交的，那么它的最近距离就就是发生在端点处，这时候我们还要再重新讨论一下，然后或者呢，如果你觉得刚刚这个方法太麻烦了的话，我们可以把它转换成一个优化问题，求极值，然后现在呢我们已经讲过了。

这个线与线的位置关系，我们就可以去看点与面的位这个位置关系，呃首先我们给出这个要带求解的点和面的定义，然后平面的方程跟刚刚一样好，平面Y有一点X，现在我们要求平面外这一点X到平面的距离。

他其实就等于在平面上任取一个点，然后将这个平面外一点和平面上这一点做差，求得一个向量，再求这个向量在法向的投影，这个距离是不受P点选取的影响，为什么这个点不受P点选取的影响，因为我们知道。

你就算取别的任何一个点，它和P点之间的差值，只会是一个与反方向垂直的向量，因为任何在平面内的向量都垂直于法向，所以你去你就算取这边一点P1撇，然后这P1撇减P得到的量，和N点乘之后都会消掉。

所以这个距离的计算是不受P点选取的影响，而通过这个方法，我们可以计算这个点与面的距离，但是呢如果大家这个在高等数学课上，应该都接触过，高等数学课上会给出一个呃，点与面的距离的计算方式是X加B加C。

Z加D的模长啊，或者是绝对值，然后除以根号下X方加B方加C方，然后这里要给出的这个平面的定义的是呢，是X加BY加CD加D等于零，然后他会说这个距离是这样去计算，然后我我们上面给出了。

这个用点乘和表达的形式，其实和这个形式是等价的，它为什么是等价的，我们其实只要把这个X减P点乘N的操作，给它全部都拆开成分量形式去计算就可以了，我们假设X的三个坐标分别是XYZ。

P的三个坐标分别是PXPYPZ，我们会列出这个式子，这个式子如果你把这个点乘去展开计算，我们就会把它整理成一个X加B为I加C，C加D等于零的形式，并且我们会发现，这个计算式和下面这个计算式是完全一样的。

完全一致，那么我们为什么还要去用这种方式去计算，点与面的距离呢，因为这种方式它是自动适用于二维的，因为呃我们知道二维的这个直线，如果我们把二维的直线定义成X加B，Y等于加ZC等于零的话。

然后二维的直线外一点到直线的距离，应该是什么呀，应该是X加B加C，除以根号下A方加B方，但是这个东西它其实跟这个完全是一致的对吧，就我们完全可以用这一个式子，既去求二维中点与线的距离。

也去求三维中点与面的距离，所以我们在这个计算结合当中，倾向于用向量的形式表达，而不是用这种完全展开的解析形式表达，然后从另一个角度说，就是我们这里给出了一个，这个就是我们定义平面的方式。

是一种影视的表示，而我们定义直线的方式呢，是一种这个参数的表示，其实直线也可以用这种影视的方式去表达，因为我们可以写成这个呃，某一点与直线上某个端点的差，向量和直线的朝向的差乘等于零。

我们也可以用一个映射表达，但我们一般会选择在二维的直线，去用一个参数表达T来表示，而在二维的三维的平面，用一个影视表达X减P点乘N等于零来表示啊，这个原因在于对于直线来说，它的这个参数的选取是很直接的。

我们只要取它的呃方向向量，然后取它方向向量的步长就可以，而对于平面来说，如果我们要给它一个参数表达的话，我们还需要先取平面上任意的两个这个切向量，然后用这个切向量在平面上构建一个坐标轴。

这个过程是相对来说不是唯一确定的，所以我们一般不这么去做，当然用这样去做的例子，我们已经看到了，刚刚我们看到的这个三角形的表达，它其实是一种参数表达，因为三角形的，因为三角形的三个顶点。

刚好给出了一个切向量的表达方式，讲完了这个点线面之间的关系，以及它们距离的求法以后，我们来看这个多边多边形，因为有了点线面，我们就可以去定义多边形了，呃多边形的两个重要参数，一个是周长，一个是面积。

分别要去怎么去计算呢，啊首先最好算的肯定是周长，因为我们只需要去遍历多边形的每条边，然后计算它模长求和，就可以算出这个多边形的周长了，那么多边形的面积要怎么算呢，这里我们假定多边形的面积。

是用逆时针序给出的，比如说在右边我们给出了一个三角形，三角形是最简单的多边形，P1P2P三，这是一个三角形，我们怎么去算这个三角形的面积呢，呃这个我们上节课已经说过了对吧，因为叉乘的定义。

就是还可以用来算二维三角形的面积，我们可以写成P2减P1，叉乘P3减P1，然后再去乘1/2，这样得到的就是三角形AP1P二P三，A123，这个啊P1P1P2P3，这个三角形的面积。

我们把这个面积记作A123呃，我们有没有别的计算方式呢，然后我们还给出了另一种计算方式，这种计算方式看起来貌似比第一种要繁琐很多，我们的做法是在任平面内任取一个点P0。

然后我们去先去计算三角形012的面积，012面积也就是这一块的面积，再去计算三角形023的面积，也就是这一块的面积，然后再去减掉三角形013的面积，就是这块的面积。

然后用这样的方式去得到三角形123的面积，然后如果我们把这个三角形的三个顶点的绕序，不是逆时针序的面积记作负的话，记作负值的话，我们就可以把三角形的面积写作A012，加上A023，加上A031。

我发现了什么，发现这个除了零一直在这个位置不变以外，后面是122331，它相当于正好我们以一个逆时针序，去遍历了三角形的每一对顶点，然后这是最简单的三角形面积的求法，我们再来看凸多边形的面积。

比如说右右边下图给出了一个凸边凸多边形，1234，我们想求它的面积，那么最简单的求法是，我们先去求三角形123的面积，再加上三角形134的面积，把这两部分的面积相加，就能得到整个凸多边形的面积。

但是和上面一样，我们也可以任取这个平面内一点P0，然后把这个多边形的面积表示成012的面积，加上023的面积，加上034的面积，在加上041的面积，实际上是减去014的面积。

也就是我们可以把它写成是012012，也就是这个三角形的面积加上023，这个三角形的面积，加上034，这个三角形面积减去014这个三角形的面积，发现规律都没有规律。

就是我们可以把他的任何一个多边形的面积，写成A0IJ，然后这里的IJ是逆时针序曲变，这个多边形的每个顶点，我们为什么要这样去算多边形的面积呢，因为我们并不能保证这个多边形，它是一个凸多边形。

对于一个凹多边形来说，对一个凹多边形来说，我随便给出一个凹多边形，对于这个凹多边形来说，我按照这个前一种方法是求不出来，这个正确的面积，就是按照这个图标圆形面积，这种求法我是得不到结果的。

当然这里并没有，并不应该有中间这条边，再有这条边，大家就会散，但如果没有中间这条边，这时候与其你想怎么去把它剖成三角形，你不如直接在平面内随便取一个点，然后按照刚刚所说的这个方法去算，这个求面积方法。

无论对于凸多边形还是凹多边形都是适用的，接下来我们再来看点和多边形的位置关系，首先我们刚刚已经给出了一个，求这个凸多边形面积的方法了，那么我们发现一个规律，就是说，如果我们取的这个点还是刚刚的这个例子。

如果我们取的这个点在多边形外的话，然后我们按逆时针序去计算，012023034041这些三角形的面积，我们会发现这些三角形的面积，如果我给它都取绝对值相加，也就是说，我认为01A041等于A014的话。

就是这里这个三角形，我们会发现这些三角形面积相加，是大于等于整个多边形的面积，而相反，如果我们这个参考点取的是在多边形内部，我们再用它和每个顶点的，绕细的三角形面积相加，它是正好等于这个凸多边形面积。

也就是说，如果我们能够把A和按A和A撇两种方式，因为A的方法，这个上面的这个方法得到的就是多边形面积，根据我们前一页PPT所讲，它就是多边形面积，而A撇是这个上面这个东西。

在求和过程中取了绝对值之后的结果，如果它和上面的A是相等的，那么我们取的参考点一定在多边形内，如果他取的参考和上面的A是不相等的，那么他取的参考点一定在多边形外，因为此时才会出现有的三角形的面积是负数。

这样的情况，对于凸多边形来说，除了面积法以外，还有绕叙法，比如我们给出一个在多边形内部的点，那么对于这点来说，每一条线段其实都在这个点的右边，或者说这个点在每一个多边形的边，所对应的线段的左边。

比如说这个是P0，然后P2减P1叉乘P0减P是大于零的，它是在往左转，同样的P2减P3叉乘P0，减P3到P2叉乘P0减P2也是大于零，然后我们P3P4减P3，P1减P4都是一样。

这个P0点在每一个边的对应的向量的左边，然后这个时候，这个P0点就一定是在多边形内部，但凡这个P0点不在任何一条边的左边，那么这个点他就不在这个图多边形的内部，然后上面的这个判断关系。

很容易拓展到三维里面，也就是说对于多面体的，这不是面积啊，这是体积，对于多面体的体积，或者点与凸多面体的位置关系，它都都是可以完全适用的，对于多面体的体积怎么算，我们可以去把这个A0IJ改成V0IJK。

把这个有向三角形改成这个有效的呃，那个四面体，而点与凸多面体的位置关系也是一样，如果这个点在凸多面体的每一个面的左边，就跟我们之前定义过半平面的概念，如果它在每一个凸多面体的半平面的，同一个方向。

那它一定就是在这个凸多面体的内部，否则它就在这个凸多面体的外部，然后呃，解决了这个点与凸多边形的位置关系的问题，以后，我们再来看点与任意多边形的位置关系，这个时候它它的解法就不是那么的自然。

它就是需要稍微需要一些，这个就是一些比较精巧的经验，一般而言，我们去考察点与任意多边形的位置关系，有两种算法，一种是这个光线投射算法，一种是回转数算法啊，这两种你可以看这个名字就看起来非常图形学。

首先光线投射算法，光线投射的算法是基于这个若尔当曲线定理，罗小刚限定理说，任何一条简单的B曲线可以将平面分成两部分，然后连接同一部分的任意两点的弧，与该曲线不相交，或者相加偶数次。

我我们怎么就是说怎么去举这个例子呢，我们可以画一个圆代表平面，然后一个简单的B任何一条简单的B曲线，他把这个盐的里面分成了两部分，那么连接同一部分的任意两点的弧，比如说连接这两点的弧，它要么是这么走。

不和这个里面的部分相交，要么和和这个简单的B曲线相交两次，或者你也可以这样绕出来再绕过来再绕过去，他反正相交都一定是偶数次，而如果是起始点在这里，而终止点在这个区域内的话。

它相交相交这个必须线的次数一定是奇数次，所以如果我们现在在判断点与多边形，位置关系的时候，我们把这个多边形就取成上面这个raw曲线定理，里面的简单闭曲线的，我们把从判断点出发，随便发一条射线。

把这条射线当做唱片曲线定义里面的糊的话，那么这个弧每与多边形相交一次，都会改变一次内外关系，而且无穷远点一定在多边形外，因为这个多边形是是一个有限大的，这样的一个图形嘛，所以无穷远点一定在多边形外。

此时我们就会得到这样的结论，一是相交点个数如果是奇数，那么点就在多边形内增加点个数，如果是偶数，那么点就在多边形外，我们可以看右边这幅示意图，我们要判断的点在这里，然后从这点出发，我们随便发一条射线。

它与这个多边形相交一次，然后这时候我们认为它是在里面相交，又碰到这里，放到这里两次，我们现在认为在外面，然后里面外外面里面外面，然后最后这个这个这条射线，只和多边形相交了偶数次。

所以我们就说它是在这个这个点，初始点是在多边形的外面，这里我们需要思考一些特殊的情况，比如说如果该射线与顶点的边是重合了，该怎么办，比如说我们要判断下面这个四边形里面，这个Y这个点。

我们判断这个Y这个点，它是在多边形内还是多边形外，那么如果我们取的射线正好是与X轴平行的，那么它就会撞到C这个点，那你撞到C这个点，到底算相交一次还是算相交两次呢，这个问题就很难处理。

然后其实最简单的解决方案就是，我们取射线的时候，我们不要取沿X轴对吧，我们把这个射线的夹角取成派的无理数倍，这样它重合的概率就几乎为零了，或者呢有一个更加健壮的算法，是我们规定涉县和射线以上的点在上方。

否则在下方，也就是说我们认为C这个点在射线的上方，然后当这个我们所发出的射线，与多边形的某条边相交的时候，只有这条边的两个点分别在上方和下方，我们才算相交，然后这时候我们看这个Y往右发的这条射线。

和CD这条边相交相交的时候，C和D这两个点都在这个射线的上方，所以我们不认为这个射线与CD这条边相交，而CB分别在上方和下方，我们认为这条射线与CB这条边相交，然后最终判断的相交次数就是一。

因为相差次数是一，所以我们说这个点是在多边形内，然后我们再来看这个刚刚这个定义方法，对于D这个X点这种情况是不是也是成立的，因为X点往右发一条射线会正好打到D，然后根据我们刚刚的判断法。

D这个点它是在射线上的，A点，在射线下，C点在射线下，所以X往右发射的这条射线和AD相交，和DC也相交，所以它和整个多边形的相交次数是二，所以我们判断X在多边形外，那这个算法就可以规避掉。

这个射线与顶点边重合，这样的所带来的数值上的问题，除了刚刚我们所说的这个光线投射法外，还有这个回转术法，回转数法是说一个曲线绕过某一点的次，是用一个曲线绕过某一点的次数。

来判断这个点是在多边形内还是多边形外，对于多边形内的点呢，多边形绕过该点的次数是一，对于多边形外的点的多边形，绕过该点的次数为零，然后这个事情是怎么看呢，比如说这个点是这样的，如果是个三角形形。

诶我们看到我们沿着三角形边走走一圈，正好绕过了这个点一次，而如果这个点在多边形外，比如说我们判断点在这里，然后我们会发现这个多边形绕，绕着它逆时针走一圈，最后绕着这个对于这个点来说绕了零圈。

那么如何去计算这个回转数呢，回转数其实它就等于回转角C塔除以二派，回转角，计算方式就是我们对于每一个多边形上的点，比如说多边形上的边，多边形上边对每一条多边形上的边，比如说这条向量。

这个向量对这个向量我们去求，这个夹子，这个夹角这个夹角我们叫它CAI，然后我们把每一个C塔I相加，就是西塔二了，就是CA3，就是西塔一，西塔一加西塔二加CA3，加起来正好等于二派。

所以它的相交次数是一啊，他的这个回回转数是一，所以它在多边形内，然后再看这个这个地方，这个地方的问题就在于我们先考察这条边，这条边是给了一个正的数，就是这个角CA1是正的，这个角西塔二是正的。

然后我们再来看这个角CA3的时候，它变成负的了，这个角C加四也是负的，这个角CA5也是负的，然后它们相加，正好抵掉了CA1和CA2这两个正值，所以最终得到的结果就是00÷20，这个回转数是零。

所以它在多边形外，而一般我们在算回转数的时候，会定义这个回转数的方向，也就是说我们逆时针绕一圈才认为是一，如果我们是顺时针绕一圈，会认为它是一，比如说我们在右边，右下角就给出了不同的回转数的可能。

然后也存在一些回转数大于，就是回转数绝对值大于一的情况，比如说这个呃左上角这个二，我们可以看到它绕过了中间这个点两圈，但是因为我们考察的是多边形对吧，一个简单的多边形是不可能自己和自己相交的。

所以对多边形来说，它只它对于任何一个点的环绕数，只有可能是一或者零，这就是火战术撒，然后给出了这个呃，判断点是不是在多边形内的算法以后呢，我们再来看看这个点和三角形，倒三角形的距离该怎么去算。

而这个过这个问题其实是一个很经典的问题，比如说在同学当中，我们有一个mesh，我们的mesh它是由三角形面片组成的，现在我要求一个点插到这个mesh的距离，那我们其实就相当于对于这个mesh上的。

每一个face，我们都要求这个点到这个face的距离，然后再求它的最小值，所以呃点到三角形的距离，这个问题对司机来说是很重要的，一个计算几何的应用，那么跟之前一样，我们先看二维情形。

在二维中就是这个平面当中，比如说平面当中有许多点，如果点在三角形内，那么显然距离是零啊，那么如果点在三角形Y呢，我们首先设距离是点到这个顶点位置的最小值，比如说右边我们求P3这个点到V1V2V零。

构成三角形的距离的时候，我们先求P3和V0V1V二，分别求它的距离，我们先把这个最近距离，设置为这三个值的最小值，然后我们再将什么呢，我们再将P3给投影到每条边上。

比如说P3投影到V0V2所在的这条边上，我们会得到这个点，我们发现这个投影点在V0V2的延长线上，那么这个点就不就说明这个同一点就不需要，然后RG3投影到V1V2这条边呢。

诶我们发现它的同一点没有在延长线上，它就在V1V2之间，这个时候我们就用这个点到这条边的距离，去更新刚刚我们求得的最小值，做完这两步以后，得到的距离就是点到三角形的最近距离。

那么能不能把刚刚这个过程给拓展到三维呢，其实是很简单的，就是我们首先就把一个三维的，比如说我们考察这个空间里的P0，这个点，我们想计算他到这个V1V2V零，这个三角形的距离要怎么算呢。

我们先把它投影到三角形所在的平面，如果这个同音点是在三角形内的，那么就知道这个距离就是点到平面的距离，如果这个同一点在三角形外呢，那这个距离其实是不是，它就相当于是这个投这个投影距离。

加上这个投影点到三角形的距离，然后我们用勾股定理算一下就能得到这个距离，所以三维情形和二维情形，几乎是就是只多了一个投影的过程，当然上面这个方法是不可避免的，会有一些讨论的。

就是我们需要去讨论这个二维情况下，点到三角形各边的投影距离，投影的那个点在不在延长线上，这个问题这个问题是回避不了，那么有没有一些就是不需要讨论的方式呢，那还是一样的，我们可以用利用三角形的参数表达。

把它转化为优化问题，因为我们刚刚说对三角形的任何一个内部的点，它其实是满足他等于UP1加VP，二加WP3，这样会给出三角形中任何一个点的表达表达式，然后我们把这个表达式和直线Y的啊。

和这个三角形外的那一做差，我们就会得到一个优化函数，我们现在就是要在这个U加V加W等于一，且他们都大于等于零，这个约束的情况下，去求上面这个优化函数的最小值，然后这样它就会变成一个优化问题啊。

关于优化问题如何去求解，这是我们这个这个学期课后面的内容，然后就是还是如果我们从图形学出发，刚刚我们给出了说有一个mesh，我们求这个点到mesh的距离，而现在我有两个mesh。

我想求这两个mesh之间的距离该怎么办，然后对，这个，二维情形来说，二维的两个三角形的距离，二维两个三角形它之间的距离应该怎么算，其实他们既然已经给出了点到三角形，具体的表达方表示方式。

我们其实可以把它写成三角形的三个顶点，分别对另一个三角形求一遍最近距离，然后再倒过来，用这三个顶点去求一次到这个三角形的最近距，然后这两个最近距离求最小值，就是这两个二维三角形的最近距离。

在这个过程当中，我们用到了一个定理啊，这个定理的证明就是我们不在这里给出，但是它可以很直观的理解，就是说两个二维中的三角形的最近距离，必然其中一个三角形要取到顶点上，呃如果你不相信这个定理的话呢。

还有另一种求两个三角形距离的方式，我们可以用18组点边距离的最小值来决定啊，好像这还是要建立在这个定理的基础上，就是呃除了求点面距离方式，你还可以用任何一个三角形的一个顶点，和另外三角形的三个三条边。

分别求一次最小值的方式来计算这个二维当中，两三角形间距，而这一切都建立在二维当中，任何两个三角形的距离，其中一个三角形必然要取在顶点上这个性质，然后在三维当中呢，跟二维是类似的。

我们可以取六组点面距离的最小值，然后或者呢我呃但是在我们就没有这个或者了，我没有这个取法，并且在二维当中，这是完备的，你取六组点面就已经找到了最近最近距离，就一定能保证你能找到最近距离了。

但在三维你取六组点面，不一定能把最近距离找到，因为你还要去考察九组边边的情况，我们可以看右图，右图上面的这个三角形，和下面这个三角形的最近距离，取代这个H和下面这个这个点，是在这个点和这个点上。

它们最近距离取在BAB这条边和，ED这条边的最近距离上，而并不取在任何一个顶点上，所以对三维来说，我们要把它分成两种情况去考虑，一种是取在顶点上，就是六组点面距离的最小值，和九组边边距离的最小值。

造型的距离，在就刚刚我们说的mesh to mesh的距离，它有什么用呢，在cg当中，它最主要的作用在碰撞检测上，然后在碰撞检测里面，我们一般会将碰撞检测分为两种，碰撞检测，第一种叫离散碰撞检测。

Discrete creation detection，我们简称DCD，然后第二种碰撞检测叫联系碰撞检测，然后就是continuous collision detection，我们叫CCD离散碰撞检测。

它在字面上就是说，我们要求两个三角形网格之间的距离，也就是说它的我刚刚已经给出了，离散碰撞检测的最基本的算法，那么连续碰撞检测是说，三角形网格的上的每一个顶点呢，它不仅有位置，还有速度。

比如说这些顶点它都有速度，而现在我想知道这两个三角形，经过多长时间会接触，这要怎么去算呢，我们要去考察上面还是一样的，我们要去考察这六组点面和这九组边边，我们要去计算他们都到什么时候会共面。

我们可以把这个方程给列出来，去判断他们什么时候会共面，然后在这个共面的方程，都会对应一个一元三次方程组，去解读这个时间T以后，我们再判断共面时是否解除这个算法，还是相对来说在实现上比较困难，然后呃。

感兴趣的同学可以去参考我，这个我们games的103的课程，讲完了三角形之间的距离呢，呃我们还要提一下这个德罗内三角剖分的概念，这是一个定义在二维上的内容，三角剖分是说我们要将点击连接为三角网格。

使得各个三角形的边呢是不相交的，比如说右右图这里有很多顶点，只有顶点只有顶点，然后我们要把这些顶点连起来，连成一个三角网格，然后并且这些边之间不不交叉，它是一个简单的网格，所谓德洛内三角剖分。

是说它它是以满足以下性质的三角剖分，第一个叫空源性，你们可以看到任意三角形，它的外接圆内都没有别的点，然后第二个性质叫规则化，它的这个所得的三角形的最小的角是最大的，在所有的三角剖分中。

我们可以证明德洛内三角破分所得的三角形，这三个内角当中的最小值，所有的三角形内角最小值取min是最大的，国内内三角剖分还有一些其他的性质，首先是所得结果，唯一就是不论你用什么算法求求得得。

那三角后分一定是一样的，然后第二个性质是，我们对它增删改顶点都会只影响这个局部，就我新加一个顶点，他顶多他顶多影响这个，他顶多会把这个原来的这个破分给翻转，但是不会影响到别的定位，并且三角剖分的最外层。

一定会形成一个凸多边形，就是它会给出一个最外层是凸多边形的，这样一种破门方式，三亚婆粉有一种对偶图，它的对偶是说它的对偶图叫沃罗诺伊图，沃罗诺伊图是它的目的是将平面划分为若干个。

由最近的控制点决定的区域，比如说右边这个图，就是我们保证平面内的任何一个点，它所属于的区域都是离他最近的那个点，那个点控制点典籍当中离他最近的点，如果我们对平面中的每一点都这样操作的话。

我们所得到的就是右边的这个图，这个图叫乌洛诺伊图，很容易可以证明，沃洛诺伊图就是德勒内三角剖分的对偶图，什么为什么是得到那三角部分的DIO图呢，其实它就相当于怎么去决定这些控制点呢。

它其实就是在这个三角剖分的每一条边，我们取它的中垂线，每条边去中垂线，然后这些这些中垂线会自然地相交，它们相交的结果就会形成下面的沃罗诺伊图，然后求三角剖分的算法比较的繁琐，然后呃。

而且我就是它已经超出了这个数学的范范畴了，它本身就是统计学的一部分，然后大家可以看这个games系列的其他课程，然后这里就是稍微带过一下，这个三角剖分的概念，在三角剖分以外呢，我们来看凸包。

首先我们来看二维的图表，二维图表的定义是，在平面上能包含给定点的最小的凸多边形，我们叫它粗暴，比如说右边这五个点所构成的这个典籍，我们想用一个最小凸边形把它包括起来，左边这个包括是不对的。

因为它不是凸的，而右边这个包括它就是一个凸多边形，然后其实在图形学当中，我们往往会用一些比凸包稍微放宽一点的，这样的结构，比如说轴对齐包围盒，也就是ABB它的定义和凸包非常相似，它也要包含给定点。

只不过它不是最小的凸多边形，而是与坐标轴平行的矩形，你可以看到右边这幅图，我们包含所有典籍的与坐标轴平行的矩形，是最外面的虚线，而包含这些典籍的这个凸包呢，我们可以换一，就这样一个对吧，那显然可以证明。

这个凸包一定是在轴对齐包围和之内的，所以轴对齐包围盒是凸包最粗糙的近似，有没有稍微厉害一点的，稍微厉害一点的，就是方向包围和方向包围盒也是要求是矩形，但是他放宽了轴对齐这个限制。

也就是我们这个矩形可以这么倒着取啊，当然我这个取法不一定是最优的，就是示意一下，就是对刚这个我们可以这么去取就行，哎，这个矩形说不定比轴对齐的矩形要小，所以它的定义方式，就是包含给定点的最小值的矩形。

这个最小的矩形不一定要是与坐标轴平行，然后除了以上两种包围盒以外，还有固定方向图包，固定方向图包和正常的图包最大区别在于，我们要求凸包的各个边或者是面，它怎么在法向只能在给定的集合当中选取。

那么从这个角度说，所谓轴对齐包围和，它岂不是它就是一种固定方向的凸包，对我们要求这个凸包的各个边，只能有这么几条边，只能有这几种边，这个这几种面我们用这几种编组合得到的凸包，所谓凸包就是轴对齐包围和。

然后如果我们放宽一点限制，比如说我们允许它斜45度，然后用这样的边拼出来的图形，他就是这个更广义的这个固定方向图包，它就会比轴对齐爆，为何要更接近我们真正的图包，当然啦在二维当中，其实去求准确的图包。

也不是一个非常困难的事情，呃对二维来说，我们观察这个二一个二维的典籍，我们会发现点击中纵坐标最小的点，它一定在一定在凸包上，点击中纵坐标最小的点一定在就是这个P点，他一定在这个图包上，为什么。

因为它底下没有别的点了，所以我们的凸包正好过它是最优的，同时我们发现在凸包上，逆时针走所经过的边一定都是左拐，但这都不需要管产，因为这都是通报的定义，我们需要它是这个简单的凸多边形嘛。

所以它逆时针走所经过的边一定是左拐，但是根据这两个性质，我们就可以去建立这个隔离横扫描法，也就是说，我们既然已知做这个图标上必然存在点一点，我们就把这个最这个纵坐标最小的点，P0先给压入这个站中。

然后我们把别的所有的点呢，按照对于P点的这个几角排序，也就是按几角排序，ABCD它们都是就是PA转到PB，PB转到PCPC转到pd，他们的几角是逐渐增大的，好现在我们去维护一个站。

我们先将P压P和A压入栈中，然后我们来考察哦，我把这个也标上去，这是零，这是一，这是二，这是三，这个就先写四吧，我们先考察这个P2点，然后我们发现从PA到ab是左转，他解释说他是符合凸包的性质。

所以我们就直接把这个B点入站，然后再来考察C点，这个从然后现在的栈顶是什么，栈顶是B点，然后站的第二个元素是A点，也就是说AB到BC是左转的吗，也是左转，所以我们把C压入栈中。

下午再来考察地点也从BC到CD是左转的吗，不是左转，这时候是右转，这时候是右转，右转我们就弹出栈顶C，然后我们再去判断从ab到BD是左转，是左转，然后我们把D压入栈中，然后重复上述过程。

直到我遍历完所有的点，我就一定会得到一个图包，这个算法的复杂度是n log n，它的主要的这个时间代价其实是几角排序这一，那也就是说只要你们排序能够做得更快，这个复杂度还能再降。

这个方法的效率是比较高的，然后我们再来看三维，三维就没有那么好的性质了，因为我们三维不存在一个几角序，那么我们怎么去构造图包呢，一个最简单的算法是增量法，就是我们要求N个点的图标。

我们先假定我们已知N减一个点的图标，我们考察一个新点，如果心点在图包内怎么判断呀，这个我们之前已经说过了对吧，它只要判断在每一条边的左啊，每个面的左边它就在左图包内，如果他在图包内呢，那么图包是不变的。

如果新点不在图包内怎么办，我们以该点为光源，比如说我们这个星点是这边这个pr，这个点我们以该点为光源，从这个点发射向四面发光的光线，那么它一定会在凸包上形成一个明暗的分界线，也就是并且这个明暗的分界线。

一定是凸包的棱组成的，也就是说这个凸包因为有很多小面嘛，这些面片要么能被这个光光源照到，要么不能被这个光源照到，然后我们怎么办，我们把亮面全部删除，然后连接顶光源和分界线，我们就能得到新的图包。

就图一做投影，然后我们把这些亮面都删掉，然后把把这个点和这个这些能连起来，我们就得到了加入了这个星点之后的图吧，然后这个算法的复杂度，可以证明它是N平方级别的，因为我每次考察一个星点的时候。

我要考察它和每一个面是否在每一个面的左边，然后还要遍历每个边，再去考察他是不是在每个边的啊，每每个边能不能被这个光源照到，所以这个复杂度就就是不可避免的会比较高，如何处理去多点供电的情况呢。

呃就是其实没有什么特别好的办法，一般大家的处理方式，都是在把输入的点进行一些随机扰动，去得到这个点共鸣，去避免这个点共鸣，然后三维图包还有一些其他的算法呃，比如说这个暴力法，暴力法其实是是这样的。

就是我有个典籍，典籍里面有N个点，那么这个N个点会构成CN3个三角形对吧，然后这个to bond凸包上的三角形，一定是由这CN3个三角形中的一些，三角形组成的。

所以我只需要去便利这CN3个三角形中的每个，三角形去判断它在不在图标上就可以了，怎么判断它在不在图包上呢，只要所有的点都在这个三角形的左边，它就在图包上，要么要么在这个就是这个三角形的顶点。

要么在它的左边，它就在图包上，然后我们这样去遍历每一个三角形，在判断它在不在图包上，诶这个这个方法，它就是它就能找到这个三维图包，然后很自然这个算法复杂度是N次方的，然后三维通报其他算法。

还有这个快速突破法，快速逃跑法，其实和增量法是这个逻辑上是完全一致的，只不过我每次选择的这个点，它不一定是这个随机的点，它们每次会挑一挑，把它挑成最远的那个点，就离当前凸包最远的那个点。

然后以这样的方式，我们能保证这个三维凸包的复杂度尽量的低，这叫快速图包法，但是呃这个快速图表法实现并没有那么容易，呃，现在的一些这个开源的计算机和库吧，一般都会有这个快速图包法，也包括前面的三角剖分。

大家可以直接调这些库就能去完成他们的计算，然后讲完凸包以后呢，我们再回到这个2D上去，看这个平面最近点对的问题，然后这个问题其实呃，我今天不打算在这里细讲了，因为其实它有这个在图形当中呢有应用。

但是呃可能大家更喜欢去写KDK对吧，因为kd tree不仅能适用于二维，也适用于三维，而且KTT不仅能找最近点对，还能去找别的一些东西，嗯而且最重要的是平原最近点对，是一道分支的经典例题。

然后大家再讲这个大学的呃算法课的时候，应该也都会学过，所以我们今天就跳过这一部分，来看一下最小圆覆盖，刚刚我们给了凸包，刚刚我们从凸包这个凸字到底应该按什么笔顺，写ABB，Oh bb。

还有这个定向图包对吧，那么如果我不用这个矩形，我能不能用圆去覆盖，我能不能去求包围该定点集的最小的圆呢，诶他也是可以修的，那么我们来看这个最小覆盖圆有什么性质，首先还是一样，凸包一定在最小覆盖圆内对吧。

然后最小覆盖圆它只有三种可能，第一种是圆心在某一点处半径为零，也就是说这个点其中只有一个点，那么这个最小覆盖圆就是圆心是它半径为零的，这个圆，或者是圆心在两点的中点处，直径是两点的距离。

或者是圆心是三个点所决定的，Why，这个三三角形的外接圆的半径，是这个外接圆的半径，只有这三种情况，我们可以感性的理解一下，比如说呃在右边这幅图，如果我一开始求出来的这个覆盖，原是最外层和这个圆。

如果我们先除的是最外层这个圆，那么这个圆显然不是最小，我们可以不断的缩小半径，直到它变成，街上中间的某一个点，然后接上中间某个点之后呢，我们发现这旁边都是空白，这边都是空白。

所以我们把这个圆心再移动一下，然后使得有正好有三个点落在这个圆上，那么这个得到的就是一个最小覆盖，然后对于其他的情况，比如说这边就如果我们把看考察这个情况，他最终得到最小圆，是以这两个点所构成的。

连线为直径的这样一个圆，他的圆心是在这两个连线的中点处，以上就是最小覆盖了所有的情况，那么最小覆盖圆是不是也可以增量构造呢，其实是也可以和图包一样去做这个增量构造，那么如果给定了一个N减一个点的。

最小覆盖圆的话，那么第N个点要么在上述圆内，或者呢这个新覆盖一定给我改点，这也很容易理解对吗，比如说我们考还是这个这里这个覆盖源，如果我们的我们新加一个点在这个覆盖原内，那我们就什么都不用做。

如果我们新加的点在覆盖圆外呢，那么我们这个覆盖原一定要过这个点对吧，因为也没有比他更靠外的点，所以他一定要过这个点，然后呃最小圆覆盖的算法是什么样的呢，呃其实是相当暴力的一个做法啊，就是三层循环。

我们先假设这个结果就是P1，这个点为圆心半径为零的这样一个圆，然后我们从二到N开始，如果呢PI是属于这个圆的，我们就直接进入下一次循环，就直接I加加就完事了，如果PI不是属于这个圆的，我们就得构造了呀。

然后我们说这个pi不是这个圆，说明它一定在圆上，我们先把这个圆取成以pi为圆心半径为零的圆，然后我们再回头去看，从一到2-1这些点，如果借在这个圆上呢，就直接下一次循环，如果J不在这个圆内呢。

我们就以IJ为直径去建立一个圆，那么它一定包含I和J这两个点吧，然后我们再进入下一次循环，如果pk属于这个圆呢，那我们就什么都不做，如果pk不属于这个圆呢，我们就构建一个以IJ。

K3个顶点为三角形的外接圆，就直接这么暴力三重循环就完事了，我们能保证最后找到的这个圆，最后找到这个圆一定是最优的，最下腐败，这个方法时间复杂度并不是N3方，而是ON的，这是很神奇的地方，为什么呢。

因为我们刚刚已经说过了，最小覆盖圆，它只有三种不同的情况对吧，我们要么用一个点，要么它是一个点，一个点半径为零，要么它是两个点，然后半径时距他们俩的距离除以二，要么是三个点，三个点直接确定一个外接圆。

所以说明什么，说明这个最小圆并不是可以任意取的，我们其实如果暴力去计算的话，我们其实只需要判断CN1加CN，二加CN3种情况，也就是只需要三个特定的点，我们就能够确定这个最小覆盖量。

那对于每次我们去看考察，要不要进入下一层循环，进入下一层循环的可能是什么呢，为进入下一层循环，只有可能在于我们当前构造的这个最小覆盖圆，必须过，比如说必须过A点，必须过A点，或者是必须过界点。

我们必须或者是必须过K点，他们的概率都只有O2分之三或者是借分之三，为什么呢，因为三个点就可以确定这个最小覆盖圆，那么如果我说这个最小覆盖圆一定要过界点，那么岂不是说，这个节点在这个这三三个点之内吗。

对吧，也就是他每次下进入下一层循环的概率，就是我当前要这个典籍的大小分之三，它只有这么多的概率会去建立一个以下一个点，为在圆上的这样一个情况所建立的圆，啊这概率只有3/2，所以我们算一下。

如果我们它就相当于是N3方，乘上这个N分之三，再乘以N分之三，最终得到的复杂度是9N，所以它是希望时间表达的都是线性，而并不是N立方的算法，当然这个复杂度的证明，可能稍微对大家来说不是那么直观。

如果理解不了，没有关系，大家只要知道这个最小圆覆盖，可以以ON的时间复杂度，用三层循环就解决就完事，然后这个最小圆覆盖是可以，直接拓展到最小球覆盖上，把二维拓展到三维。

其实三只是把三种情况变成了四种情况，除了刚刚我们所说的这个三种情况以外，我们还多了一个四点确定球面的情况，现在有哪四种情况呀，第一个情况还是一个点，他为球星半径为零，第二个是两个点。

两点的中点是球星半径，是这两点距离的除以二，然后第三个情况是，以这个三个点的外接圆为这个球的最大的圆，然后以这个外接圆的半径为这个球的半径，然后第四种情况就是由四个点所确定的，球面就是最小球覆盖。

而且最小球覆盖，因为我们进入下一层循环概率仍然是这么多，这个不变，所以随机增量法的期望鉴定复杂度仍然是不变，它仍然是线性，我们可以在线性的复杂度内构建最小球覆盖，但是求最小球覆盖的最大的难度。

困难点并不是这个复杂度高，而是求外接球的过程并不像求外接圆那么容易，事实上求外接圆本身也不是很容易的，而求外接球就更快，更更难算了，所以啊我们还可以采用模拟退火法，我们直接去随机圆和球星或者球星的位置。

然后我们对每个位置，如果我们球球星是给定的话，那么半径它就是到点击里面，每一个点的距离的最小最大值，然后我们可以去自由化这个圆，或者是球星的取取向，以这种方式来求最小圆覆盖或者最小球覆盖。

最小球覆盖或者说最小圆覆盖有什么用呢，它其实和我们之前所说的三角形和三角形距离，是有关系的，比如我们在做这个碰撞检测，或者是光线做渲染的时候，要求这个呃光线相交，我们都是要先判断一个点和某个三角形是一。

或者一个射线和某个三角形是不是相交，但这个过程会很麻烦对吧，我们需要一个数据结构去先粗糙的判断一下，它跟一大片三角形是不是相交的，如果它跟一大片三角形不是相交的，这一片三角形我都不用看了。

那么对于这一大片三角形，我需要一个数据结构来表示它，那怎么表示这一大片三角形，最精确的表示方法，就是求这一大片三角形的图包，然后稍微弱一点的取法就是ABB，或者是OBB，也或者是求覆盖。

然后呃求覆盖呢其实是一个更多的用在我呃，就是在同学当中，我把职业的墨迹擦一下，在同学当中呢，一般我们在做光线追踪的时候，好像写错了，我们是用AABB的，主要是用ab，然后在实时碰撞检测的时候。

我们是用这个球覆盖，因为对球去做它的碰撞检测是最容易的，也就是我们现在不把这个三角形看成三角形，因为我们之前去求三角形相不相交，或者是距离是什么的，那个算法太复杂了，那么就把这一片三角形看成个球。

我们直接去判断这两个球是不是相交的，如果这两球相交，我们就认为这两个半是碰撞，当然这一个mesh，我们可能还会有很多很多个球啊，不只是一个球，然后如果这些mesh都没有相交呢。

我们就认为这两个麦是这些球都没有相交，我们就认为这两个麦是没碰本，那他们具体怎么决定，这个球，就是可以用我们这里说的原覆盖，或者是球覆盖算法来决，而最后呢我们来看一下繁衍变换。

繁衍变换是说呃所谓繁衍是定义在点上呃，给定了某一个繁衍中心O它是一个顶，它是一个点，一个繁衍半径R它也是个实数，然后他其实给定了一个球或者是一个圆吧，在二维中，每一个顶点，每一个每一个空间当中的点。

关于这个圆都会有一个繁衍点，比如这里的P点和J的P1撇点，它就是反应点，一点和它的繁衍点之间呢会满足下面两条性质，第一点他们三点是共线的，第二个呢是它们到圆心的距离相乘，等于半径的平方。

那么很显然一个圆O内的点，它的繁衍点一定在圆OY，一个圆OY的点反应点一定在圆O内对吧，因为他们俩相乘等于平方嘛，那么就是D小于零，D1小于零，那么第二呃，第一小于R，D二一定大于R。

才能保证第一乘D2等于R方嘛，然后我们来看这个原这个繁衍，它的最重要的应用是什么呢，我们可以看一个过圆，这个反演圆的圆心O的这样一个圆，这个圆的繁衍是一个不过圆心O的直线，我们可以稍加证明一下。

我们先写出这个呃过点O的圆的表达式，它的方程是上面这个方程，它圆心我们设为X0Y0，然后我们既然说这个原点是在这个蓝圆，蓝色圆上，那么其实就是说X等于零，Y等于零的时候，它在圆上就是X0方加Y平方。

要是A方，然后我们它的繁衍关系是XY会被繁衍成X撇，Y撇，然后它们的坐标分别用R方比，X和R方比Y来给出，然后把以上式子联立就能得到这个绿线，它对应的直线方程，倒过来也是一样的，就是我给另一个不过圆的。

不过点O的直线，它反映之后一定是一个过点O的圆，那么这个东西它有什么用吗，我们如果我们想求过两圆，外一点与两圆相切的所有的圆，比如说，对，就比如说我们要求这样的已过这个点画一个圆。

要求这个圆和这两个圆都是相切的，这有几种画法，我们想求这个问题怎么办，那么其实我们知道我们就可以以这个点，为圆心，然后以任意大小的半径去做繁衍，那么所有的过这个点的圆都会变成直线。

而所有不过这个点的圆都会还是一个圆，然后最终我们就会变成两个圆，求它的公切线的问题，这比两个圆去求它的公切圆要简单多了好，这就是一个繁衍变换直接应用，但其实繁衍变换它在图形学当中的呃。

就是可能用处没有那么的大，但是如果我们换一个视角去想，其实繁衍的意义它可以用在它，它是什么呢，就是我们平时说镜像，镜像就是中间的平面左边的某一个点，经过镜像会得到这个点，就是P和P1P。

而繁衍呢就是圆内的某一个点P，它经过圆这个作为一个某种镜像，得到了一个点P1P，所以繁衍的意义它其实就是几何图形，关于球的镜像，而不是关于平面的镜像，然后我们后面再讲到微分方程求解的时候。

我们会说到格林函数法，也就是变向法，这个方法，其实它还在很大程度上和这个繁衍变换之间，是有共同之处的啊，到时候大家再来体会，然后繁衍变化，这个就是做一个知识的科普，并没要求大家去掌握。

好今天的主要的内容就是以上这些，然后参考资料主要是清华大学的呃，这两本计算几何的教材，然后呃刚刚我们课程中提到了王华明老师的games，103当中的lecture。

零九主要讲到了关于碰撞检测的相关的内容，是和我们今天所说的这个求三角形距离，是相关的，同时应该是在闫令琪老师的这个games101里面，也会提到这个关于ABB的构建之类的内容。

在求这个呃光线与这个mesh的香港，要检测的时候，还有课后练习啊，就是我们并不会每一节课都布置作业，因为那样的话这个大家做起来就要耗时太多了，所以我们这节课是没有作业的，如果大家希望呃。

去练习一下这节课所讲的内容的话，这里推荐了一些就是北大的开源评测系统，上面的这个一些练习题啊，大家可以按照下这些题号去刷，大家有什么关于本次课程的问题吗，这次课程应该还是比较简单，啊这个作业在哪里找到。

这个作业都是这个主播以前刷过的题，啊这些有有简单的，有难的，有简单的，有难的，有，你看那个上面什么通过人数比较多的，他就比较简单，对因为不要求大家上交，所以我们也不会用这次的这些。

大家自己课后练习的结果去评分，所以如果大家觉得自己对计算结合，已经完全掌握的话，并不会考核的这部分内容，然后如果这堂课刚开始的时候所说，其实它本身就已经是图形学的一部分了，他并不是特别书写的东西。

预科知识，这个我们在公众号上应该是已经推出来了，需要大家掌握线性代数和高等数学啊，没有别的预科知识，好的，那今天的课我们就差不多到这里，然后从下一次课开始，啊有同学说这个想知道的是这个是题号。

具体题目在哪里，大家在网上搜POJ，然后在里面搜题号就可以了，你在任何一个搜索引擎上搜PJ，应该得到的第一个答案，就是这个北大的评测系统，然后如果你有账号就直接登录，没有账号就注册一下。

然后从上下节课开始，就是应该有连续几周都是另一位师兄，给大家上这个呃，关于旋转SVD分解这些相关的内容，然后他的讲授风格可能和我不是很一致啊，他可能会讲得更这个浅显易懂一些。

然后更就是不像我有时候会讲一些，这个我个人认为就是很有意思的东西，但它未必和图形学结合那么紧密，然后呃另外师兄们可能会就是呃，和图形学的这个结合会更更加紧密一些，好那就感谢大家今天的捧场。



![](img/38f2e25ae223d12d3c0c7e7893b9577a_2.png)