# 课程 P139：网络架构演进与未来趋势 🌐

在本节课中，我们将跟随思科首席架构师 David Ward 的分享，回顾互联网与路由技术的发展历程，并探讨当前最前沿的技术趋势，如分段路由和软件定义网络。

---

## 从学术研究到商业互联网 🧪

David Ward 的职业生涯始于 90 年代中期的明尼苏达大学研究生院。当时，他参与了一个旨在证明“由高速网络连接的工作站集群，其计算能力可以超越超级计算机”的项目。

为了实现这个目标，他们部署了世界上第一个生产级的 ATM 网络，连接了 Sun 和 SGI 工作站。为了将各地的超级计算机连接起来以证明其计算能力，他们又构建了第一个广域 ATM 网络，连接了匹兹堡、明尼苏达、圣地亚哥等地的超级计算机中心。

然而，超级计算机之间使用一种名为 HIPI 的协议进行通信，而当时并没有现成的 HIPI 交换机。因此，David 和他的团队不得不发明了 HIPI 交换机以及 HIPI over ATM 的技术。在这个过程中，他们深入学习了如何构建高性能的广域网数据包生成器。

随后，他的工作转向升级中西部大学网络以及明尼苏达大学连接到当时还是 NSFNet 的互联网。在从事这些高速网络工作的同时，他发现自己对物理有机化学的博士研究非常困难，而网络技术则相对简单且有趣，于是他决定转向这个领域。

---

## 创业、收购与思科生涯 🚀

David 加入了一家初创公司，致力于开发 HIPI 交换机。他们的商业计划是连接全球所有的超级计算机。但这个计划面临两个问题：一是像 NASA 戈达德中心这样的庞大机构，只需要一台交换机；二是超级计算机价值数千万美元，而交换机只卖 35 万美元，市场容量有限。

就在此时，互联网开始从 NSFNet 走向商业化。他们团队利用 FPGA 和 ASIC 技术，在运行开源 BSD 系统的 Unix 机器上，构建了世界上第一台分布式转发路由器。这家初创公司后来被 Ascend Communications 收购，而 David 则加入了另一家后来被思科在 1999 年收购的小型初创公司，并一直工作至今。

在思科，David 主导设计了多款核心路由器，并担任了 iOS XR 操作系统的首席架构师。他提到，早年在大学进行高性能并行计算和操作系统的研究，为他后来设计多线程、模块化的网络操作系统奠定了深厚的基础。

---

## 互联网协议与架构的演进 🔄

在构建 NSFNet 和后来的商业化互联网时，服务提供商之间需要大量的协议扩展来实现互联和服务构建。David 和他的同事们共同发明了当今互联网架构的基础协议。

以下是当时为解决特定问题而发明的一些关键技术：
*   **MPLS**：当链路带宽受限且无法快速获得电路时，用于实现带宽预留和流量工程。
*   **三层 VPN**：用于连接使用重叠地址空间的企业网络，解决正确的 IP 路由问题。
*   **BGP, OSPF, ISIS**：构成了互联网路由和交换的核心协议栈。

这些发明大多是出于当时的实际需求，并且看着它们被快速部署到全球网络中，是一段非常有趣的经历。

---

## 分布式路由与集中式控制的融合 🤝

谈到软件定义网络时，David 提出了与常见观点略有不同的见解。他认为，完全分布式的、自主运行的路由器网络，在应对拓扑故障时能提供最快的保护和恢复能力，这是互联网设计之初应对核战威胁理念的现代体现。

然而，分布式路由也存在局限。为了扩展互联网规模，IP 地址在自治系统之间和内部被大量汇总。这导致了一个问题：当你想使用 MPLS 等技术在两个被汇总的地址之间建立隧道时，由于看不到对方的具体地址，操作会变得非常复杂。

因此，他主张将两者结合：
*   **分布式路由网络**：负责快速故障恢复和基础可达性。
*   **逻辑集中式控制器**：拥有跨越汇总边界的全局拓扑视图，可以轻松地建立端到端的路径，并实施服务质量等策略。

这种“增强型”模式结合了二者的优势：分布式路由擅长扩展，而集中式控制擅长跨越管理边界进行路径优化。

---

## 当前最前沿：分段路由技术 ⚡

David 目前最关注的技术是 **分段路由**。这项技术的目标是简化 MPLS 网络、流量工程和 VPN 服务，其核心方法是**减少协议和网络状态**。

传统 MPLS 流量工程使用 RSVP-TE 协议，需要路径上的每台设备都保留状态，存在扩展性问题。而分段路由采用了不同的思路：

1.  它利用现有的链路状态协议，在泛洪路由器、接口的 IP 地址和邻接关系时，“顺便”携带一个标签信息。
2.  这样，网络中的每个节点都获得了完整的拓扑信息和标签映射，但无需为每条隧道保留状态。
3.  当需要建立一条特定路径时，**SDN 控制器** 或头端设备只需要计算并压入一个标签栈，数据包就会按照预定路径转发，并能天然地利用等价多路径等特性。

其核心优势可以用一个简单的对比来概括：
*   **传统 RSVP-TE**：`信令协议逐跳建立状态，保留带宽。`
*   **分段路由**：`头端编程标签栈，网络无状态转发。`

这项技术解决了互联网架构中一个长期存在的问题：如何有效地在大量并行链路上进行流量负载均衡。它保留了快速重路由和流量工程的能力，同时极大地简化了操作。

---

## 迈向更智能的网络规划 🧠

David 指出了当前 IP/MPLS 网络在流量规划方面的两个主要问题：

1.  **基于头端的负载设计**：隧道发起者只能基于自己看到的拓扑信息（通常是预留带宽，而非实际利用率）来规划路径，无法感知网络其他部分的实时负载。
2.  **缺乏准入控制**：广域网上几乎没有真正的准入控制，主要依靠历史数据进行预测，无法应对瞬时流量波动。

为了解决这些问题，他们正在推动将更多实时信息（如链路延迟、利用率、抖动、丢包率）通过路由协议泛洪到网络中。这些信息不会被用于实时运行 SPF 算法改变路由，而是被**推送**到一个集中式控制器。

控制器拥有全局的实时拓扑和负载视图后，就可以做出更智能的决策：
*   克服最短路径路由的限制，充分利用所有已部署的带宽。
*   实现基于实时状态的流量调度和保护恢复。
*   为大数据迁移、内容缓存加载等“大象流”提供确定的网络路径。

这种方法将现代计算机科学的理念（数据推送、集中分析）应用于网络，旨在移除不必要的网络状态，实现更高效、更可控的广域网。

---

## 总结与展望 ✨

本节课我们一起回顾了互联网从学术研究到商业化的关键发展节点，以及核心路由协议的诞生背景。我们深入探讨了分布式路由与集中式 SDN 控制器的融合价值，并重点介绍了**分段路由**这一革命性技术，它通过减少网络状态和协议复杂性，为流量工程和负载均衡带来了新范式。最后，我们展望了通过向集中式控制器推送实时网络数据，来实现更智能、全局优化的网络流量调度和规划的未来。

David 最后鼓励对网络技术感兴趣的学生和从业者参与到相关的标准组织和开源项目中，因为网络领域，尤其是路由技术，依然充满活力与挑战。