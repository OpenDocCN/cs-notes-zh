# 5.2   查找树

> 原文：[`algs4.cs.princeton.edu/52trie`](https://algs4.cs.princeton.edu/52trie)

本节正在大规模建设中。

### 具有字符串键的符号表。

可以使用标准符号表实现。而是利用字符串键的附加结构。为字符串（以及其他以数字表示的键）定制搜索算法。目标：像哈希一样快速，比二叉搜索树更灵活。可以有效地支持额外的操作，包括前缀和通配符匹配，例如，IP 路由表希望转发到 128.112.136.12，而实际上转发到 128.112 是它已知的最长匹配前缀。附带好处：快速且占用��间少的字符串搜索。

**R 向查找树。** 程序 TrieST.java 使用多向查找树实现了一个字符串符号表。

**三向查找树。** 程序 TST.java 使用三向查找树实现了一个字符串符号表。

参考：[快速排序和搜索的算法](http://www.cs.princeton.edu/~rs/strings/paper.pdf) 作者 Bentley 和 Sedgewick。

*属性 A.*（Bentley-Sedgewick）给定一个输入集，无论字符串插入的顺序如何，其 TST 中的节点数都是相同的。

证明。在集合中，TST 中每个不同字符串前缀都有一个唯一的节点。节点在 TST 中的相对位置可能会根据插入顺序而改变，但节点数是不变的。

### 高级操作。

通配符搜索，前缀匹配。R 向查找树和 TST 实现包括用于通配符匹配和前缀匹配的代码。

惰性删除 = 更改单词边界位。急切删除 = 清理任何死亡父链接。

应用：T9 手机文本输入。用户使用手机键盘键入；系统显示所有对应的单词（并在唯一时自动完成）。如果用户键入 0，系统会显示所有可能的自动完成。

#### 问答

#### 练习

1.  编写 R 向查找树字符串集和 TST 的非递归版本。

1.  **长度为 L 的唯一子字符串。** 编写一个程序，从标准输入中读取文本并计算其包含的长度为 L 的唯一子字符串的数量。例如，如果输入是`cgcgggcgcg`，那么长度为 3 的唯一子字符串有 5 个：`cgc`、`cgg`、`gcg`、`ggc`和`ggg`。应用于数据压缩。*提示*：使用字符串方法`substring(i, i + L)`提取第 i 个子字符串并插入符号表。另一种解决方案：使用第 i 个子字符串的哈希值计算第 i+1 个子字符串的哈希值。在第一千万位数的π或者第一千万位数的π上测试它。

1.  **唯一子字符串。** 编写一个程序，从标准输入中读取文本并计算任意长度的不同子字符串的数量。（可以使用后缀树非常高效地完成。）

1.  **文档相似性。** 要确定两个文档的相似性，计算每个*三字母组*（3 个连续字母）的出现次数。如果两个文档的三字母组频率向量的欧几里德距离很小，则它们相似。

1.  **拼写检查。** 编写一个程序 SpellChecker.java，它接受一个包含英语词汇的字典文件的名称，然后从标准输入读取字符串并打印出不在字典中的任何单词。使用一个字符串集。

1.  **垃圾邮件黑名单。** 将已知的垃圾邮件地址插入到存在表中，并用于阻止垃圾邮件。

1.  **按国家查找 IP。** 使用数据文件[ip-to-country.csv](http://introcs.cs.princeton.edu/data/ip-to-country.csv)来确定给定 IP 地址来自哪个国家。数据文件有五个字段（IP 地址范围的开始，IP 地址范围的结束，两个字符的国家代码，三个字符的国家代码和国家名称。请参阅[IP-to-country 网站](http://ip-to-country.directi.com/)。IP 地址不重叠。这样的数据库工具可用于：信用卡欺诈检测，垃圾邮件过滤，网站上语言的自动选择以及 Web 服务器日志分析。

1.  **Web 的倒排索引。** 给定一个网页列表，创建包含网页中包含的单词的符号表。将每个单词与出现该单词的网页列表关联起来。编写一个程序，读取一个网页列表，创建符号表，并通过返回包含该查询单词的网页列表来支持单词查询。

1.  **Web 的倒排索引。** 扩展上一个练习，使其支持多词查询。在这种情况下，输出包含每个查询词至少出现一次的网页列表。

1.  **带有重复项的符号表。**

1.  **密码检查器。** 编写一个程序，从命令行读取一个字符串和从标准输入读取一个单词字典，并检查它是否是一个“好”密码。在这里，假设“好”意味着（i）至少有 8 个字符长，（ii）不是字典中的单词，（iii）不是字典中的单词后跟一个数字 0-9（例如，hello5），（iv）不是由一个数字分隔的两个单词（例如，hello2world）。

1.  **反向密��检查器。** 修改上一个问题，使得（ii）-（v）也适用于字典中单词的反向形式（例如，olleh 和 olleh2world）。*巧妙的解决方案*：将每个单词及其反向形式插入符号表中。

1.  **随机电话号码。** 编写一个程序，接受一个命令行输入 N，并打印 N 个形式为（xxx）xxx-xxxx 的随机电话号码。使用符号表避免多次选择相同的号码。使用这个[区号列表](http://introcs.cs.princeton.edu/data/phone.na.txt)来避免打印虚假的区号。使用 R 向 Trie。

1.  **包含前缀。** 向`StringSET`添加一个方法`containsPrefix()`，接受字符串 s 作为输入，并在集合中存在包含 s 作为前缀的字符串时返回 true。

1.  **子字符串匹配。** 给定一个（短）字符串列表，您的目标是支持查询，其中用户查找字符串 s，您的任务是报告列表中包含 s 的所有字符串。*提示*：如果您只想要前缀匹配（字符串必须以 s 开头），请使用文本中描述的 TST。要支持子字符串匹配，请将每个单词的后缀（例如，string，tring，ring，ing，ng，g）插入 TST 中。

1.  **Zipf 定律。** 哈佛语言学家乔治·齐普夫观察到，包含 N 个单词的英文文本中第 i 个最常见单词的频率大致与 1/i 成比例，其中比例常数为 1 + 1/2 + 1/3 + ... + 1/N。通过从标准输入读取一系列单词，制表它们的频率，并与预测的频率进行比较来测试[“齐普夫定律”](http://acm.uva.es/p/v101/10126.html)。

1.  **打字猴和幂律。**（Micahel Mitzenmacher）假设一个[打字猴](http://citeseer.nj.nec.com/553345.html)通过将每个 26 个可能的字母以概率 p 附加到当前单词来创建随机单词，并以概率 1 - 26p 完成单词。编写一个程序来估计生成的单词*长度*的频率分布。如果“abc”被生成多次，则只计算一次。

1.  **打字猴和幂律。** 重复上一个练习，但假设字母 a-z 出现的概率与以下概率成比例，这是英文文本的典型概率。

    | CHAR | FREQ |   | CHAR | FREQ |   | CHAR | FREQ |   | CHAR | FREQ |   | CHAR | FREQ |
    | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
    | A | 8.04 |  | G | 1.96 |  | L | 4.14 |  | Q | 0.11 |  | V | 0.99 |
    | B | 1.54 |  | H | 5.49 |  | M | 2.53 |  | R | 6.12 |  | W | 1.92 |
    | C | 3.06 |  | I | 7.26 |  | N | 7.09 |  | S | 6.54 |  | X | 0.19 |
    | D | 3.99 |  | J | 0.16 |  | O | 7.60 |  | T | 9.25 |  | Y | 1.73 |
    | E | 12.51 |  | K | 0.67 |  | P | 2.00 |  | U | 2.71 |  | Z | 0.09 |
    | F | 2.30 |  |

1.  **书的索引。** 编写一个程序，从标准输入中读取一个文本文件，并编制一个按字母顺序排列的索引，显示哪些单词出现在哪些行，如下所示的输入。忽略大小写和标点符号。

    ```
    It was the best of times,
    it was the worst of times,
    it was the age of wisdom,
    it was the age of foolishness,

    age 3-4
    best 1
    foolishness 4
    it 1-4
    of 1-4
    the 1-4
    times 1-2
    was 1-4
    wisdom 4
    worst 2

    ```

1.  **熵。** 我们定义一个包含 N 个单词的文本语料库的*相对熵*为 E = 1 / (N log N) * sum (p[i] log(k) - log(p[i]), i = 1..k)，其中 p_i 是单词 i 出现的次数的比例。编写一个程序，读取一个文本语料库并打印出相对熵。将所有字母转换为小写，并将标点符号视为空格。

1.  **最长前缀。** 真或假。二进制字符串 x 在符号表中的最长前缀要么是 x 的下取整，要么是 x 的上取整（如果 x 在集合中则两者都是）。

    错误。在 { 1, 10, 1011, 1111 } 中，1100 的最长前缀是 1，而不是 1011 或 1111。

#### 创意练习

#### 网页练习
