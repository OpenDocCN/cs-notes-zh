![](img/9fab00c46a74e6ad5591779d88bfd206_0.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_1.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_2.png)

# æ–¯å¦ç¦å¤§å­¦ã€ŠCS106Lï¼šC++ç¼–ç¨‹ã€‹è¯¾ç¨‹ç¬”è®° - ç¬¬2è®²ï¼šæµ (Streams) ğŸ“š

![](img/9fab00c46a74e6ad5591779d88bfd206_3.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_5.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_7.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_9.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_10.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_12.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è¦å­¦ä¹ C++ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼š**æµ (Streams)**ã€‚æµæ˜¯ç¨‹åºä¸å¤–éƒ¨ä¸–ç•Œï¼ˆå¦‚æ§åˆ¶å°ã€æ–‡ä»¶ã€ç½‘ç»œç­‰ï¼‰è¿›è¡Œæ•°æ®äº¤äº’çš„ç»Ÿä¸€æ¥å£ã€‚æˆ‘ä»¬å°†ä»é«˜å±‚æ¬¡æ¦‚è¿°å¼€å§‹ï¼Œç„¶åæ·±å…¥æ¢è®¨å­—ç¬¦ä¸²æµã€çŠ¶æ€ä½ä»¥åŠè¾“å…¥/è¾“å‡ºæµï¼Œæœ€åç®€è¦äº†è§£æµæ“ä½œç¬¦ã€‚

---

![](img/9fab00c46a74e6ad5591779d88bfd206_14.png)

## æ¦‚è¿°ï¼šä¸ºä»€ä¹ˆéœ€è¦æµï¼Ÿ ğŸ¤”

æˆ‘ä»¬é€šå¸¸å¸Œæœ›ç¨‹åºèƒ½ä¸å„ç§å¤–éƒ¨è®¾å¤‡äº¤äº’ï¼Œä¾‹å¦‚é”®ç›˜ã€æ§åˆ¶å°ã€æ–‡ä»¶ã€ç½‘ç»œç­‰ã€‚æµæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ¥å¤„ç†æ‰€æœ‰è¿™äº›äº¤äº’ã€‚æ— è®ºä½ æ˜¯å‘å±å¹•æ‰“å°å†…å®¹ã€ä»æ–‡ä»¶è¯»å–æ•°æ®ï¼Œè¿˜æ˜¯é€šè¿‡ç½‘ç»œå‘é€ä¿¡æ¯ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç›¸ä¼¼çš„æ“ä½œæ–¹å¼ã€‚

ä¾‹å¦‚ï¼Œå‘æ§åˆ¶å°è¾“å‡ºå†…å®¹ä½¿ç”¨ `cout`ï¼Œå…¶æ“ä½œç¬¦æ˜¯ `<<`ã€‚è¿™ä¸ªç»Ÿä¸€çš„æ¥å£æŠ½è±¡äº†åº•å±‚å¤æ‚çš„è¯»å†™è¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬åªéœ€å…³æ³¨æ•°æ®çš„è½¬æ¢å’Œä¼ è¾“ã€‚

---

![](img/9fab00c46a74e6ad5591779d88bfd206_16.png)

## C++å­—ç¬¦ä¸²å¿«é€Ÿå…¥é—¨ ğŸš€

åœ¨æ·±å…¥æµä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¿«é€Ÿå›é¡¾ä¸€ä¸‹C++ä¸­çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºæµç»å¸¸å¤„ç†å­—ç¬¦ä¸²æ•°æ®ã€‚

åœ¨C++ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `std::string` ç±»å‹æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚

```cpp
std::string str = "hello world";
```

**è®¿é—®å’Œä¿®æ”¹å­—ç¬¦**ï¼šä½ å¯ä»¥åƒè®¿é—®æ•°ç»„ä¸€æ ·è®¿é—®å’Œä¿®æ”¹å­—ç¬¦ä¸²ä¸­çš„å•ä¸ªå­—ç¬¦ã€‚C++å­—ç¬¦ä¸²æ˜¯é›¶ç´¢å¼•çš„ã€‚

```cpp
std::cout << str[1]; // è¾“å‡º 'e'
str[1] = 'i'; // å°†å­—ç¬¦ä¸²ä¿®æ”¹ä¸º "hillo world"
```

![](img/9fab00c46a74e6ad5591779d88bfd206_18.png)

**é‡è¦åŒºåˆ«**ï¼šC++ä¸­æœ‰ä¸¤ç§å­—ç¬¦ä¸²ï¼šCé£æ ¼å­—ç¬¦ä¸²ï¼ˆ`char*` æˆ– `char[]`ï¼‰å’ŒC++å­—ç¬¦ä¸²ï¼ˆ`std::string`ï¼‰ã€‚åœ¨C++ç¼–ç¨‹ä¸­ï¼Œåº”ä¼˜å…ˆä½¿ç”¨ `std::string`ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€åŠŸèƒ½æ›´å¼ºå¤§ã€‚

---

## æµçš„é«˜å±‚æ¬¡æ¦‚å¿µ ğŸŒŠ

æµçš„æ ¸å¿ƒç†å¿µæ˜¯å°†ç¨‹åºä¸å¤–éƒ¨è®¾å¤‡çš„äº¤äº’æŠ½è±¡ä¸ºå¯¹ä¸€ä¸ª**å­—ç¬¦ç¼“å†²åŒº**çš„è¯»å†™æ“ä½œã€‚

å½“ä½ å‘æµå†™å…¥æ•°æ®ï¼ˆä¾‹å¦‚ `cout << 3.14`ï¼‰æ—¶ï¼š
1.  æ•°æ®ï¼ˆå¦‚åŒç²¾åº¦æµ®ç‚¹æ•° `3.14`ï¼‰è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼ã€‚
2.  å­—ç¬¦ä¸²è¢«æ”¾å…¥æµçš„å†…éƒ¨ç¼“å†²åŒºã€‚
3.  æµè´Ÿè´£å°†ç¼“å†²åŒºçš„å†…å®¹ä¼ è¾“åˆ°ç›®æ ‡è®¾å¤‡ï¼ˆå¦‚æ§åˆ¶å°ï¼‰ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_20.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_22.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_24.png)

å½“ä½ ä»æµè¯»å–æ•°æ®æ—¶ï¼Œè¿‡ç¨‹ç›¸åã€‚æµä¼šä»ç¼“å†²åŒºè¯»å–å­—ç¬¦ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºä½ æŒ‡å®šçš„ç±»å‹ï¼ˆå¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ï¼‰ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_26.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_28.png)

è¿™ç§æŠ½è±¡è®©æˆ‘ä»¬æ— éœ€å…³å¿ƒæ•°æ®å¦‚ä½•å…·ä½“åœ°æ˜¾ç¤ºåˆ°å±å¹•æˆ–ä»æ–‡ä»¶è¯»å–ï¼Œåªéœ€å…³æ³¨ä¸ç¼“å†²åŒºçš„äº¤äº’ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_30.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_32.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_34.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_35.png)

---

![](img/9fab00c46a74e6ad5591779d88bfd206_37.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_39.png)

## å­—ç¬¦ä¸²æµ (String Streams) ğŸ”¤

å­—ç¬¦ä¸²æµæ˜¯æœ€ç®€å•çš„æµç±»å‹ï¼Œå®ƒä¸ä¸ä»»ä½•å¤–éƒ¨è®¾å¤‡å…³è”ï¼Œåªç”¨äºåœ¨å†…å­˜ä¸­è¿›è¡Œå­—ç¬¦ä¸²çš„è½¬æ¢å’Œæ ¼å¼åŒ–ã€‚å®ƒå®Œç¾åœ°å±•ç¤ºäº†æµçš„â€œè½¬æ¢â€åŠŸèƒ½ã€‚

ä¸»è¦æœ‰ä¸¤ç§å­—ç¬¦ä¸²æµï¼š
*   `std::ostringstream`ï¼šç”¨äºè¾“å‡ºï¼ˆæ„å»ºå­—ç¬¦ä¸²ï¼‰ã€‚
*   `std::istringstream`ï¼šç”¨äºè¾“å…¥ï¼ˆè§£æå­—ç¬¦ä¸²ï¼‰ã€‚

### è¾“å‡ºå­—ç¬¦ä¸²æµ (ostringstream)

![](img/9fab00c46a74e6ad5591779d88bfd206_41.png)

è¾“å‡ºå­—ç¬¦ä¸²æµå…è®¸ä½ å°†å„ç§ç±»å‹çš„æ•°æ®â€œå†™å…¥â€åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ç¼“å†²åŒºä¸­ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_43.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_45.png)

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `ostringstream` çš„åŸºæœ¬æ­¥éª¤ï¼š

é¦–å…ˆï¼Œä½ éœ€è¦åŒ…å«å¤´æ–‡ä»¶å¹¶å£°æ˜ä¸€ä¸ª `ostringstream` å¯¹è±¡ã€‚

```cpp
#include <sstream> // å­—ç¬¦ä¸²æµæ‰€éœ€çš„å¤´æ–‡ä»¶
std::ostringstream oss;
```

![](img/9fab00c46a74e6ad5591779d88bfd206_47.png)

æ¥ç€ï¼Œä½ å¯ä»¥ä½¿ç”¨æ’å…¥è¿ç®—ç¬¦ `<<` å‘æµä¸­å†™å…¥å†…å®¹ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_49.png)

```cpp
oss << "The answer is: ";
oss << 42;
```

![](img/9fab00c46a74e6ad5591779d88bfd206_51.png)

æœ€åï¼Œä½ å¯ä»¥ä½¿ç”¨ `.str()` æˆå‘˜å‡½æ•°è·å–ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„ `std::string` è¿”å›ã€‚

```cpp
std::string result = oss.str();
std::cout << result; // è¾“å‡º: The answer is: 42
```

![](img/9fab00c46a74e6ad5591779d88bfd206_53.png)

**ä¸€ä¸ªé‡è¦æ¦‚å¿µâ€”â€”ä½ç½®æŒ‡é’ˆ**ï¼šæµå†…éƒ¨æœ‰ä¸€ä¸ªâ€œä½ç½®æŒ‡é’ˆâ€ï¼ŒæŒ‡ç¤ºä¸‹ä¸€ä¸ªè¯»å†™æ“ä½œå‘ç”Ÿçš„ä½ç½®ã€‚å½“ä½ åœ¨ä¸€ä¸ªå…¨æ–°çš„ `ostringstream` ä¸Šå†™å…¥æ—¶ï¼Œä¼šä»å¼€å¤´è¦†ç›–ã€‚å¦‚æœä½ å¸Œæœ›ä»æœ«å°¾è¿½åŠ ï¼Œå¯ä»¥åœ¨æ„é€ æ—¶æŒ‡å®šæ¨¡å¼ã€‚

```cpp
// ä»æœ«å°¾å¼€å§‹å†™å…¥ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰
std::ostringstream oss(std::ios::ate);
oss << "Initial";
oss << "Appended";
std::cout << oss.str(); // è¾“å‡º: InitialAppended
```

![](img/9fab00c46a74e6ad5591779d88bfd206_55.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_57.png)

### è¾“å…¥å­—ç¬¦ä¸²æµ (istringstream)

![](img/9fab00c46a74e6ad5591779d88bfd206_59.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_61.png)

è¾“å…¥å­—ç¬¦ä¸²æµå…è®¸ä½ ä»ä¸€ä¸ªå·²æœ‰çš„å­—ç¬¦ä¸²ä¸­â€œè¯»å–â€å¹¶è§£æå‡ºå„ç§ç±»å‹çš„æ•°æ®ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_63.png)

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `istringstream` çš„åŸºæœ¬æ­¥éª¤ï¼š

![](img/9fab00c46a74e6ad5591779d88bfd206_65.png)

é¦–å…ˆï¼Œç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ¥åˆå§‹åŒ– `istringstream`ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_67.png)

```cpp
std::string data = "123 45.6 hello";
std::istringstream iss(data);
```

ç„¶åï¼Œä½¿ç”¨æå–è¿ç®—ç¬¦ `>>` ä»æµä¸­è¯»å–æ•°æ®åˆ°å˜é‡ä¸­ã€‚æµä¼šè‡ªåŠ¨è·³è¿‡ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€æ¢è¡Œã€åˆ¶è¡¨ç¬¦ç­‰ï¼‰ï¼Œå¹¶å°è¯•å°†è¯»å–åˆ°çš„â€œæ ‡è®°â€è½¬æ¢ä¸ºç›®æ ‡å˜é‡çš„ç±»å‹ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_69.png)

```cpp
int num;
double val;
std::string word;

iss >> num;   // è¯»å–æ•´æ•° 123
iss >> val;   // è¯»å–æµ®ç‚¹æ•° 45.6
iss >> word; // è¯»å–å­—ç¬¦ä¸² "hello"
```

![](img/9fab00c46a74e6ad5591779d88bfd206_71.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_73.png)

**ç±»å‹è½¬æ¢æ˜¯å…³é”®**ï¼š`>>` æ“ä½œç¬¦ä¼šæ ¹æ®ä½ æä¾›çš„å˜é‡ç±»å‹è¿›è¡Œè½¬æ¢ã€‚å¦‚æœä½ å°è¯•å°† `"hello"` è¯»å…¥ä¸€ä¸ª `int` å˜é‡ï¼Œæ“ä½œä¼šå¤±è´¥ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_75.png)

---

![](img/9fab00c46a74e6ad5591779d88bfd206_77.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_79.png)

## æµçš„çŠ¶æ€ä½ (State Bits) ğŸš¦

å½“æˆ‘ä»¬ä»æµä¸­è¯»å–æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå¤±è´¥ï¼ˆä¾‹å¦‚ç±»å‹ä¸åŒ¹é…ã€åˆ°è¾¾æœ«å°¾ï¼‰ã€‚æµä½¿ç”¨å››ä¸ªçŠ¶æ€ä½æ¥è®°å½•å…¶å½“å‰çŠ¶æ€ï¼š

![](img/9fab00c46a74e6ad5591779d88bfd206_81.png)

1.  **`goodbit`**ï¼šä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰é”™è¯¯ã€‚
2.  **`failbit`**ï¼šä¸Šä¸€æ¬¡è¯»å–/å†™å…¥æ“ä½œå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå°è¯•å°† `"abc"` è¯»å…¥ `int`ï¼‰ã€‚
3.  **`eofbit`**ï¼šå·²åˆ°è¾¾æµçš„æœ«å°¾ï¼ˆEnd Of Fileï¼‰ã€‚
4.  **`badbit`**ï¼šå‘ç”Ÿäº†ä¸æµç¼“å†²åŒºç›¸å…³çš„ä¸¥é‡é”™è¯¯ï¼ˆå¾ˆå°‘è§ï¼‰ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_83.png)

**çŠ¶æ€ä½çš„é‡è¦æ€§**ï¼šä¸€æ—¦ `failbit` æˆ– `badbit` è¢«è®¾ç½®ï¼Œæ‰€æœ‰åç»­çš„æµæ“ä½œéƒ½ä¼šè¢«å¿½ç•¥ï¼Œç›´åˆ°ä½ æ¸…é™¤äº†è¿™äº›é”™è¯¯çŠ¶æ€ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_85.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_87.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_89.png)

ä½ å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°æ¥æ£€æŸ¥è¿™äº›çŠ¶æ€ï¼š
*   `stream.good()`
*   `stream.fail()`
*   `stream.eof()`
*   `stream.bad()`

![](img/9fab00c46a74e6ad5591779d88bfd206_91.png)

**ä¸€ä¸ªå…³é”®ç‚¹**ï¼š`good()` å¹¶é `fail()` çš„ç®€å•å¯¹ç«‹é¢ã€‚`good()` ä»…åœ¨**æ‰€æœ‰**é”™è¯¯ä½éƒ½æœªè®¾ç½®æ—¶ä¸ºçœŸã€‚è€Œ `fail()` ä¸ºçœŸæ—¶ï¼Œ`good()` å¿…ç„¶ä¸ºå‡ã€‚é€šå¸¸æˆ‘ä»¬æ›´å…³å¿ƒ `fail()` å’Œ `eof()`ã€‚

### å®è·µï¼šå®ç° `stringToInteger` å‡½æ•°

åˆ©ç”¨å­—ç¬¦ä¸²æµå’ŒçŠ¶æ€ä½ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå¥å£®çš„å­—ç¬¦ä¸²è½¬æ•´æ•°å‡½æ•°ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_93.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_95.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_97.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_99.png)

åŸºæœ¬æ€è·¯ï¼š
1.  ç”¨è¾“å…¥å­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ª `istringstream`ã€‚
2.  å°è¯•ä»ä¸­è¯»å–ä¸€ä¸ªæ•´æ•°ã€‚
3.  æ£€æŸ¥è¯»å–æ“ä½œåæµçš„çŠ¶æ€ã€‚
    *   å¦‚æœ `failbit` è¢«è®¾ç½®ï¼Œè¯´æ˜æ ¹æœ¬æ²¡èƒ½è¯»å–æ•´æ•°ã€‚
    *   å¦‚æœè¯»å–æˆåŠŸåï¼Œæµä¸­è¿˜æœ‰éç©ºç™½å­—ç¬¦ï¼Œè¯´æ˜è¾“å…¥ä¸â€œçº¯å‡€â€ï¼ˆå¦‚ `"123abc"`ï¼‰ã€‚
4.  æ ¹æ®çŠ¶æ€å†³å®šæ˜¯è¿”å›æ•´æ•°è¿˜æ˜¯æŠ›å‡ºé”™è¯¯ã€‚

ä»¥ä¸‹æ˜¯æ ¸å¿ƒä»£ç æ¡†æ¶ï¼š

![](img/9fab00c46a74e6ad5591779d88bfd206_101.png)

```cpp
int stringToInteger(const std::string& str) {
    std::istringstream iss(str);
    int result;
    iss >> result; // å°è¯•è¯»å–

    // æ£€æŸ¥æ˜¯å¦è¯»å–å¤±è´¥ï¼Œæˆ–è€…è¯»å–åè¿˜æœ‰å¤šä½™å†…å®¹
    if (iss.fail() || !iss.eof()) {
        // æŠ›å‡ºå¼‚å¸¸æˆ–è¿›è¡Œé”™è¯¯å¤„ç†
        throw std::domain_error("å­—ç¬¦ä¸²æ— æ³•è½¬æ¢ä¸ºæ•´æ•°ï¼Œæˆ–åŒ…å«é¢å¤–å­—ç¬¦ã€‚");
    }
    return result;
}
```

![](img/9fab00c46a74e6ad5591779d88bfd206_103.png)

**æ›´ç®€æ´çš„å†™æ³•**ï¼šæµå¯¹è±¡æœ¬èº«åœ¨å¸ƒå°”ä¸Šä¸‹æ–‡ä¸­ä¼šè¢«è½¬æ¢ä¸º `true`ï¼ˆå¦‚æœ `!fail()`ï¼‰æˆ– `false`ï¼ˆå¦‚æœ `fail()`ï¼‰ã€‚å› æ­¤ï¼Œæ£€æŸ¥ `if (iss >> result)` å¯ä»¥åˆ¤æ–­è¯»å–æ˜¯å¦æˆåŠŸã€‚

```cpp
int stringToInteger(const std::string& str) {
    std::istringstream iss(str);
    int result;
    char remaining;
    // å¦‚æœè¯»å–æ•´æ•°æˆåŠŸï¼Œå¹¶ä¸”ä¸‹ä¸€ä¸ªå­—ç¬¦è¯»å–å¤±è´¥ï¼ˆè¯´æ˜åé¢åªæœ‰ç©ºç™½æˆ–å·²åˆ°æœ«å°¾ï¼‰
    if (!(iss >> result) || (iss >> remaining)) {
        throw std::domain_error("æ— æ•ˆçš„æ•´æ•°æ ¼å¼ã€‚");
    }
    return result;
}
```

![](img/9fab00c46a74e6ad5591779d88bfd206_105.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_107.png)

---

![](img/9fab00c46a74e6ad5591779d88bfd206_109.png)

## è¾“å…¥/è¾“å‡ºæµ (I/O Streams) ä¸ç¼“å†² ğŸ¢âš¡

![](img/9fab00c46a74e6ad5591779d88bfd206_111.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_113.png)

æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„ `std::cout` å’Œ `std::cin` å°±æ˜¯æ ‡å‡†çš„è¾“å‡º/è¾“å…¥æµã€‚å®ƒä»¬è¿æ¥åˆ°æ§åˆ¶å°ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_115.png)

### ç¼“å†² (Buffering)

![](img/9fab00c46a74e6ad5591779d88bfd206_117.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_119.png)

ä¸ºäº†æé«˜æ•ˆç‡ï¼Œåƒ `cout` è¿™æ ·çš„è¾“å‡ºæµé€šå¸¸æ˜¯**ç¼“å†²çš„**ã€‚è¿™æ„å‘³ç€ä½ å†™å…¥çš„æ•°æ®ä¸ä¼šç«‹å³æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè€Œæ˜¯å…ˆå­˜å‚¨åœ¨ä¸€ä¸ªå†…å­˜ç¼“å†²åŒºä¸­ã€‚ç¼“å†²åŒºä¼šåœ¨ä»¥ä¸‹æƒ…å†µè¢«â€œåˆ·æ–°â€åˆ°å®é™…è®¾å¤‡ï¼š
*   ç¼“å†²åŒºå·²æ»¡ã€‚
*   é‡åˆ°æ¢è¡Œç¬¦ `\n`ï¼ˆä½† `\n` æœ¬èº«ä¸ä¸€å®šè§¦å‘åˆ·æ–°ï¼‰ã€‚
*   æ˜¾å¼ä½¿ç”¨ `std::endl`ï¼ˆå®ƒè¾“å‡ºæ¢è¡Œç¬¦**å¹¶**åˆ·æ–°ç¼“å†²åŒºï¼‰ã€‚
*   æ˜¾å¼ä½¿ç”¨ `std::flush` æ“æ§ç¬¦ã€‚
*   åœ¨è¯»å– `std::cin` ä¹‹å‰ï¼Œ`cout` çš„ç¼“å†²åŒºä¼šè¢«è‡ªåŠ¨åˆ·æ–°ï¼Œä»¥ç¡®ä¿ç”¨æˆ·èƒ½çœ‹åˆ°æç¤ºä¿¡æ¯ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_121.png)

**ç¤ºä¾‹ï¼š`endl` vs `\n`**
```cpp
// æ–¹æ³•ä¸€ï¼šä½¿ç”¨ endlï¼Œæ¯æ¬¡éƒ½ä¼šåˆ·æ–°ç¼“å†²åŒºï¼Œå¯èƒ½è¾ƒæ…¢
for (int i = 0; i < 1000; ++i) {
    std::cout << i << std::endl;
}

// æ–¹æ³•äºŒï¼šä½¿ç”¨ \nï¼Œæœ€åä¸€æ¬¡æ€§åˆ·æ–°ï¼Œé€šå¸¸æ›´å¿«
for (int i = 0; i < 1000; ++i) {
    std::cout << i << '\n';
}
// å¾ªç¯ç»“æŸåï¼Œç¼“å†²åŒºå¯èƒ½åœ¨ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨åˆ·æ–°
```
åœ¨éœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯ï¼Œåº”é¿å…é¢‘ç¹ä½¿ç”¨ `std::endl`ã€‚ä½†åœ¨è°ƒè¯•æˆ–éœ€è¦ç¡®ä¿è¾“å‡ºç«‹å³å¯è§æ—¶ï¼Œ`std::endl` å¾ˆæœ‰ç”¨ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_123.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_125.png)

### æµæ“ä½œç¬¦ (Manipulators) ğŸ›ï¸

æµæ“ä½œç¬¦æ˜¯åƒ `std::endl`ã€`std::flush` è¿™æ ·çš„ç‰¹æ®Šå¯¹è±¡ï¼Œå½“ç”¨ `<<` æˆ– `>>` å°†å®ƒä»¬æ”¾å…¥æµæ—¶ï¼Œä¼šæ”¹å˜æµçš„æ ¼å¼æˆ–çŠ¶æ€ï¼Œè€Œä¸æ˜¯è¾“å‡ºå­—ç¬¦æœ¬èº«ã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_127.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_129.png)

å¸¸è§çš„æ“ä½œç¬¦åŒ…æ‹¬ï¼š
*   `std::endl`ï¼šæ¢è¡Œå¹¶åˆ·æ–°ã€‚
*   `std::flush`ï¼šä»…åˆ·æ–°ç¼“å†²åŒºã€‚
*   `std::setw(n)`ï¼šè®¾ç½®ä¸‹ä¸€ä¸ªè¾“å‡ºå­—æ®µçš„å®½åº¦ã€‚
*   `std::setprecision(n)`ï¼šè®¾ç½®æµ®ç‚¹æ•°è¾“å‡ºç²¾åº¦ã€‚

å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
```cpp
#include <iomanip> // å¯¹äº setw, setprecision
std::cout << std::setw(10) << std::left << "Hello" << std::setprecision(2) << 3.14159 << std::endl;
```

![](img/9fab00c46a74e6ad5591779d88bfd206_131.png)

---

![](img/9fab00c46a74e6ad5591779d88bfd206_133.png)

## æ€»ç»“ ğŸ“

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†C++ä¸­æµçš„æ ¸å¿ƒæ¦‚å¿µï¼š

1.  **æµçš„è§’è‰²**ï¼šä½œä¸ºç¨‹åºä¸å¤–éƒ¨è®¾å¤‡äº¤äº’çš„ç»Ÿä¸€ã€æŠ½è±¡çš„æ¥å£ã€‚
2.  **å­—ç¬¦ä¸²æµ**ï¼š`std::istringstream` ç”¨äºä»å­—ç¬¦ä¸²è§£ææ•°æ®ï¼Œ`std::ostringstream` ç”¨äºå°†æ•°æ®æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚å®ƒä»¬æ˜¯å†…å­˜ä¸­å¼ºå¤§çš„ç±»å‹è½¬æ¢å·¥å…·ã€‚
3.  **çŠ¶æ€ä½**ï¼š`goodbit`ã€`failbit`ã€`eofbit`ã€`badbit` ç”¨äºè¯Šæ–­æµæ“ä½œçš„æˆåŠŸä¸å¦ï¼Œæ˜¯ç¼–å†™å¥å£®ä»£ç çš„å…³é”®ã€‚
4.  **I/Oæµä¸ç¼“å†²**ï¼š`cout`/`cin` æ˜¯æ ‡å‡†I/Oæµï¼Œäº†è§£ç¼“å†²æœºåˆ¶å’Œ `std::endl` ä¸ `\n` çš„åŒºåˆ«å¯¹ç¨‹åºæ€§èƒ½å’Œè°ƒè¯•æœ‰é‡è¦æ„ä¹‰ã€‚
5.  **æµæ“ä½œç¬¦**ï¼šåƒ `std::endl` è¿™æ ·çš„ç‰¹æ®Šå¯¹è±¡ï¼Œå¯ä»¥æ§åˆ¶æµçš„æ ¼å¼å’Œè¡Œä¸ºã€‚

![](img/9fab00c46a74e6ad5591779d88bfd206_135.png)

![](img/9fab00c46a74e6ad5591779d88bfd206_136.png)

ç†è§£æµæ˜¯æŒæ¡C++è¾“å…¥è¾“å‡ºçš„åŸºç¡€ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢C++çš„å…¶ä»–ç‰¹æ€§ï¼Œå¹¶å®ç°æ›´å¤æ‚çš„åº“å‡½æ•°ã€‚