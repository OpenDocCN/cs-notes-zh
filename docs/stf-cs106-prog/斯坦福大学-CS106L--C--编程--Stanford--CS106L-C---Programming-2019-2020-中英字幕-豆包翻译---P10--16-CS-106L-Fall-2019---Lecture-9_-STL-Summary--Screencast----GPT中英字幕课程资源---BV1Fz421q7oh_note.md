# æ–¯å¦ç¦å¤§å­¦ã€ŠCS106Lï¼šC++ç¼–ç¨‹ã€‹è¯¾ç¨‹ç¬”è®° - ç¬¬9è®²ï¼šSTLæ€»ç»“ä¸ç»¼åˆç¤ºä¾‹ ğŸ¯

## æ¦‚è¿°

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰è¿›è¡Œæ€»ç»“ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç»¼åˆæ€§çš„ç¼–ç¨‹ç¤ºä¾‹â€”â€”åˆ†æã€Šè”é‚¦å…šäººæ–‡é›†ã€‹çš„ä½œè€…èº«ä»½â€”â€”æ¥å·©å›ºæ‰€å­¦çŸ¥è¯†ã€‚æˆ‘ä»¬å°†è¿ç”¨STLçš„å®¹å™¨ã€è¿­ä»£å™¨ã€ç®—æ³•å’Œå‡½æ•°å¯¹è±¡æ¥è§£å†³å®é™…é—®é¢˜ã€‚

---

## STL æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†STLçš„å„ä¸ªç»„ä»¶ï¼Œæœ¬èŠ‚æˆ‘ä»¬æ¥å›é¡¾å¹¶æ€»ç»“è¿™äº›æ ¸å¿ƒæ¦‚å¿µã€‚

### å®¹å™¨ (Containers)

å®¹å™¨ç”¨äºå­˜å‚¨å’Œç®¡ç†æ•°æ®é›†åˆã€‚STLæä¾›äº†å¤šç§å®¹å™¨ç±»å‹ï¼š
*   **åºåˆ—å®¹å™¨**ï¼š`vector`, `deque`, `list`
*   **å…³è”å®¹å™¨**ï¼š`set`, `map`
*   **æ— åºå…³è”å®¹å™¨**ï¼š`unordered_set`, `unordered_map`
*   **å®¹å™¨é€‚é…å™¨**ï¼š`stack`, `queue`

### è¿­ä»£å™¨ (Iterators)

è¿­ä»£å™¨æ˜¯è®¿é—®å®¹å™¨å…ƒç´ çš„é€šç”¨æ¥å£ï¼Œæ˜¯STLç®—æ³•çš„â€œåŠ¨åŠ›æºâ€ã€‚è¿­ä»£å™¨æœ‰ä¸åŒçš„èƒ½åŠ›çº§åˆ«ï¼š
*   **è¾“å…¥è¿­ä»£å™¨**ï¼šåªè¯»ï¼Œå•æ¬¡éå†
*   **è¾“å‡ºè¿­ä»£å™¨**ï¼šåªå†™ï¼Œå•æ¬¡éå†
*   **å‰å‘è¿­ä»£å™¨**ï¼šå¯è¯»å†™ï¼Œå¯å¤šæ¬¡éå†
*   **åŒå‘è¿­ä»£å™¨**ï¼šå¯å‰åç§»åŠ¨
*   **éšæœºè®¿é—®è¿­ä»£å™¨**ï¼šæ”¯æŒéšæœºè®¿é—®ï¼ˆå¦‚ `vector` çš„è¿­ä»£å™¨ï¼‰

ä»¥ä¸‹æ˜¯è¿­ä»£å™¨çš„åŸºæœ¬æ“ä½œï¼š
```cpp
auto it = vec.begin(); // è·å–èµ·å§‹è¿­ä»£å™¨
*it;                   // è§£å¼•ç”¨ï¼Œè®¿é—®å…ƒç´ 
++it;                  // é€’å¢è¿­ä»£å™¨
it != vec.end();       // åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ«å°¾
```

![](img/6306af2c346264f3b7dd92c1c330e0e4_1.png)

### ç®—æ³• (Algorithms)

![](img/6306af2c346264f3b7dd92c1c330e0e4_3.png)

STLç®—æ³•é€šè¿‡è¿­ä»£å™¨å¯¹å®¹å™¨è¿›è¡Œæ“ä½œï¼Œå®ç°äº†æ•°æ®ä¸æ“ä½œçš„åˆ†ç¦»ã€‚å¸¸ç”¨ç®—æ³•åŒ…æ‹¬ï¼š
*   `std::sort`ï¼šæ’åº
*   `std::accumulate`ï¼šç´¯ç§¯è®¡ç®—
*   `std::find`ï¼šæŸ¥æ‰¾å…ƒç´ 
*   `std::copy`ï¼šå¤åˆ¶å…ƒç´ 

### å‡½æ•°å¯¹è±¡ä¸Lambdaè¡¨è¾¾å¼

å‡½æ•°å¯¹è±¡ï¼ˆä»¿å‡½æ•°ï¼‰å’ŒLambdaè¡¨è¾¾å¼å…è®¸æˆ‘ä»¬å°†è¡Œä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™ç®—æ³•ï¼Œæä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚
```cpp
// ä½¿ç”¨Lambdaè¡¨è¾¾å¼ä½œä¸ºè°“è¯
std::find_if(vec.begin(), vec.end(), [](int x){ return x > 5; });
```

![](img/6306af2c346264f3b7dd92c1c330e0e4_5.png)

### STLçš„è®¾è®¡å“²å­¦ï¼šæŠ½è±¡ä¸æ•ˆç‡

![](img/6306af2c346264f3b7dd92c1c330e0e4_7.png)

![](img/6306af2c346264f3b7dd92c1c330e0e4_9.png)

STLçš„æ ¸å¿ƒæ€æƒ³æ˜¯**æŠ½è±¡**å’Œ**æ•ˆç‡**ã€‚
1.  **æŠ½è±¡**ï¼šé€šè¿‡æ¨¡æ¿ï¼ŒSTLå°†ç®—æ³•ä»ç‰¹å®šçš„æ•°æ®ç±»å‹å’Œå®¹å™¨ç»“æ„ä¸­æŠ½è±¡å‡ºæ¥ã€‚
2.  **æ•ˆç‡**ï¼šSTLçš„å®ç°ç»è¿‡äº†é«˜åº¦ä¼˜åŒ–ï¼Œåœ¨ä¿è¯é€šç”¨æ€§çš„åŒæ—¶è¿½æ±‚è¿è¡Œé€Ÿåº¦ã€‚

ä»åŸºæœ¬ç±»å‹åˆ°å®¹å™¨ï¼Œå†åˆ°é€šè¿‡è¿­ä»£å™¨æ“ä½œçš„ç®—æ³•ï¼ŒSTLæ„å»ºäº†ä¸€å±‚å±‚çš„æŠ½è±¡ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿç¼–å†™é€šç”¨ã€é«˜æ•ˆçš„ä»£ç ã€‚

![](img/6306af2c346264f3b7dd92c1c330e0e4_11.png)

![](img/6306af2c346264f3b7dd92c1c330e0e4_13.png)

---

![](img/6306af2c346264f3b7dd92c1c330e0e4_15.png)

## ç»¼åˆç¤ºä¾‹ï¼šã€Šè”é‚¦å…šäººæ–‡é›†ã€‹ä½œè€…åˆ†æ

ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¿ç”¨æ‰€å­¦çš„STLçŸ¥è¯†æ¥è§£å†³ä¸€ä¸ªå®é™…é—®é¢˜ï¼šé€šè¿‡åˆ†æå†™ä½œé£æ ¼ï¼Œæ¨æµ‹ã€Šè”é‚¦å…šäººæ–‡é›†ã€‹ä¸­åŒ¿åæ–‡ç« çš„ä½œè€…ã€‚

### é—®é¢˜èƒŒæ™¯

ã€Šè”é‚¦å…šäººæ–‡é›†ã€‹ç”±äºšå†å±±å¤§Â·æ±‰å¯†å°”é¡¿ã€è©¹å§†æ–¯Â·éº¦è¿ªé€Šå’Œçº¦ç¿°Â·æ°ä¼Šåˆè‘—ï¼Œä½†å…·ä½“æ–‡ç« çš„å½’å±å­˜åœ¨äº‰è®®ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œé€šè¿‡æ¯”è¾ƒ**åŠŸèƒ½è¯**ï¼ˆå¦‚ â€œIâ€, â€œtheâ€, â€œtheirâ€ï¼‰çš„é¢‘ç‡ï¼Œæ¥é‡åŒ–æœªçŸ¥æ–‡æœ¬ä¸å·²çŸ¥ä½œè€…æ–‡æœ¬çš„ç›¸ä¼¼åº¦ã€‚

![](img/6306af2c346264f3b7dd92c1c330e0e4_17.png)

![](img/6306af2c346264f3b7dd92c1c330e0e4_19.png)

### æ ¸å¿ƒæ€è·¯ï¼šå‘é‡ç©ºé—´æ¨¡å‹

æˆ‘ä»¬å°†æ¯ç¯‡æ–‡ç« è§†ä¸ºä¸€ä¸ªå¤šç»´å‘é‡ï¼Œæ¯ä¸ªç»´åº¦å¯¹åº”ä¸€ä¸ªåŠŸèƒ½è¯çš„å‡ºç°é¢‘ç‡ã€‚é€šè¿‡è®¡ç®—ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„**ä½™å¼¦ç›¸ä¼¼åº¦**ï¼Œæˆ‘ä»¬å¯ä»¥è¡¡é‡å…¶å†™ä½œé£æ ¼çš„ç›¸ä¼¼æ€§ã€‚

**ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼**ï¼š
\[
\text{similarity} = \cos(\theta) = \frac{\mathbf{A} \cdot \mathbf{B}}{\|\mathbf{A}\| \|\mathbf{B}\|} = \frac{\sum_{i=1}^{n} A_i B_i}{\sqrt{\sum_{i=1}^{n} A_i^2} \sqrt{\sum_{i=1}^{n} B_i^2}}
\]
å…¶ä¸­ï¼Œ\( \mathbf{A} \cdot \mathbf{B} \) æ˜¯ç‚¹ç§¯ï¼Œ\( \|\mathbf{A}\| \) æ˜¯å‘é‡Açš„æ¨¡é•¿ã€‚

### ç¨‹åºç»“æ„è®¾è®¡

æˆ‘ä»¬çš„ç¨‹åºå°†éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š
1.  **è¯»å–å¹¶é¢„å¤„ç†æ–‡æœ¬**ï¼šå°†æ–‡ä»¶å†…å®¹è¯»å…¥å­—ç¬¦ä¸²ï¼Œå¹¶ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™ã€‚
2.  **è®¡ç®—è¯é¢‘å‘é‡**ï¼šé’ˆå¯¹ç»™å®šçš„åŠŸèƒ½è¯åˆ—è¡¨ï¼Œç»Ÿè®¡å®ƒä»¬åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚
3.  **è®¡ç®—ç›¸ä¼¼åº¦**ï¼šä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼ï¼Œæ¯”è¾ƒæœªçŸ¥æ–‡æœ¬ä¸æ¯ä½å·²çŸ¥ä½œè€…æ–‡æœ¬çš„è¯é¢‘å‘é‡ã€‚
4.  **è¾“å‡ºç»“æœ**ï¼šæ˜¾ç¤ºæœªçŸ¥æ–‡æœ¬ä¸å„ä½ä½œè€…çš„ç›¸ä¼¼åº¦åˆ†æ•°ã€‚

![](img/6306af2c346264f3b7dd92c1c330e0e4_21.png)

### ä»£ç å®ç°è¯¦è§£

![](img/6306af2c346264f3b7dd92c1c330e0e4_23.png)

ä»¥ä¸‹æ˜¯å®ç°è¿‡ç¨‹ä¸­çš„å…³é”®ä»£ç ç‰‡æ®µå’Œæ€è·¯ã€‚

#### 1. é¢„å¤„ç†æ–‡æœ¬ï¼šè½¬æ¢ä¸ºå°å†™å­—ç¬¦ä¸²

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥è¯»å–æ–‡ä»¶æµï¼Œå¹¶è¿”å›ä¸€ä¸ªæ‰€æœ‰å•è¯å‡ä¸ºå°å†™ã€ç”±ç©ºæ ¼åˆ†éš”çš„å•ä¸€å­—ç¬¦ä¸²ã€‚
```cpp
std::string processText(std::ifstream& file) {
    std::string result;
    std::string line;
    while (std::getline(file, line)) {
        // ä½¿ç”¨ std::transform å°†æ•´è¡Œè½¬æ¢ä¸ºå°å†™
        std::transform(line.begin(), line.end(), line.begin(),
                       [](unsigned char c) { return std::tolower(c); });
        result += line + " "; // ç”¨ç©ºæ ¼æ›¿æ¢æ¢è¡Œç¬¦
    }
    return result;
}
```
**è¯´æ˜**ï¼š
*   ä½¿ç”¨ `std::getline` é€è¡Œè¯»å–ã€‚
*   ä½¿ç”¨ `std::transform` ç®—æ³•ç»“åˆ `std::tolower` å’Œ Lambda è¡¨è¾¾å¼ï¼Œå°†æ¯ä¸€è¡Œè½¬æ¢ä¸ºå°å†™ã€‚è¿™é¿å…äº†æ‰‹å†™å¾ªç¯ï¼Œæ˜¯STLé£æ ¼çš„ä»£ç ã€‚
*   å°†å¤„ç†åçš„è¡ŒåŠ ç©ºæ ¼æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ã€‚

#### 2. è®¡ç®—è¯é¢‘å‘é‡

è¿™æ˜¯ç¨‹åºçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦ç»Ÿè®¡åŠŸèƒ½è¯åˆ—è¡¨ä¸­æ¯ä¸ªè¯åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚
```cpp
std::vector<int> createFrequencyVector(const std::string& text) {
    std::vector<int> frequencies;
    for (const std::string& word : FEATURE_WORDS) { // FEATURE_WORDS æ˜¯åŠŸèƒ½è¯åˆ—è¡¨
        int count = 0;
        // å…³é”®æ­¥éª¤ï¼šè®¡ç®—å•è¯ `word` åœ¨ `text` ä¸­å‡ºç°çš„æ¬¡æ•°
        // ... (è®¡æ•°é€»è¾‘å°†åœ¨ä¸‹èŠ‚è¯¾å®Œæˆ)
        frequencies.push_back(count);
    }
    return frequencies;
}
```
**æŒ‘æˆ˜ä¸æ€è€ƒ**ï¼š
åœ¨å®ç°è®¡æ•°é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ï¼š
*   **å­ä¸²åŒ¹é…é—®é¢˜**ï¼šä¾‹å¦‚ï¼Œç»Ÿè®¡ â€œtheâ€ æ—¶ï¼Œä¸èƒ½æŠŠ â€œthereâ€ ä¸­çš„ â€œtheâ€ ä¹Ÿç®—è¿›å»ã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œ**å…¨è¯åŒ¹é…**ã€‚
*   **æ ‡ç‚¹ç¬¦å·**ï¼šä¾‹å¦‚ï¼Œâ€œthe.â€ å¯èƒ½æ— æ³•åŒ¹é… â€œtheâ€ã€‚ä¸€ä¸ªæ›´å¥å£®çš„å®ç°éœ€è¦å¤„ç†æ ‡ç‚¹ç¬¦å·ï¼ˆå¯ä½œä¸ºè¯¾åç»ƒä¹ ï¼‰ã€‚
*   **æ€§èƒ½**ï¼šåœ¨é•¿æ–‡æœ¬ä¸­å¤šæ¬¡éå†å¯èƒ½è¾ƒæ…¢ã€‚æˆ‘ä»¬å¯ä»¥æ¢ç´¢æ›´é«˜æ•ˆçš„ç®—æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨ `std::istringstream` é…åˆ `std::unordered_map` ä¸€æ¬¡æ€§ç»Ÿè®¡æ‰€æœ‰è¯é¢‘ï¼Œå†æå–æ‰€éœ€åŠŸèƒ½è¯ã€‚

#### 3. è®¡ç®—ç›¸ä¼¼åº¦

ä¸€æ—¦æœ‰äº†ä¸¤ä¸ªè¯é¢‘å‘é‡ï¼Œè®¡ç®—ç›¸ä¼¼åº¦å°±å˜å¾—ç›´æ¥ã€‚
```cpp
double computeSimilarity(const std::string& text1, const std::string& text2) {
    std::vector<int> freq1 = createFrequencyVector(text1);
    std::vector<int> freq2 = createFrequencyVector(text2);

    double dotProduct = std::inner_product(freq1.begin(), freq1.end(), freq2.begin(), 0);
    double magnitude1 = std::sqrt(std::inner_product(freq1.begin(), freq1.end(), freq1.begin(), 0.0));
    double magnitude2 = std::sqrt(std::inner_product(freq2.begin(), freq2.end(), freq2.begin(), 0.0));

    if (magnitude1 == 0 || magnitude2 == 0) return 0.0; // é¿å…é™¤ä»¥é›¶
    return dotProduct / (magnitude1 * magnitude2);
}
```
**è¯´æ˜**ï¼š
*   `std::inner_product` ç®—æ³•å®Œç¾åœ°è®¡ç®—äº†ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯ã€‚
*   å‘é‡æ¨¡é•¿çš„è®¡ç®—ä¹Ÿé€šè¿‡ `std::inner_product` å®ç°ï¼ˆå‘é‡ä¸è‡ªèº«çš„ç‚¹ç§¯å³å„åˆ†é‡å¹³æ–¹å’Œï¼‰ã€‚
*   æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ç®€æ´ï¼Œå……åˆ†åˆ©ç”¨äº†STLç®—æ³•ã€‚

### ä¸»å‡½æ•°ä¸æµç¨‹

![](img/6306af2c346264f3b7dd92c1c330e0e4_25.png)

![](img/6306af2c346264f3b7dd92c1c330e0e4_27.png)

```cpp
int main() {
    // 1. è¯»å–å·²çŸ¥ä½œè€…å’ŒæœªçŸ¥ä½œè€…çš„æ–‡ä»¶
    std::ifstream madisonFile("madison.txt");
    std::ifstream jayFile("jay.txt");
    std::ifstream hamiltonFile("hamilton.txt");
    std::ifstream unknownFile("unknown.txt");

    // 2. é¢„å¤„ç†æ–‡æœ¬
    std::string madisonText = processText(madisonFile);
    std::string jayText = processText(jayFile);
    std::string hamiltonText = processText(hamiltonFile);
    std::string unknownText = processText(unknownFile);

    // 3. è®¡ç®—å¹¶è¾“å‡ºç›¸ä¼¼åº¦
    std::cout << "Similarity with Madison: "
              << computeSimilarity(madisonText, unknownText) << std::endl;
    std::cout << "Similarity with Jay: "
              << computeSimilarity(jayText, unknownText) << std::endl;
    std::cout << "Similarity with Hamilton: "
              << computeSimilarity(hamiltonText, unknownText) << std::endl;

    return 0;
}
```

---

## æ€»ç»“

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å›é¡¾äº†STLçš„æ ¸å¿ƒç»„ä»¶â€”â€”å®¹å™¨ã€è¿­ä»£å™¨ã€ç®—æ³•å’Œå‡½æ•°å¯¹è±¡ï¼Œå¹¶æ·±å…¥ç†è§£äº†å…¶**æŠ½è±¡**ä¸**æ•ˆç‡**çš„è®¾è®¡å“²å­¦ã€‚éšåï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç”ŸåŠ¨çš„ç»¼åˆç¤ºä¾‹ï¼Œå°†ç†è®ºçŸ¥è¯†åº”ç”¨äºå®è·µï¼Œä½¿ç”¨STLå·¥å…·æ„å»ºäº†ä¸€ä¸ªæ–‡æœ¬é£æ ¼åˆ†æç¨‹åºã€‚

é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ï¼š
1.  ä½¿ç”¨ `std::transform` ç­‰ç®—æ³•å¤„ç†æ•°æ®ã€‚
2.  è®¾è®¡å‡½æ•°æ¥è®¡ç®—è¯é¢‘å’Œå‘é‡ç›¸ä¼¼åº¦ã€‚
3.  å°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªä½¿ç”¨STLè§£å†³çš„å­é—®é¢˜ã€‚

![](img/6306af2c346264f3b7dd92c1c330e0e4_29.png)

è¿™å……åˆ†å±•ç¤ºäº†STLçš„å¼ºå¤§ä¹‹å¤„ï¼šå®ƒæä¾›äº†ä¸€å¥—ä¸°å¯Œã€é«˜æ•ˆä¸”é€šç”¨çš„å·¥å…·é›†ï¼Œèƒ½è®©æˆ‘ä»¬ä»¥ç®€æ´çš„ä»£ç è§£å†³å¤æ‚çš„é—®é¢˜ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹å’Œä½œä¸šä¸­ï¼Œè¯·ç»§ç»­å®è·µå’Œæ¢ç´¢STLçš„æ›´å¤šåŠŸèƒ½ã€‚