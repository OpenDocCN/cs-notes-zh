# 定义变量和过程

## 介绍

想象一种语言，我们无法使用名称来引用计算对象。随着我们编写越来越复杂的程序，跟踪每一步计算的细节将变得越来越困难和不便。因此，我们通过使用`define`将*值*（计算对象）分配给*变量*（通过名称标识）来实现抽象。这是 Racket 最简单的抽象手段。

尽管你在前面的章节中看到了各种变量和过程定义，但我们还没有正式教过如何使用`define`。

首先，这里有几个使用`define`的示例表达式。在 Racket 解释器中尝试这些，看看它们的作用。

```
-> (define x 5)
-> (define (square x) (* x x))
-> (define y (square 3))
-> (define z (+ x y)) 
```

## 定义变量

**变量定义**的一般形式如下：

```
(define [name] [value]) 
```

`[name]`代表一个**变量**，其值被分配给。例如：

```
-> (define x 5)
-> x
5 
```

`x`是一个变量，`5`是它的值。

`[value]`可以替换为任何类型的值，甚至是表达式。变量定义的一个重要特性是**在分配给变量之前，定义的值完全被评估**。

```
-> (define x (+ 5 5))
-> x
10 
```

为什么`x`不是`(+ 5 5)`？因为当我们定义`x`时，我们必须首先将表达式`(+ 5 5)`评估为其最简形式`10`。然后我们将`10`分配给`x`。

**测试你的理解**

当我们调用`(define x (/ 1 0))`时会发生什么？

## 定义复合过程

**过程定义**是一种比变量定义更强大的抽象技术，我们可以给一个复合操作命名，因此可以将其作为一个单元引用。让我们从一个简单的例子开始，定义`square`过程：

```
(define (square x) (* x x)) 
```

我们可以这样理解：

```
(define (square x) (   *     x      x))
   To    square x,  multiply x with x. 
```

过程定义的一般形式如下：

```
(define ([name] [formal parameters]) [body]) 
```

注意，这与变量定义有一个显著的区别，即名称和参数由括号绑定。请记住，除了引号之外，**一组括号表示一个过程调用**。我们可以这样解释：当我们用`[name]`和`[formal parameters]`调用时，我们将执行`[body]`。

**测试你的理解**

复合过程可以有任意非负数量的形式参数，甚至可以是 0。我们如何正确定义一个名为`foo`的过程，它不接受任何参数，并返回`5`？

过程定义的一个重要特性是**在调用过程之前不会评估过程的主体**。这意味着当我们定义`square`时，我们还不知道我们需要将`x`乘以自身。只有当我们对某个数字，比如`3`，调用`square`时，我们才知道我们必须调用`(* 3 3)`。

**测试你的理解**

当我们调用`(define (x) (/ 1 0))`时会发生什么？

### 警告

创建复合过程时需要注意的一件事是命名。在命名我们的过程和形式参数时，我们需要非常小心。Racket 不会接受多个定义，这意味着任何已经定义的过程不能用作复合过程或形式参数的名称。这是一个不允许的复合过程定义的示例（在您的解释器中尝试以查看原因）：

```
(define (foo sent word)
    (word sent word)) 
```

在主体中的两个实例中，我们指的是哪个`word`，是参数还是内置过程？

### 嵌套过程

回到嵌套表达式的概念，我们还可以在其他过程定义中嵌套过程。就像你在作业 0-1 中所做的那样，我们可以使用过程`square`来定义过程`sum-of-squares`：

```
(define (sum-of-squares x y)
    (+ (square x) (square y))) 
```

大致翻译为：当我们在`x`和`y`上调用`sum-of-squares`时，我们将`x`的`square`加到`y`的`square`上。

## 总结

为了澄清，

```
(define foo 10) 
```

+   这是一个变量定义。

+   `foo`是变量名。

+   `10`是分配给`foo`的值。

```
(define (square x) (* x x)) 
```

+   这是一个复合过程定义。

+   `square`是过程名称。

+   `x`是它唯一的形式参数。

+   `(* x x)`是它的主体。

```
-> (square 3)
9 
```

+   这是一个表达式，也是一个过程调用。

+   `square`是过程，是这个表达式的运算符。

+   `3`是`square`的参数，并且是这个表达式的操作数。

+   `9`是返回值。

## 要点

+   我们学会了可以使用`define`作为抽象的手段。

+   我们还学会了如何定义变量和复合过程。

关联值和操作到符号并稍后检索它们的可能性意味着 Racket 解释器必须具有某种形式的记忆来跟踪这些关联对。我们称这个记忆为*环境*，我们将在第 8 课中详细展开。
