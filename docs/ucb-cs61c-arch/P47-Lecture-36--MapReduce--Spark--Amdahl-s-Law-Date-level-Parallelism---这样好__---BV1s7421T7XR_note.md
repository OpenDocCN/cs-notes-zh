![](img/4d74245e78099c0169d1d6ad549d1205_0.png)

![](img/4d74245e78099c0169d1d6ad549d1205_2.png)

![](img/4d74245e78099c0169d1d6ad549d1205_4.png)

![](img/4d74245e78099c0169d1d6ad549d1205_6.png)

![](img/4d74245e78099c0169d1d6ad549d1205_8.png)

![](img/4d74245e78099c0169d1d6ad549d1205_10.png)

![](img/4d74245e78099c0169d1d6ad549d1205_12.png)

![](img/4d74245e78099c0169d1d6ad549d1205_14.png)

![](img/4d74245e78099c0169d1d6ad549d1205_16.png)

![](img/4d74245e78099c0169d1d6ad549d1205_18.png)

![](img/4d74245e78099c0169d1d6ad549d1205_20.png)

# è¯¾ç¨‹ P47ï¼šç¬¬36è®² ğŸ“š MapReduceã€Sparkã€é˜¿å§†è¾¾å°”å®šå¾‹ä¸æ•°æ®çº§å¹¶è¡Œ

![](img/4d74245e78099c0169d1d6ad549d1205_22.png)

![](img/4d74245e78099c0169d1d6ad549d1205_24.png)

![](img/4d74245e78099c0169d1d6ad549d1205_26.png)

![](img/4d74245e78099c0169d1d6ad549d1205_28.png)

![](img/4d74245e78099c0169d1d6ad549d1205_30.png)

![](img/4d74245e78099c0169d1d6ad549d1205_32.png)

![](img/4d74245e78099c0169d1d6ad549d1205_34.png)

![](img/4d74245e78099c0169d1d6ad549d1205_36.png)

![](img/4d74245e78099c0169d1d6ad549d1205_38.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¹¶è¡Œè®¡ç®—ä¸­çš„å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šé˜¿å§†è¾¾å°”å®šå¾‹ã€è¯·æ±‚çº§å¹¶è¡Œã€æ•°æ®çº§å¹¶è¡Œï¼Œä»¥åŠå¤„ç†å¤§è§„æ¨¡æ•°æ®çš„å¼ºå¤§æŠ½è±¡â€”â€”MapReduceåŠå…¶ç°ä»£å®ç°Sparkã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_40.png)

![](img/4d74245e78099c0169d1d6ad549d1205_42.png)

![](img/4d74245e78099c0169d1d6ad549d1205_44.png)

![](img/4d74245e78099c0169d1d6ad549d1205_46.png)

![](img/4d74245e78099c0169d1d6ad549d1205_48.png)

![](img/4d74245e78099c0169d1d6ad549d1205_50.png)

![](img/4d74245e78099c0169d1d6ad549d1205_52.png)

![](img/4d74245e78099c0169d1d6ad549d1205_54.png)

![](img/4d74245e78099c0169d1d6ad549d1205_56.png)

![](img/4d74245e78099c0169d1d6ad549d1205_58.png)

![](img/4d74245e78099c0169d1d6ad549d1205_60.png)

## é˜¿å§†è¾¾å°”å®šå¾‹ ğŸ’”

![](img/4d74245e78099c0169d1d6ad549d1205_62.png)

![](img/4d74245e78099c0169d1d6ad549d1205_64.png)

![](img/4d74245e78099c0169d1d6ad549d1205_66.png)

![](img/4d74245e78099c0169d1d6ad549d1205_68.png)

![](img/4d74245e78099c0169d1d6ad549d1205_70.png)

![](img/4d74245e78099c0169d1d6ad549d1205_72.png)

![](img/4d74245e78099c0169d1d6ad549d1205_74.png)

![](img/4d74245e78099c0169d1d6ad549d1205_76.png)

![](img/4d74245e78099c0169d1d6ad549d1205_78.png)

![](img/4d74245e78099c0169d1d6ad549d1205_80.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬æåˆ°äº†å¹¶è¡Œè®¡ç®—ï¼Œä½†åœ¨æ·±å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸ªé™åˆ¶å¹¶è¡ŒåŠ é€Ÿçš„åŸºæœ¬å®šå¾‹â€”â€”é˜¿å§†è¾¾å°”å®šå¾‹ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_82.png)

![](img/4d74245e78099c0169d1d6ad549d1205_84.png)

![](img/4d74245e78099c0169d1d6ad549d1205_86.png)

![](img/4d74245e78099c0169d1d6ad549d1205_88.png)

![](img/4d74245e78099c0169d1d6ad549d1205_90.png)

![](img/4d74245e78099c0169d1d6ad549d1205_92.png)

![](img/4d74245e78099c0169d1d6ad549d1205_94.png)

![](img/4d74245e78099c0169d1d6ad549d1205_96.png)

![](img/4d74245e78099c0169d1d6ad549d1205_98.png)

é˜¿å§†è¾¾å°”å®šå¾‹æè¿°äº†å¯¹ç³»ç»ŸæŸéƒ¨åˆ†è¿›è¡Œå¢å¼ºåï¼Œæ•´ä½“æ€§èƒ½æå‡çš„ç†è®ºä¸Šé™ã€‚æ¨¡å‹å¦‚ä¸‹ï¼šå‡è®¾ä¸€ä¸ªä»»åŠ¡ä¸­ï¼Œæœ‰ä¸€éƒ¨åˆ†ä»£ç æ— æ³•è¢«å¹¶è¡ŒåŒ–ï¼ˆä¸²è¡Œéƒ¨åˆ†ï¼‰ï¼Œå…¶å æ€»æ‰§è¡Œæ—¶é—´çš„æ¯”ä¾‹ä¸º **S**ï¼ˆ0 < S < 1ï¼‰ã€‚å‰©ä½™éƒ¨åˆ†ï¼ˆæ¯”ä¾‹ä¸º **1 - S**ï¼‰æ˜¯å¯ä»¥è¢«å¹¶è¡ŒåŠ é€Ÿçš„ã€‚å¦‚æœæˆ‘ä»¬å¯¹å¯å¹¶è¡Œéƒ¨åˆ†æ–½åŠ ä¸€ä¸ªåŠ é€Ÿå› å­ **P**ï¼ˆP > 1ï¼‰ï¼Œé‚£ä¹ˆæ•´ä½“çš„åŠ é€Ÿæ¯” **Speedup** å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š

![](img/4d74245e78099c0169d1d6ad549d1205_100.png)

**Speedup = 1 / (S + (1 - S) / P)**

å½“å¹¶è¡ŒåŠ é€Ÿå› å­ **P** è¶‹è¿‘äºæ— ç©·å¤§ï¼ˆå³æ‹¥æœ‰æ— é™å¤šçš„å¤„ç†å™¨ï¼‰æ—¶ï¼Œæœ€å¤§åŠ é€Ÿæ¯”è¶‹è¿‘äº **1 / S**ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿å¯å¹¶è¡Œéƒ¨åˆ†è¢«æ— é™åŠ é€Ÿï¼Œæ•´ä½“é€Ÿåº¦ä¹Ÿå—é™äºä¸²è¡Œéƒ¨åˆ†çš„æ¯”ä¾‹ã€‚

ä»¥ä¸‹æ˜¯å‡ ä¸ªå…³é”®ç‚¹ï¼š
*   ä¸²è¡Œéƒ¨åˆ† **S** æ˜¯æ€§èƒ½æå‡çš„ç“¶é¢ˆã€‚
*   å³ä½¿æŠ•å…¥å¤§é‡èµ„æºåŠ é€Ÿå¯å¹¶è¡Œéƒ¨åˆ†ï¼Œæ•´ä½“æ”¶ç›Šä¹Ÿä¼šè¢«ä¸²è¡Œéƒ¨åˆ†è¿…é€Ÿç¨€é‡Šã€‚
*   ä¸ºäº†æœ€å¤§åŒ–å¹¶è¡Œæ”¶ç›Šï¼Œå¿…é¡»å°½é‡å‡å°‘ä»£ç ä¸­çš„ä¸²è¡Œå¼€é”€ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_102.png)

![](img/4d74245e78099c0169d1d6ad549d1205_104.png)

![](img/4d74245e78099c0169d1d6ad549d1205_106.png)

![](img/4d74245e78099c0169d1d6ad549d1205_108.png)

![](img/4d74245e78099c0169d1d6ad549d1205_110.png)

![](img/4d74245e78099c0169d1d6ad549d1205_112.png)

![](img/4d74245e78099c0169d1d6ad549d1205_114.png)

![](img/4d74245e78099c0169d1d6ad549d1205_116.png)

![](img/4d74245e78099c0169d1d6ad549d1205_118.png)

ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç¨‹åº80%çš„æ‰§è¡Œæ—¶é—´å¯ä»¥åŠ é€Ÿ16å€ï¼ˆå³ S=0.2, P=16ï¼‰ï¼Œä»£å…¥å…¬å¼ï¼š
Speedup = 1 / (0.2 + 0.8/16) = 1 / (0.2 + 0.05) = 1 / 0.25 = 4
æœ€ç»ˆæ•´ä½“åªè·å¾—äº†4å€çš„åŠ é€Ÿï¼Œè€Œé16å€ã€‚è¿™å°±æ˜¯é˜¿å§†è¾¾å°”å®šå¾‹â€œä»¤äººå¿ƒç¢â€ä¹‹å¤„ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_120.png)

![](img/4d74245e78099c0169d1d6ad549d1205_122.png)

![](img/4d74245e78099c0169d1d6ad549d1205_124.png)

![](img/4d74245e78099c0169d1d6ad549d1205_126.png)

![](img/4d74245e78099c0169d1d6ad549d1205_128.png)

![](img/4d74245e78099c0169d1d6ad549d1205_130.png)

![](img/4d74245e78099c0169d1d6ad549d1205_132.png)

![](img/4d74245e78099c0169d1d6ad549d1205_134.png)

![](img/4d74245e78099c0169d1d6ad549d1205_136.png)

![](img/4d74245e78099c0169d1d6ad549d1205_138.png)

![](img/4d74245e78099c0169d1d6ad549d1205_140.png)

## è¯·æ±‚çº§å¹¶è¡Œä¸æ•°æ®çº§å¹¶è¡Œ âš™ï¸

![](img/4d74245e78099c0169d1d6ad549d1205_142.png)

![](img/4d74245e78099c0169d1d6ad549d1205_144.png)

![](img/4d74245e78099c0169d1d6ad549d1205_146.png)

![](img/4d74245e78099c0169d1d6ad549d1205_148.png)

![](img/4d74245e78099c0169d1d6ad549d1205_150.png)

ç†è§£äº†æ€§èƒ½ä¸Šé™åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ç§å¸¸è§çš„å¹¶è¡ŒèŒƒå¼ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_152.png)

![](img/4d74245e78099c0169d1d6ad549d1205_154.png)

![](img/4d74245e78099c0169d1d6ad549d1205_156.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†é˜¿å§†è¾¾å°”å®šå¾‹ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ç§ä¸åŒå±‚é¢çš„å¹¶è¡Œï¼šè¯·æ±‚çº§å¹¶è¡Œå’Œæ•°æ®çº§å¹¶è¡Œã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_158.png)

![](img/4d74245e78099c0169d1d6ad549d1205_160.png)

![](img/4d74245e78099c0169d1d6ad549d1205_162.png)

![](img/4d74245e78099c0169d1d6ad549d1205_164.png)

![](img/4d74245e78099c0169d1d6ad549d1205_166.png)

![](img/4d74245e78099c0169d1d6ad549d1205_168.png)

![](img/4d74245e78099c0169d1d6ad549d1205_170.png)

![](img/4d74245e78099c0169d1d6ad549d1205_172.png)

**è¯·æ±‚çº§å¹¶è¡Œ** å¸¸è§äºWebæœåŠ¡å™¨ç­‰åœºæ™¯ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼š
*   å¤§é‡ç‹¬ç«‹çš„è¯·æ±‚åŒæ—¶åˆ°è¾¾æœåŠ¡å™¨ã€‚
*   æ¯ä¸ªè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç‹¬ç«‹çš„ã€‚
*   è¯·æ±‚ä¹‹é—´é€šå¸¸åªæ¶‰åŠè¯»å–æ“ä½œï¼Œå¾ˆå°‘æ¶‰åŠå¤æ‚çš„è·¨è¯·æ±‚æ•°æ®å†™å…¥æˆ–åŒæ­¥ã€‚
*   æ˜“äºåœ¨ä¸åŒè¯·æ±‚é—´è¿›è¡Œåˆ†åŒºå¤„ç†ã€‚

ä¾‹å¦‚ï¼Œè°·æ­Œçš„æœç´¢æŸ¥è¯¢æœåŠ¡ä½“ç³»ç»“æ„å°±åˆ©ç”¨äº†è¯·æ±‚çº§å¹¶è¡Œã€‚ç”¨æˆ·æŸ¥è¯¢è¢«åˆ†å‘åˆ°å¤šä¸ªç´¢å¼•æœåŠ¡å™¨å¹¶è¡Œå¤„ç†ï¼Œç»“æœå†è¢«èšåˆè¿”å›ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_174.png)

![](img/4d74245e78099c0169d1d6ad549d1205_176.png)

**æ•°æ®çº§å¹¶è¡Œ** åˆ™å…³æ³¨äºå¯¹å•ä¸€æ•°æ®é›†è¿›è¡Œæ“ä½œã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
*   æ‹¥æœ‰ä¸€ä¸ªå¤§å‹æ•°æ®é›†ï¼ˆå¯èƒ½æ— æ³•è£…å…¥å•æœºå†…å­˜ï¼‰ã€‚
*   å°†æ•°æ®åˆ†å¸ƒåˆ°å¤šä¸ªå¤„ç†å™¨æˆ–ç£ç›˜ä¸Šã€‚
*   æ¯ä¸ªå¤„ç†å™¨åŒæ—¶å¯¹åˆ†é…ç»™è‡ªå·±çš„æ•°æ®éƒ¨åˆ†æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚
*   è¿™è¶…è¶Šäº†å•æŒ‡ä»¤å¤šæ•°æ®æµï¼ˆSIMDï¼‰ï¼Œæ˜¯ä¸€ç§æ›´é«˜çº§çš„æŠ½è±¡ã€‚

## MapReduce æŠ½è±¡ ğŸ—ºï¸â¡ï¸ğŸ§¹

ä¸ºäº†æœ‰æ•ˆå¤„ç†åˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šçš„æµ·é‡æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å¼ºå¤§çš„ç¼–ç¨‹æŠ½è±¡ã€‚MapReduceå°±æ˜¯ä¸ºæ­¤è€Œç”Ÿã€‚

MapReduceæ˜¯ä¸€ä¸ªç”¨äºå¤§è§„æ¨¡æ•°æ®å¤„ç†çš„ç¼–ç¨‹æ¨¡å‹ï¼Œè®¾è®¡ç›®æ ‡æ˜¯å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§ã€‚å®ƒå°†è®¡ç®—è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼šMapï¼ˆæ˜ å°„ï¼‰å’ŒReduceï¼ˆå½’çº¦ï¼‰ã€‚

ä»¥ä¸‹æ˜¯MapReduceçš„å·¥ä½œæµç¨‹ï¼š
1.  **Mapé˜¶æ®µ**ï¼šè¯»å–è¾“å…¥æ•°æ®ï¼ˆé€šå¸¸æ˜¯é”®å€¼å¯¹å½¢å¼ï¼‰ï¼Œå¯¹å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç”¨æˆ·å®šä¹‰çš„Mapå‡½æ•°ï¼Œç”Ÿæˆä¸€æ‰¹ä¸­é—´é”®å€¼å¯¹ã€‚
2.  **Shuffleï¼ˆæ´—ç‰Œï¼‰é˜¶æ®µ**ï¼šç³»ç»Ÿæ ¹æ®ä¸­é—´é”®å¯¹æ‰€æœ‰é”®å€¼å¯¹è¿›è¡Œæ’åºå’Œåˆ†ç»„ï¼Œç¡®ä¿ç›¸åŒé”®çš„æ•°æ®è¢«å‘é€åˆ°åŒä¸€ä¸ªReduceèŠ‚ç‚¹ã€‚
3.  **Reduceé˜¶æ®µ**ï¼šå¯¹æ¯ä¸ªé”®å¯¹åº”çš„æ‰€æœ‰å€¼é›†åˆï¼Œåº”ç”¨ç”¨æˆ·å®šä¹‰çš„Reduceå‡½æ•°ï¼Œè¿›è¡Œåˆå¹¶æ“ä½œï¼Œæœ€ç»ˆç”Ÿæˆè¾“å‡ºç»“æœã€‚

ä¸€ä¸ªç»å…¸ä¾‹å­æ˜¯**è¯é¢‘ç»Ÿè®¡**ï¼š
*   **Mapå‡½æ•°**ï¼šè¯»å–æ–‡æœ¬ï¼Œæ¯é‡åˆ°ä¸€ä¸ªå•è¯ï¼Œå°±è¾“å‡ºä¸€ä¸ªä¸­é—´é”®å€¼å¯¹ `<å•è¯, 1>`ã€‚
*   **Shuffle**ï¼šå°†æ‰€æœ‰ä¸­é—´å¯¹æŒ‰å•è¯åˆ†ç»„ã€‚
*   **Reduceå‡½æ•°**ï¼šæ¥æ”¶ä¸€ä¸ªå•è¯åŠå…¶å¯¹åº”çš„æ‰€æœ‰`1`çš„åˆ—è¡¨ï¼Œå°†å®ƒä»¬ç›¸åŠ ï¼Œè¾“å‡ºæœ€ç»ˆç»“æœ `<å•è¯, å‡ºç°æ¬¡æ•°>`ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_178.png)

![](img/4d74245e78099c0169d1d6ad549d1205_180.png)

MapReduceæ¡†æ¶ï¼ˆå¦‚Hadoopï¼‰ä¼šè‡ªåŠ¨å¤„ç†æ•°æ®åˆ†å¸ƒã€ä»»åŠ¡è°ƒåº¦ã€èŠ‚ç‚¹é—´é€šä¿¡ä»¥åŠèŠ‚ç‚¹æ•…éšœæ¢å¤ï¼ˆé€šè¿‡é‡æ–°æ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡ï¼‰ï¼Œä½¿å¼€å‘è€…èƒ½ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_182.png)

![](img/4d74245e78099c0169d1d6ad549d1205_184.png)

![](img/4d74245e78099c0169d1d6ad549d1205_186.png)

![](img/4d74245e78099c0169d1d6ad549d1205_188.png)

![](img/4d74245e78099c0169d1d6ad549d1205_190.png)

## Sparkï¼šæ›´å¿«çš„MapReduceå®ç° âš¡

![](img/4d74245e78099c0169d1d6ad549d1205_192.png)

![](img/4d74245e78099c0169d1d6ad549d1205_194.png)

![](img/4d74245e78099c0169d1d6ad549d1205_196.png)

![](img/4d74245e78099c0169d1d6ad549d1205_198.png)

![](img/4d74245e78099c0169d1d6ad549d1205_200.png)

![](img/4d74245e78099c0169d1d6ad549d1205_202.png)

![](img/4d74245e78099c0169d1d6ad549d1205_204.png)

![](img/4d74245e78099c0169d1d6ad549d1205_206.png)

![](img/4d74245e78099c0169d1d6ad549d1205_208.png)

![](img/4d74245e78099c0169d1d6ad549d1205_210.png)

è™½ç„¶MapReduceåŠŸèƒ½å¼ºå¤§ï¼Œä½†å…¶åŸºäºç£ç›˜çš„è¯»å†™æ¨¡å¼å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚Sparkæ˜¯MapReduceæ¨¡å‹çš„ä¸€ä¸ªæ›´ç°ä»£ã€æ›´é«˜æ•ˆçš„å®ç°ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_212.png)

![](img/4d74245e78099c0169d1d6ad549d1205_214.png)

![](img/4d74245e78099c0169d1d6ad549d1205_216.png)

![](img/4d74245e78099c0169d1d6ad549d1205_218.png)

![](img/4d74245e78099c0169d1d6ad549d1205_220.png)

![](img/4d74245e78099c0169d1d6ad549d1205_222.png)

![](img/4d74245e78099c0169d1d6ad549d1205_224.png)

![](img/4d74245e78099c0169d1d6ad549d1205_226.png)

![](img/4d74245e78099c0169d1d6ad549d1205_228.png)

![](img/4d74245e78099c0169d1d6ad549d1205_230.png)

![](img/4d74245e78099c0169d1d6ad549d1205_232.png)

Sparkçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š
*   **å†…å­˜è®¡ç®—**ï¼šå°½å¯èƒ½å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­è¿›è¡Œå¤„ç†ï¼Œæ¯”åŸºäºç£ç›˜çš„MapReduceå¿«æ•°ååˆ°ä¸Šç™¾å€ã€‚
*   **æƒ°æ€§æ±‚å€¼**ï¼šè½¬æ¢æ“ä½œï¼ˆå¦‚mapã€filterï¼‰ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œåªæœ‰åœ¨é‡åˆ°è¡ŒåŠ¨æ“ä½œï¼ˆå¦‚collectã€countï¼‰æ—¶æ‰ä¼šè§¦å‘å®é™…è®¡ç®—ï¼Œè¿™å…è®¸Sparkè¿›è¡Œæ•´ä½“ä¼˜åŒ–ã€‚
*   **æ˜“ç”¨çš„API**ï¼šæä¾›Pythonã€Scalaã€Javaç­‰å¤šç§è¯­è¨€çš„é«˜çº§APIï¼Œä»£ç æ›´ç®€æ´ã€‚

![](img/4d74245e78099c0169d1d6ad549d1205_234.png)

![](img/4d74245e78099c0169d1d6ad549d1205_236.png)

![](img/4d74245e78099c0169d1d6ad549d1205_238.png)

![](img/4d74245e78099c0169d1d6ad549d1205_240.png)

![](img/4d74245e78099c0169d1d6ad549d1205_242.png)

![](img/4d74245e78099c0169d1d6ad549d1205_244.png)

![](img/4d74245e78099c0169d1d6ad549d1205_246.png)

![](img/4d74245e78099c0169d1d6ad549d1205_248.png)

![](img/4d74245e78099c0169d1d6ad549d1205_250.png)

![](img/4d74245e78099c0169d1d6ad549d1205_252.png)

ä»¥ä¸‹æ˜¯ä½¿ç”¨Sparkå®ç°è¯é¢‘ç»Ÿè®¡çš„Pythonä»£ç ç¤ºä¾‹ï¼Œå…¶ç®€æ´æ€§å¯¹æ¯”ä¼ ç»ŸMapReduceæœ‰æ˜¾è‘—æå‡ï¼š

![](img/4d74245e78099c0169d1d6ad549d1205_254.png)

![](img/4d74245e78099c0169d1d6ad549d1205_256.png)

![](img/4d74245e78099c0169d1d6ad549d1205_258.png)

![](img/4d74245e78099c0169d1d6ad549d1205_260.png)

```python
# å‡è®¾scæ˜¯SparkContextï¼Œtext_fileæ˜¯ä¸€ä¸ªRDDï¼ˆå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼‰
words = text_file.flatMap(lambda line: line.split(" ")) # åˆ†å‰²å•è¯
pairs = words.map(lambda word: (word, 1)) # æ˜ å°„ä¸º(å•è¯, 1)
word_counts = pairs.reduceByKey(lambda a, b: a + b) # æŒ‰é”®å½’çº¦ï¼Œç›¸åŠ 
result = word_counts.collect() # è§¦å‘è®¡ç®—å¹¶æ”¶é›†ç»“æœ
```

![](img/4d74245e78099c0169d1d6ad549d1205_262.png)

![](img/4d74245e78099c0169d1d6ad549d1205_264.png)

![](img/4d74245e78099c0169d1d6ad549d1205_266.png)

![](img/4d74245e78099c0169d1d6ad549d1205_268.png)

![](img/4d74245e78099c0169d1d6ad549d1205_270.png)

![](img/4d74245e78099c0169d1d6ad549d1205_272.png)

![](img/4d74245e78099c0169d1d6ad549d1205_274.png)

ç”šè‡³å¯ä»¥ä½¿ç”¨é“¾å¼è°ƒç”¨å†™æˆæ›´ç´§å‡‘çš„ä¸€è¡Œä»£ç ï¼š
`text_file.flatMap(lambda line: line.split(" ")).map(lambda word: (word, 1)).reduceByKey(lambda a, b: a + b).collect()`

![](img/4d74245e78099c0169d1d6ad549d1205_276.png)

![](img/4d74245e78099c0169d1d6ad549d1205_278.png)

![](img/4d74245e78099c0169d1d6ad549d1205_280.png)

![](img/4d74245e78099c0169d1d6ad549d1205_282.png)

![](img/4d74245e78099c0169d1d6ad549d1205_284.png)

![](img/4d74245e78099c0169d1d6ad549d1205_286.png)

![](img/4d74245e78099c0169d1d6ad549d1205_288.png)

![](img/4d74245e78099c0169d1d6ad549d1205_290.png)

![](img/4d74245e78099c0169d1d6ad549d1205_292.png)

![](img/4d74245e78099c0169d1d6ad549d1205_294.png)

![](img/4d74245e78099c0169d1d6ad549d1205_296.png)

## æ€»ç»“ ğŸ¯

![](img/4d74245e78099c0169d1d6ad549d1205_298.png)

![](img/4d74245e78099c0169d1d6ad549d1205_300.png)

![](img/4d74245e78099c0169d1d6ad549d1205_302.png)

![](img/4d74245e78099c0169d1d6ad549d1205_304.png)

![](img/4d74245e78099c0169d1d6ad549d1205_306.png)

![](img/4d74245e78099c0169d1d6ad549d1205_308.png)

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†å¹¶è¡Œè®¡ç®—ä¸­çš„å‡ ä¸ªå…³é”®æ¦‚å¿µã€‚
æˆ‘ä»¬é¦–å…ˆè®¤è¯†äº†**é˜¿å§†è¾¾å°”å®šå¾‹**ï¼Œå®ƒæ­ç¤ºäº†ä¸²è¡Œä»£ç å¯¹å¹¶è¡ŒåŠ é€Ÿçš„æ ¹æœ¬é™åˆ¶ã€‚
æ¥ç€ï¼Œæˆ‘ä»¬åŒºåˆ†äº†**è¯·æ±‚çº§å¹¶è¡Œ**å’Œ**æ•°æ®çº§å¹¶è¡Œ**ä¸¤ç§ä¸åŒçš„å¹¶è¡ŒèŒƒå¼ã€‚
ç„¶åï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†ç”¨äºå¤„ç†æµ·é‡æ•°æ®çš„**MapReduce**ç¼–ç¨‹æ¨¡å‹ï¼Œäº†è§£äº†å…¶Mapã€Shuffleã€Reduceä¸‰ä¸ªé˜¶æ®µå¦‚ä½•åä½œã€‚
æœ€åï¼Œæˆ‘ä»¬ä»‹ç»äº†**Spark**ï¼Œä½œä¸ºMapReduceçš„ç°ä»£æ¼”è¿›ï¼Œå®ƒé€šè¿‡å†…å­˜è®¡ç®—å’Œæƒ°æ€§æ±‚å€¼ç­‰æœºåˆ¶ï¼Œæä¾›äº†æ›´é«˜æ•ˆã€æ›´æ˜“ç”¨çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚
æŒæ¡è¿™äº›æ¦‚å¿µå’Œå·¥å…·ï¼Œæ˜¯ç†è§£å’Œå¼€å‘å¤§è§„æ¨¡åˆ†å¸ƒå¼åº”ç”¨çš„åŸºç¡€ã€‚