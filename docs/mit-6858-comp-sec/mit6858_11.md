# 无线传感器网络（Marten van Dijk 的笔记）

**阅读：**A. Perrig, R. Szewczyk, J.D. Tygar, V. Wen, and D.E. Culler, "SPINS: Security Protocols for Sensor Networks", Wireless Networks 8, 521-534, 2002.

**模型（假设、安全需求、可能的威胁）：**

什么是传感器网络？成千上万的小传感器形成自组织的无线网络。传感器具有有限的处理能力、存储、带宽和能量（这降低了生产成本）。例如，使用 TinyOS，一个小型的事件驱动操作系统，见表 1。如果第三方可以读取或篡改传感器数据，会引发严重的安全和隐私问题。

例子：应急响应信息，能源管理，医疗监测，物流和库存管理，战场管理。

无线传感器网络（WSN）和移动自组织网络（MANET）之间有什么区别？WSN 中的传感器节点数量可以比 MANET 中的节点数量大几个数量级。传感器节点密集部署。传感器节点容易发生故障。WSN 的拓扑结构变化非常频繁。传感器节点主要使用广播通信范式，而大多数 MANET 基于点对点通信。传感器节点在处理能力、存储、带宽和能量方面受限。

传感器节点的组成部分是什么？带有传感器和模数转换器（ADC）的感知单元。带有存储器的处理器。收发器。电源单元。

基站的功能是什么？更多的电池电力，足够的内存，与外部网络通信的手段。

信任假设是什么？个体传感器不可信任。已知所有传感器中被损坏的比例存在上限。通信基础设施不可信任（除了消息以非零概率传递到目的地）。传感器节点信任它们的基站。每个节点信任自己。

什么是协议栈？物理层：简单但稳健的调制、传输和接收技术；负责频率选择、载波频率生成、信号检测、调制。数据链路层：介质访问控制（MAC）协议必须具有节能功能，并能够最小化与邻居广播的冲突，无线多跳自组织网络中的 MAC 协议创建网络基础设施（由于节点移动性和故障导致拓扑结构变化，周期性传输信标允许节点创建路由拓扑），并在传感器节点之间有效共享通信资源（已提出固定分配和随机访问版本），数据链路层还实现错误控制和数据加密 + 安全。网络层：路由传输层提供的数据，与外部网络进行互联，设计原则是功耗效率，数据聚合仅在不妨碍传感器节点协作努力时才有用，基于属性的寻址和位置感知。传输层：在应用需要时帮助维持数据流，特别是当系统计划通过互联网或其他外部网络访问时。应用层：大部分尚未探索。

什么是性能指标？容错性或可靠性：是指在没有传感器节点故障（非敌对性，如缺乏电力、物理损坏、环境干扰）的情况下维持传感器网络功能的能力，它被建模为泊松分布 e^{-lambda*t}，以捕捉在时间间隔（0，t）内没有故障的概率。可扩展性：支持更大网络的能力，对网络规模增加后仍具有灵活性，能够利用更密集的网络（密度表示每个节点传输半径内的节点数量；它等于 N*pi*R²/A，其中 N 是区域 A 中散布的传感器节点数量，R 是无线传输范围）。效率：存储复杂性（存储证书、凭证、密钥所需的内存量），处理复杂性（安全原语和协议所需的处理器周期数量），通信复杂性（为了提供安全而交换的消息数量和大小的开销）。网络连通性：两个相邻传感器能够共享密钥的概率（为了提供预期功能，需要足够的密钥连通性）。网络弹性：抵抗节点被捕获的能力；对于每个 c 和 s，c 受损传感器能够破坏 s 链接的概率是多少（通过重建相应的共享秘钥）？

安全性要求是什么？可用性：确保整个 WSN 提供的服务，任何部分或单个节点在需要时必须可用。安全服务的退化：随着资源可用性的变化，能够改变安全级别。生存能力：在断电、故障或攻击的情况下提供最低级别的服务（需要阻止拒绝服务攻击）。

身份验证：在授予有限资源或透露信息之前，对其他节点、簇首和基站进行身份验证。完整性：确保消息或实体不被篡改（数据完整性通过数据认证实现）。新鲜度：确保每条消息都是新鲜的、最新的（检测重放攻击）。

机密性：提供无线通信通道的隐私（通过监听或隐蔽通道防止信息泄露），需要语义安全，确保窃听者对明文没有任何信息，即使它看到相同明文的多次加密（例如，将明文与随机比特串连接，但这需要发送更多数据并消耗更多能量）。不可否认性：防止恶意节点隐藏其活动（例如，它们无法否认其签署的陈述的有效性）。

**解决方案（SNEP、微型 TESLA、密钥分发）：**

设计安全性的限制是什么？安全性需要限制处理能力的消耗。有限的电源供应限制了密钥的寿命。工作内存无法保存用于 RSA 等非对称加密算法的变量。创建和验证签名的开销很高。需要限制通信。

SNEP：A 和 B 共享一个主密钥，用于派生加密密钥 K_AB 和 K_BA，以及 MAC 密钥 K'_AB 和 K'_BA。A 和 B 同步计数器值 C_A=C_B。从 A 到 B 的通信：{Data}_[K_AB,C_A] = Data XOR E_{K_AB}(C_A) 以及 MAC_{K'_AB}({Data}_[K_AB,C_A]||C_A)，参见公式（1）。MAC 计算如图 3 所示，使用 CBC 模式。这提供了语义安全、数据认证、弱新鲜度（如果消息验证正确，接收者知道消息必须在其（接收者）正确接收的上一条消息之后发送），低通信开销（计数器值不会被发送）。

强新鲜度：参见公式（2），如果 B 从 A 请求消息，那么 B 向 A 传输一个随机数，并且 A 将此随机数包含在其发送给 B 的通信的 MAC 中。如果 MAC 验证正确，B 知道 A 在 B 发送请求后生成了响应。

同步计数器值：请参阅第 5.2 节中的简单引导协议，随时可以使用具有强新鲜度的上述协议来请求当前计数器值。为防止拒绝服务攻击，在上述协议中允许每个加密消息传输计数器，或者附加另一个不依赖于计数器的短 MAC 到消息中。

微型 TESLA：经过身份验证的广播需要使用非对称机制，否则任何被篡改的接收器都可以伪造来自发送者的消息。如何在没有非对称加密的情况下完成这项工作？通过延迟揭示对称密钥引入不对称性。思路：基站使用一个对传感器节点未知的密钥 K 的 MAC_K（K 是密钥链的一个密钥，K_i = F(K_{i+1})，其中 F 是单向函数）来承诺给基站（在密钥链中，密钥是自认证的），密钥链通过基站的延迟揭示来揭示。密钥揭示时间延迟大约为几个时间间隔，大于任何合理的往返时间。接收器节点知道密钥揭示时间。每个接收器节点需要拥有密钥链的一个真实密钥作为对整个链的承诺。发送基站和接收器节点松散地进行时间同步。使用共享秘密 MAC 密钥的简单引导协议，请参阅第 5.5 节。

节点无法存储密钥链的密钥：节点可以通过基站广播数据，或者使用基站外包密钥链管理。

密钥设置：基站和节点共享的主密钥。我们如何进行密钥分发？已经有很多研究提供了具有良好弹性、连通性和可扩展性的解决方案。有争议的解决方案：密钥感染；引导不需要安全，而是关于在静态网络中进行安全维护。思路：明文传输对称密钥，并使用保密放大（以及其他机制）。在保密放大中，两个节点 A 和 B 使用第三个相邻节点 C 来建立 A 和 B 之间的通信。这个通信通道由密钥 K_{A,C} 和 K_{C,B} 保护。它用于交换一个随机数 N。A 和 B 通过 H(K_{A,B}||N) 替换他们的密钥 K_{A,B}，并验证他们是否可以使用这个新密钥。如果 K_{A,B} 被对手知道，但密钥 K_{A,C} 和 K_{C,B} 不知道，那么对手无法提取新的 K_{A,B}！这个解决方案已被提议用于战场管理应用。

相关主题：RFID 标签，社交网络，TinyDB。
