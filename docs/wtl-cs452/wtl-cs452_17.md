# 第 17 讲 - 校准 I

### 公共服务公告

1.  毕业典礼

1.  考试：8 月 8 日上午 9 点

1.  与火车控制器通信时的流量控制。

1.  测量是一项不会因为聪明而加快的活动。

* * *

## 校准

### 哲学

在知道火车在哪里之前你什么也做不了。你可以通过

+   当火车到达地标时知道火车的位置，以及

+   通过始终知道火车的速度来在地标之间进行插值。

测量是昂贵的，你应该尽可能多地从每次测量中获取信息。

+   类比于人类信息处理，我建议每次收到传感器报告时都做出预测

    +   你期待下一个传感器会触发哪一个？

    +   你期待什么时候触发它？

+   当你触发下一个传感器时，你自动估计了两个传感器之间的行驶速度。

    +   这个估计是你在那段火车上的火车速度的最新估计，以及速度。

    +   利用它来改进校准表就是我们所说的*动态校准*。

+   在终端上显示你的预测和测量之间的差异，

    +   在时间上，

    +   在距离上，

    +   在速度上

    这让你对应用程序的工作方式有持续的感觉，这对于设置有效的公差非常重要。

### 1\. 校准停车距离

最简单的目标：

+   当你命令火车停下时知道火车停在哪里很重要

+   限制停止命令仅在火车经过传感器后立即执行

+   只有一个火车在移动

事件序列

1.  火车在 t 时触发传感器

    +   火车在 Sn + 0 厘米处

1.  应用在 t + dt1 时接收报告

1.  你在 t + dt1 + dt2 时下达命令

1.  火车在 t + dt1 + dt2 + dt3 时接收并执行命令

1.  火车在 t + dt1 + dt2 + dt3 + dt4 时减速并停止

    +   火车在 Sn + y 厘米处

    +   （你用卷尺测量 y。）

你需要回答的问题

+   如果你再次这样做，同样的传感器，同样的速度，你会得到相同的答案吗？

+   如果你再次这样做，不同的传感器，相同的速度，你会得到相同的答案吗？

+   如果你再次这样做，相同的传感器，不同的速度，你会得到相同的答案吗？

+   如果你再次这样做，不同的传感器，不同的速度，你会得到相同的答案吗？

+   以及上面列表中的所有其他重要内容。

#### 评论

1.  上述事件序列中有许多小延迟被累加在一起

    +   每个都有一个恒定部分和一个随机部分。尽量使用差异测量值来消除恒定部分。

    +   一些延迟可以被先验消除，因为它们与其他延迟相比非常小。你提前弄清楚这一点，你就需要做的测量就越少。

1.  在需要反向行驶的路线上运行火车时，知道你停下的位置非常重要

    +   为什么反向路线很重要？

1.  显然，知道何时停下同样重要。

这非常耗时！

+   减少测量次数的唯一方法是消除不重要的因素。

+   确定一个因素始终不重要的唯一方法是进行测量。快速估计能力的发展，以及快速找到最坏情况是在这类任务中变得聪明的主要方法。

现在制作一张表

|  | 传感器 1 | 传感器 2 | ... |
| --- | --- | --- | --- |
| 速度 6 |  |  |  |
| 速度 8 |  |  |  |
| ... |  |  |  |

表格的每个单元格中都有足够的测量值，你可以估计随机误差。（与其他组核对以确保你的误差不会太大。）

根据我在以往学期看到的校准，你会发现速度设置和火车有很大的变化，传感器的变化很小。

跨越具有`相同`值的单元格进行分组。也许所有值都相同。

提示。与其他组互动有助于确认你的进展。当然，仅仅使用另一组的校准而不说明是`学术不端行为`。

* * *

### 2\. 校准恒定速度

此时轨道上有几个地方，你可以停下，精度为一节车长或更好。然而，假设你想在开关处改变方向。

+   你希望靠近开关，远离开关，并且在停下时站在开关的正确一侧。

+   你想知道火车何时停下，因为在那之前你不能下达开始移动的命令。

#### 知道当前速度

你正在做的一个隐含假设是未来将与过去非常相似。

1.  你测量两个相邻传感器报告之间的时间间隔。

1.  知道传感器之间的距离，你计算火车的速度

    +   速度 = 距离 / 时间间隔

    +   以 cm / sec 为单位测量。

    请注意，上面提到的滞后平均值 -- 等待传感器读取，火车控制器中的时间，在时间戳之前你系统中的时间 -- 是不重要的。

    +   传感器 1 实际上在 t1 时触发。

    +   你记录(S1, t1 + dt)作为第一个事件。

    +   传感器 2 实际上在 t2 时触发

    +   你记录(S2, t2 + dt)作为第二个事件

    +   你计算速度为(S2 - S1) / (t2 + dt - (t1 + dt)) = (S2 - S1) / (t2 - t1)，这是正确的答案。

    +   但是从一次测量到另一次测量的 dt 变化会给测量带来噪音。

1.  经过多次测量，你建立了一张表

    +   使用表格来确定当前速度

    +   利用自上次传感器报告以来的时间来计算传感器之外的距离

    +   距离 = 速度 * 时间间隔

#### 有效利用资源

最稀缺的资源

+   与火车控制器的带宽

+   使用火车本身

最丰富的资源

+   CPU

任何时候你可以使用丰富的资源来消除对稀缺资源的使用，你就赢了。例如

#### 你必须解决的实际问题

1.  表格太大了。

    +   你需要大量的测量

1.  你测量的值会随机变化。

    +   你需要平均值和估计误差。

你测量的值会有系统性变化

+   例如，每次测量速度估计都会变慢，可能是因为火车正在向需要加油的方向移动。

+   你需要做更少的测量或更有效地利用你所做的测量。

#### 火车停下来需要多长时间？

尝试以下练习。

1.  选择一个传感器。

1.  将火车放在一个会经过传感器的轨道上。

1.  将火车跑到一个恒定的速度。

1.  在一个可以让火车停下并与传感器接触的位置下达速度为零的命令。

1.  计算你下达命令和传感器触发之间的时间。

1.  寻找规律。

#### 火车达到速度需要多长时间？

* * *

返回到：

+   比尔·考恩 2012 年春季 CS452 课程讲义

+   比尔·考恩 2012 年春季 CS452 页面

+   比尔·考恩的 CS452 页面

+   比尔·考恩的教学页面

+   比尔·考恩的个人主页
