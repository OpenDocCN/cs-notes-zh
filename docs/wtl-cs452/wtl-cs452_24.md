# 第 24 讲 - 预约 I

### 公共服务公告

1.  稍微改进的 p1.pdf。

1.  如何进行演示

    +   6 月 29 日，星期五，在课堂上。

1.  何时给你演示

    +   星期二，7 月 3 日。

    +   我会在实验室里安排一个报名时间表，在周二上午的不同时间段安排十五分钟的时间。选择对你来说最方便的时间。

1.  路线查找

    +   第一个演示

    +   之后

1.  如何描述轨道位置

    +   地标加 XX 厘米

1.  测量程序

    +   地标的位置需要对其本地原点有明确的约定。

* * *

## 多列车控制

到周末结束时，你应该能够驾驶一辆列车在轨道上，确切地知道它在哪里。

+   “精确地”意味着在你知道的容差范围内。

在接下来的一个里程碑之前，你将能够同时控制两列火车。对于每列火车

1.  列车发现自己

1.  你给它一个目的地：目的地是轨道上的一个位置

1.  列车开始朝目的地行驶

1.  它到达目的地而不与其他列车相撞

1.  两列火车同时移动

    +   否则会有一个微不足道的解决方案。

    +   将平凡的解决方案实施为一个开始可能是值得的

### 传感器归因

第一个困难的问题是当你收到传感器报告时。哪辆列车触发了传感器？

+   只要列车足够远离，这就不太难。

+   “足够”的实践意义是什么？

+   传感器归因必须在面对单一故障时正确地工作，

    +   的传感器，或

    +   轨道切换器。

### 避免碰撞

如果列车可以瞬间停下来，这将不会太难，但事实并非如此。

你必须提前计划，

+   至少需要两列车停下来的时间

通常是你的碰撞避免方法限制了可以同时运行的列车数量。

+   N 列车开始运行。

+   然后，过了一会儿它们会被冻结，无法移动。

+   每个人都在等待另一个人移动。

+   如果 N 很大，冻结通常发生在路线规划器无法为任何列车找到路线时。

我喜欢分布式解决方案，每辆列车都像没有其他列车在轨道上一样运行 - 计划、驾驶、做出决策等。我为什么喜欢这样？

+   代码很简单。

+   每个任务都有一个明确定义的角色。例如

    +   轨道监视器知道轨道的当前状态。

    +   路线规划器使用轨道监视器输入提供可行的路线。

    +   列车司机获得路线并跟随它前进，在前方的轨道切换器上进行切换。

+   任务间通信的协议自然而然地产生于角色之间。

+   解决方案通常可以很好地扩展，只要轨道长度至少与列车数量线性增长。

* * *

## 预约

在过去的一个世纪里，有人一直做得不错。答案就是预约。

### 两级列车控制

这两个级别完全独立于彼此。

+   在轨道的使用频繁的区段，下层完全由硬件完成，几乎没有人为干预的可能性

#### 上层

1.  列车请求调度员提供路线

1.  调度员提供了一个他/她认为没有冲突的路线

1.  列车按照路线行驶，经过地标（传感器）后向调度员报告。

    +   调度员得到两份报告

        1.  硬件的一个

        1.  工程师的一个

    +   由调度员负责确保它们不冲突。

    +   轨道上即将发生的事情通过轨道上的灯光传达给列车司机

#### 下层

下层是由你沿轨道看到的彩色灯光编码的。在上层和下层发生冲突的情况下，下层胜出。

+   一切都严格由硬件执行

+   人类只有在灯光告诉工程师他/她被允许做什么时，才进入循环。

    +   如果工程师穿过红灯，他/她将永远失去驾照。

+   如果系统检测到违反其规则或绝不应发生的状态，它将进入故障安全模式

    +   所有灯都变成红色。

##### 一些必须做的基本事情

在编码之前设计好你的预订系统。

在编码预订系统之前，先在纸上解决问题，并确保它适用于你能想到的所有一般情况

1.  一列列车跟着另一列列车

1.  两列列车相撞

1.  路径中有一个或多个开关

* * *

返回到：

+   比尔·考温 2012 年春季 CS452 讲座笔记

+   比尔·考温 2012 年春季 CS452 页面

+   比尔·考温的 CS452 页面

+   比尔·考温的教学页面

+   比尔·考温的主页
