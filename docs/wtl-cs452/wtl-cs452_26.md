# 第 26 讲 - 演示，预订

### 公共服务公告

1.  期末考试日期

1.  昨天演示的评论

    +   我们留下了积极的印象

        +   小组处于不同水平是正常的，因为 48 小时和 72 小时的错误出现是不可预测的

    +   请记住，这个里程碑有三个离散部分

        +   知道停车距离

        +   知道火车在以固定速度行驶时的位置

        +   知道火车在加速和减速时的位置

    +   有多种方法可以进行加速/减速

        +   我们看到的所有系统都能正常工作

        +   我们不了解足够多，无法评估不同方法的时间效率。

        +   有一个关于加速/减速的解决方法效果相当不错

    +   尝试使用一个动态参数来调整所有���他参数

        +   标准化单位在这里非常有帮助

    +   一个良好的用户界面向你展示了很多在出现有趣情况时有用的信息

        +   例如：在行驶的火车下面的转向开关

        +   火车是否超前于其校准？或者是切换命令给得太晚了？

    +   一些小组的演示看起来不尽人意，因为一切都完成了 80%

        +   两个部分的稳健运行是

            +   对于你的观众来说更加令人印象深刻和更容易判断

            +   对你更加鼓舞

            +   更快地完成

            而不是三个部分完成 80%

    +   一些我们看到的东西可能在轨道上有多列火车时会出问题

        1.  同时设置所有开关

        1.  重新找到火车作为标准操作程序

        1.  在火车停止时不跟踪火车位置

* * *

## 传感器归因

一旦知道火车在哪里，预测就能正常工作。如何在开始时找到它们？

+   当轨道上只有一列火车时很容易

    +   将其移动得非常缓慢，直到遇到传感器，现在你知道它在哪里

    +   获取第二个传感器以确认方向并不是一个坏主意。

+   当轨道上有多列火车时很困难

    +   你将下一个传感器撞击归因于哪列火车

    +   火车可能在被发现之前相撞

如何为多列火车做到这一点？

+   一次一个。

启动下一列火车

1.  在方便的地方停止之前的火车

1.  缓慢启动这列火车，你不知道它在哪里。

1.  当它撞击传感器时

    +   对它将要撞击的下一个传感器做出预测

    +   获得许可，可能是轨道预订，以超越下一个传感器

1.  推断当火车撞击预测传感器时，你知道火车在哪里。

* * *

## 典型的预订系统

预订系统不是防止火车相撞的唯一方法。

下面描述的预订系统不是唯一有效的预订系统。我创建它是为了说明在防止火车相撞时必须解决的问题。

在过去的学期，学生们成功地使用了

+   类似于下面描述的系统

+   系统没有将轨道分成块，而是提供任意大小的预订。

+   系统提供的预订是轨道覆盖的区域，而不是轨道长度的线。

通过在 CPU 上进行更多的计算来减少与列车控制器的通信，始终表现更好。

##### 严格条件

需要避免碰撞

1.  **每辆火车必须为其所占用的轨道预订。

1.  **每辆火车必须以足够低的速度行驶，以便在其预订结束之前停下来。

1.  **每辆火车应该预订足够处理单个传感器或（独占）单个开关错误。

1.  **任何轨道都不应该被多辆火车预订。

##### 软条件

保持火车运行所需

1.  每辆火车必须释放它不再占用并且在不久的将来也不会占用的区块。

    +   如果火车停下来，通常只会有一个区块的预订，但也可能有两个区块的预订。

1.  每个火车持有的预订应该是连续的

谁执行这些条件？

+   没有人明确这样做。

+   有几个约束条件

    1.  预订服务器总是提供连续的预订。

    1.  预订服务器永远不会分配已经预订的轨道。

    1.  预订服务器永远不会撤销预订。

    1.  火车始终以足够慢的速度行驶，以便如果拒绝延长请求，则可以在当前预订内停下来。

+   执法责任是分散的。

是否存在无法执行这些条件的情况？

+   这是什么？

这是理论上的工作原理

1.  火车从路径查找器获取路径，并沿着路径向前查看。

    +   火车有所需的速度。

1.  火车向预订系统请求沿途的几个区块轨道

    +   区块通常在开关和/或传感器处结束

    +   如果您在开关处结束区块，您必须足够了解火车的位置，以确保它完全清除了开关。

1.  如果可用，预订系统会授予这些区块

    +   预订包括火车必须行驶的条件，以便它可以完全停下而不离开任何预订的区块。

这是实际工作的一种方式

1.  火车收到一个预订，允许它以所需速度行驶一个或多个区块。

    +   预订包括这些区块末端足够的轨道，以便火车在到达其预订末端之前停下来。

1.  每次火车离开一个区块时，它会释放对该区块的预订。

1.  在到达可以以速度行驶的区块末端之前，请求延长其预订。

1.  如果请求被批准，它会继续以速度行驶。

    否则，它会开始减速，以至于在其预订结束之前停止。

#### 预订实施

您可以按以下方式授予预订：

每次火车收到传感器报告时，都会执行其预订程序

1.  释放我刚刚空出的预订

1.  如果我在下一个传感器处发出停止信号，我能否在我的预订内停下来？

1.  如果是的，完成

1.  如果没有，我需要超出当前预订多少？

1.  请求所需的内容，可能更多

    +   指示您希望预订的顺序（连续性）。

    +   这取决于您所行进的方向，这对于预订服务器来说并非必要。

    +   这可以由预订服务器推断，但为什么要麻烦呢。

1.  预订服务器尽可能多地提供

1.  使用完整的预订来重新检查停止条件。

1.  如果是，完成

1.  如果不是，则停止，或减速以使停止条件为是。

* * *

返回至：

+   比尔·考温在 s12 学期的 CS452 讲义

+   比尔·考温 2012 年春季 CS452 页面

+   比尔·考温的 CS452 页面

+   比尔·考温的教学页面

+   比尔·考温的主页
