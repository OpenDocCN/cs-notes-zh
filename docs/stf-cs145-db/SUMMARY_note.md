# 斯坦福 CS145 数据库导论笔记 📚

在本教程中，我们将系统性地学习斯坦福大学CS145《数据库导论》课程的核心知识点。课程内容涵盖数据库基础概念、关系模型、数据查询语言、XML/JSON数据处理、数据库设计理论以及高级主题如事务和触发器。本教程旨在为初学者提供一个清晰、结构化的学习路径。

## P1：01-01-课程介绍 🎯

本节是课程的入门介绍。我们将了解数据库系统在现代计算中的重要性，以及本课程将要覆盖的主要内容和学习目标。

## P2：02-01-关系模型 🏗️

上一节我们介绍了课程概览，本节中我们来看看数据库的基石——关系模型。关系模型使用表（称为“关系”）来组织和表示数据。

以下是关系模型的核心概念：
*   表由行（元组）和列（属性）构成。
*   每个表有一个唯一的名称。
*   列定义了数据的类型和含义。
*   行代表一条具体的记录。

## P3：02-02-关系数据库查询 🔍

理解了关系模型的结构后，本节我们将学习如何从这些表中检索数据。查询是数据库的核心操作，它允许我们根据特定条件筛选和组合信息。

## P4：03-01-规范的XML 📄

从关系模型转向另一种常见的数据格式，本节我们介绍XML。首先，我们需要理解什么是“格式规范的”XML文档。

以下是格式规范的XML必须遵守的规则：
*   必须有且仅有一个根元素。
*   所有元素必须正确嵌套。
*   所有标签必须正确关闭。
*   属性值必须用引号括起来。

## P5：03-03-XML模式（Schema）📐

仅仅格式规范还不够，为了确保XML文档的结构和内容符合预期，我们使用XML Schema来定义其规则。XML Schema是一种用于描述和约束XML文档结构的语言。

## P6：04-01-JSON简介 🔤

除了XML，JSON是另一种广泛使用的轻量级数据交换格式。本节我们将学习JSON的基本语法和结构，它常被用于Web应用程序中。

JSON使用键值对来组织数据，其基本结构可以用JavaScript对象表示，例如：
```json
{
  "name": "Alice",
  "age": 30,
  "courses": ["Database", "Algorithms"]
}
```

## P7：05-01-关系代数1 ➕➖✖️

回到数据库查询的核心，关系代数提供了一套理论化的操作符来操作关系。这些操作是SQL等查询语言的基础。本节我们学习基本操作。

核心的关系代数操作包括：
*   **选择（σ）**：根据条件筛选行。公式：`σ_predicate(R)`
*   **投影（π）**：选择特定的列。公式：`π_attributes(R)`
*   **并集（∪）**：合并两个结构相同的关系中的所有元组。
*   **差集（−）**：找出存在于第一个关系但不在第二个关系中的元组。
*   **笛卡尔积（×）**：将两个关系的所有元组进行组合。

## P8：06-04-WHERE子句中的子查询 🎣

在SQL查询中，子查询是一个强大的工具。本节我们学习如何在`WHERE`子句中使用子查询来构建更复杂的过滤条件。

例如，查找选修了“CS145”课程的学生：
```sql
SELECT name
FROM Students
WHERE student_id IN (
    SELECT student_id
    FROM Enrollments
    WHERE course_id = 'CS145'
);
```

## P9：06-05-FROM/SELECT子句中的子查询 📊

子查询不仅可用于`WHERE`子句，还可以作为临时表出现在`FROM`子句中，或作为计算列出现在`SELECT`子句中。这极大地增强了查询的灵活性。

## P10：06-06-聚合函数 📈

经常我们需要对数据进行总结，而不是查看每一行细节。聚合函数（如求和、平均、计数）就是用于此目的。它们将多行数据汇总成一个单一的值。

常用的聚合函数包括：
*   `COUNT()`：计算行数。
*   `SUM()`：计算数值列的总和。
*   `AVG()`：计算数值列的平均值。
*   `MAX()` / `MIN()`：找出最大/最小值。

## P11：06-07-空值（NULL）处理 ⚫

数据库中的数据可能缺失或未知，这时就用`NULL`值表示。`NULL`在逻辑运算和聚合函数中有特殊的处理规则，理解它们对于编写正确的查询至关重要。

## P12：06-08-数据修改语句 ✏️

查询用于读取数据，而数据修改语句用于改变数据库的内容。本节我们学习如何使用`INSERT`、`UPDATE`和`DELETE`语句来添加、更新和删除数据。

## P13：07-01-关系数据库设计概述 🧩

如何设计出高效、无冗余的数据库表结构？本节概述关系数据库设计的过程和核心目标，即通过规范化来减少数据异常。

## P14：07-02-函数依赖 🔑

数据库规范化理论的基础是函数依赖。它描述了表中属性之间的一种约束关系。理解函数依赖是进行有效数据库设计的关键。

函数依赖 `A → B` 表示：如果两个元组在属性集A上的值相等，则它们在属性B上的值也必须相等。

## P15：08-01-XPath介绍 🗺️

对于XML数据，我们需要专门的查询语言。XPath是一种用于在XML文档中导航和选择节点的语言。本节介绍XPath的基本语法和路径表达式。

## P16：08-02-XPath演示 💻

理论需要结合实践。本节通过具体的示例演示如何使用XPath表达式来定位和提取XML文档中的不同部分。

## P17：08-03-XQuery介绍 🔎

XPath主要用于选择节点，而XQuery是一种功能更全面的XML查询语言，它可以对选出的数据进行转换、构造新的XML结构等复杂操作。

## P18：08-05-XSLT转换 🌀

XSLT是一种将XML文档转换为其他格式（如HTML、文本或另一个XML）的语言。它基于模板规则，是处理XML数据展示和转换的强大工具。

## P19：09-01-UML数据建模 📐

在具体建表之前，我们通常使用UML类图等工具进行概念建模。这有助于在更高的抽象层次上理清实体、属性及实体间的关系。

## P20：11-03-参照完整性 🔗

参照完整性是关系数据库的一个重要约束，它确保表之间的关系有效性。通常通过**外键**来实现，保证一个表中的值必须在另一个表的主键中存在。

## P21：11-05-触发器演示（第一部分）⚡

触发器是一种特殊的存储过程，它在特定数据库事件（如INSERT、UPDATE、DELETE）发生时自动执行。本节通过演示展示触发器的基本创建和使用。

## P22：11-06-触发器演示（第二部分）⚡

承接上一部分，本节继续演示更复杂的触发器场景，例如使用触发器来强制执行业务规则或维护复杂的审计日志。

## P23：12-02-事务特性 ⚖️

事务将一系列数据库操作作为一个不可分割的单元。事务具有ACID特性，这是保证数据一致性和可靠性的基础。

ACID特性是指：
*   **原子性**：事务中的所有操作要么全部完成，要么全部不完成。
*   **一致性**：事务必须使数据库从一个一致状态转变到另一个一致状态。
*   **隔离性**：并发执行的事务彼此隔离，互不干扰。
*   **持久性**：事务一旦提交，其结果就是永久性的。

## P24：13-03-使用触发器修改视图 👁️

视图是基于查询的虚拟表。通常对视图的更新会映射到基表。本节学习如何利用触发器来实现对复杂视图的定制化更新逻辑。

## P25：15-02-基本递归WITH语句演示 🔄

SQL的`WITH RECURSIVE`子句允许我们编写递归查询，这对于处理树形或图状数据（如组织结构、路径查找）非常有用。本节演示基本的递归查询。

## P26：15-03-非线性与相互递归 🔀

递归查询可以更复杂。本节探讨非线性递归（单个递归项引用自身多次）和相互递归（多个递归项相互引用）等高级模式。

## P27：16-02-OLAP演示 📊

OLAP（联机分析处理）用于支持复杂的分析和报表。本节演示如何使用SQL的`CUBE`、`ROLLUP`和`GROUPING SETS`等操作进行多维数据分析。

## P28：DBClass 办公时间 02_21_2013 💬

本节是课程助教的办公时间记录，解答学生在学习过程中遇到的具体问题和疑惑。

## P29：DBClass 办公时间 03_06_2013 💬

另一期办公时间记录，针对课程不同阶段的内容进行答疑和深入讨论。

## P30：期中考试题解 📝

本节提供了课程期中考试的解决方案，供学生复习和检验自己对前半部分课程知识的掌握程度。

---

**总结**

在本教程中，我们一起学习了斯坦福CS145数据库导论的核心内容。我们从数据库和关系模型的基本概念出发，深入探讨了SQL查询语言（包括基础查询、子查询、聚合）、关系代数理论、XML/JSON数据处理。随后，我们进入了数据库设计阶段，学习了函数依赖和规范化理论。最后，我们接触了保证数据完整性的触发器、确保可靠处理的事务以及用于复杂数据分析和处理的递归查询与OLAP操作。希望这份整理能帮助你构建起坚实的数据库知识体系。