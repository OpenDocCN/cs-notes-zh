# 网络：复习问题

+   [带交互式多选题的维基](http://angrave.github.io/SystemProgramming/networkingreviewquestions.html)

+   见[编码问题](#编码问题)

+   见[简答问题](#简答问题)

+   见[MP 可穿戴设备](https://courses.engr.illinois.edu/cs241/mps/mp7/)思考问题

## 简答问题

## Q1

什么是套接字？

## Q2

监听端口 1000 和端口 2000 有什么特别之处？

+   端口 2000 比端口 1000 慢两倍

+   端口 2000 比端口 1000 快两倍

+   端口 1000 需要 root 权限

+   无

## Q3

IPv4 和 IPv6 之间的一个重要区别是什么？

## Q4

何时以及为什么会使用 ntohs？

## Q5

如果主机地址是 32 位，我最有可能使用哪种 IP 方案？128 位呢？

## Q6

哪种常见的网络协议是基于数据包的，可能无法成功传递数据？

## Q7

哪种常见的协议是基于流的，如果数据包丢失将重新发送数据？

## Q8

什么是 SYN ACK ACK-SYN 握手？

## Q9

以下哪项不是 TCP 的特性之一？

+   数据包重排序

+   流量控制

+   数据包重传

+   简单的错误检测

+   加密

## Q10

什么协议使用序列号？它们的初始值是多少？为什么？

## Q11

构建 TCP 服务器需要的最小网络调用是什么？它们的正确顺序是什么？

## Q12

构建 TCP 客户端所需的最小网络调用是什么？它们的正确顺序是什么？

## Q13

何时在 TCP 客户端上调用 bind？

## Q14

套接字绑定监听接受的目的是什么？

## Q15

上述哪个调用可以阻塞，等待新客户端连接？

## Q16

DNS 是什么？它对你有什么作用？CS241 网络调用中的哪些会为你使用它？

## Q17

对于 getaddrinfo，如何指定服务器套接字？

## Q18

为什么 getaddrinfo 可能会生成网络数据包？

## Q19

哪个网络调用指定了允许的积压大小？

## Q20

哪个网络调用返回一个新的文件描述符？

## Q21

何时使用被动套接字？

## Q22

何时使用 epoll 比 select 更好？何时使用 select 比 epoll 更好？

## Q23

`write(fd, data, 5000)`总是发送 5000 字节的数据吗？它何时会失败？

## Q24

网络地址转换（NAT）是如何工作的？

## Q25

@MCQ 假设网络客户端和服务器之间的传输时间为 20ms，建立 TCP 连接需要多长时间？20ms 40ms 100ms 60ms @ANS 3 次握手 @EXP @END

## Q26

HTTP 1.0 和 HTTP 1.1 之间有哪些区别？如果网络传输时间为 20ms，从服务器传输 3 个文件到客户端需要多少毫秒？HTTP 1.0 和 HTTP 1.1 之间的传输时间有何不同？

## 编码问题

## Q 2.1

写入网络套接字可能不会发送所有字节，并且可能会因为信号中断。检查`write`的返回值来实现`write_all`，它将重复调用`write`以发送任何剩余的数据。如果`write`返回-1，那么除非`errno`是`EINTR`，否则立即返回-1 - 在这种情况下重复上次的`write`尝试。您将需要使用指针算术。

```cpp
// Returns -1 if write fails (unless EINTR in which case it recalls write
// Repeated calls write until all of the buffer is written.
ssize_t write_all(int fd, const char *buf, size_t nbyte) {
  ssize_t nb = write(fd, buf, nbyte);
  return nb;
}
```

## Q 2.2

实现一个多线程 TCP 服务器，监听端口 2000。每个线程应从客户端文件描述符中读取 128 字节，并将其回显给客户端，然后关闭连接并结束线程。

## Q 2.3

实现一个 UDP 服务器，监听端口 2000。保留一个大小为 200 字节的缓冲区。监听到一个到达的数据包。有效数据包为 200 字节或更少，并以四个字节 0x65 0x66 0x67 0x68 开头。忽略无效的数据包。对于有效的数据包，将第五个字节的值作为无符号值添加到一个运行总数中，并打印到目前为止的总数。如果运行总数大于 255，则退出。
