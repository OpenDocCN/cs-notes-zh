# 编程技巧，第一部分

## 将`cat`用作你的 IDE

谁需要编辑器？IDE？我们可以只用`cat`！你已经看到`cat`被用来读取文件的内容，但它也可以用来读取标准输入并将其发送回标准输出。

```cpp
$ cat
HELLO
HELLO 
```

要完成从输入流中读取，请按`CTRL-D`关闭输入流

让我们使用`cat`将标准输入发送到文件。我们将使用'>'将其输出重定向到文件：

```cpp
$ cat > myprog.c
#include <stdio.h>
int main() {printf("Hi!");return 0;} 
```

（小心！不允许删除和撤销……）完成后按`CTRL-D`。

## 用`perl`正则表达式编辑你的代码（又名“记住你的 perl pie”）

如果你有几个文本文件（例如源代码）要更改，一个有用的技巧是使用正则表达式。`perl`使得在原地编辑文件变得非常容易。只需记住'perl pie'并在网上搜索……

一个例子。假设我们想要在当前目录中的所有.c 文件中将序列“Hi”更改为“Bye”。然后我们可以编写一个简单的替换模式，它将在所有文件中的每一行上执行：

```cpp
$ perl -p -i -e 's/Hi/Bye/' *.c 
```

（如果你搞错了，不要惊慌，原始文件仍然存在；它们只是有扩展名.bak）显然，你可以用正则表达式做的事情远不止将 Hi 改为 Bye。

## 使用你的 shell`!!`

要重新运行上一个命令，只需输入`!!`并按`return`键。要重新运行以 g 开头的上一个命令，只需输入`!g`并按`return`键。

## 使用你的 shell`&&`

厌倦了运行`make`或`gcc`，然后运行程序（如果编译成功）？相反，使用&&将这些命令链接在一起

```cpp
$ gcc program.c && ./a.out 
```

## Make 可以做的不仅仅是 make

你也可以尝试在你的 Makefile 中放一行代码来编译，然后运行你的程序。

```cpp
run : $(program)
        ./$(program) 
```

然后运行

```cpp
$ make run 
```

将确保你所做的任何更改都被编译，并一次性运行你的程序。也适用于一次性测试多个输入。尽管你可能更愿意为此编写一个常规的 shell 脚本。

## 你的邻居太高产了吗？C 预处理器来拯救！

使用 C 预处理器重新定义常见关键字，例如

```cpp
#define if while
```

专业提示：将这行代码放在标准包含文件中，例如/usr/include/stdio.h

## 当你 C 有预处理器时，谁还需要函数

好吧，这更像是一个陷阱。在使用看起来像函数的宏时要小心……

```cpp
#define min(a,b) a<b?a:b
```

a 和 b 的最小合理定义。然而，预处理器只是一个简单的文本处理程序，所以优先级可能会让你吃亏：

```cpp
int value = -min(2,3); // Should be -2?
```

扩展为

```cpp
int value = -2<3 ? 2 :3; // Ooops.. result will be 2 
```

一个部分的修复是用`()`包裹每个参数，还有整个表达式用()包裹：

```cpp
#define min(a,b) (  (a) < (b) ?(a):(b) )
```

然而这仍然*不是*一个函数！例如，你能看出为什么`min(i++,10)`可能会使 i 增加一次还是两次吗！？
