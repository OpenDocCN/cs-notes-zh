- en: 哈佛CS50-AI ｜ Python人工智能入门(2020·完整版) - P10：L2- 不确定性 3 (采样，马尔可夫，HMM) - ShowMeAI
    - BV1AQ4y1y7wy
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 哈佛CS50-AI ｜ Python人工智能入门(2020·完整版) - P10：L2- 不确定性 3 (采样，马尔可夫，HMM) - ShowMeAI
    - BV1AQ4y1y7wy
- en: through a procedure known as sampling in，the process of sampling I'm going to。take
    a sample of all of the variables，inside of this Bayesian network here and。how
    am I going to sample well I'm going，to sample one of the values from each of。these
    nodes according to their，probability distribution so how might I。
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 通过一种称为抽样的过程，在抽样过程中，我将对这个贝叶斯网络中的所有变量进行抽样。我将从每个节点中按照它们的概率分布抽取一个值，所以我可能会怎样。
- en: take a sample of all these nodes we'll，all start at the root I'll start with。rain
    here's the distribution for rain，and I'll go ahead and using a random。number generator
    or something like it，randomly pick one of these three values。I'll pick none with
    probability 0。7，light with probability 0。2 and heavy，with probability 0。
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 对所有这些节点进行抽样，我们都从根开始，我将从雨开始，这里是雨的分布，我将使用随机数生成器或类似的东西，随机选择这三个值中的一个。我将以概率0.7选择无雨，以概率0.2选择小雨，以概率0.1选择大雨。
- en: 1 so I'll randomly，just pick one of them according to that，distribution and
    maybe in this case I。pick none for example then I do the same，thing for the other
    variable maintenance。also has a probability distribution and，I'm going to sample
    now there are three。probability distributions here but I'm，only going to sample
    from this first row。
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我将随机根据这个分布选择其中一个，或许在这种情况下我选择了无雨，然后我对另一个变量维护做同样的事情。维护也有一个概率分布，我将现在进行抽样，这里有三个概率分布，但我只会从第一行进行抽样。
- en: here because I've observed already in my，sample that the value of rain is nunim。so
    given that rain is none I'm going to，sample from this distribution to say all。right
    what should the value of，maintenance be and in this case，maintenance is going
    to be let's just。say yes which happens 40% of the time in，the event that there
    is no rain for。
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 这里因为我已经在我的样本中观察到，雨的值是无，所以鉴于没有雨，我将从这个分布中进行抽样，看看维护的值应该是多少，在这种情况下，维护的值就设为“是”，这是在没有雨的情况下发生的40%。
- en: example and we'll sample all the rest of，the nodes in this way as well that
    I。want a sample from the train，distribution and I'll sample from this。first row
    here where there is no rain，but there is track maintenance and I'll。sample 80%
    of the time I'll say the，train is on time 20% of the time I'll。
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 举个例子，我会以这种方式对其余节点进行抽样。我想从火车的分布中抽样，我将从这一行中抽样，这里没有雨，但有轨道维护，我会抽样80%的时间说火车准时，20%的时间我会。
- en: say the train is delayed and finally，we'll do the same thing for whether I。make
    it to my appointment or not did I，attend or miss the appointment。well sample based
    on this distribution，and maybe say that in this case I attend。the appointment
    which happens 90% of the，time when the train is actually on time。
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 假设火车延误，最后我们也会对我是否按时到达预约进行相同的操作，我是否出席或错过了预约。好吧，基于这个分布进行抽样，或许说在这种情况下我出席了预约，当火车准时到达时，这发生的概率是90%。
- en: so by going through these nodes I can，very quickly just do some sampling and。![](img/b54b0a477f393ba9d68b03e2ac479d49_1.png)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 通过遍历这些节点，我可以非常快速地进行一些抽样。![](img/b54b0a477f393ba9d68b03e2ac479d49_1.png)
- en: get a sample of the possible values that，could come up from going through this。entire
    Bayesian network according to，those probability distributions and。where this becomes
    powerful is if I do，this not once but I do this thousands or。tens of thousands
    of times and generate，a whole bunch of samples all using this。
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个完整的贝叶斯网络中获取可能值的样本，依据这些概率分布。而这变得强大的是，如果我不是一次而是成千上万次地进行，并生成大量样本，全部使用这个。
- en: distribution I get different samples，maybe some of them are the same but get。a
    value for each of the possible，variables that could come up and so then。if I'm
    ever faced with a question a，question like what is the probability。that the train
    is on time you could do，an exact inference procedure this is no。
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 分布我得到不同的样本，也许其中一些是相同的，但得到。每个可能出现的变量的值，然后，如果我面临一个问题，比如火车准时的概率是什么，你可以进行，精确的推断程序这没有。
- en: different than the inference problem we，had before where I could just。marginalize
    look at all the possible，other values as variables and do the。computation of inference
    by enumeration，to find out this probability exactly but。I could also if I don't
    care about the。
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们之前的推断问题不同，我可以仅仅通过边缘化，查看所有可能的其他值作为变量，并通过枚举进行推断计算，以准确找出这个**概率**，但如果我不关心这个。
- en: '![](img/b54b0a477f393ba9d68b03e2ac479d49_3.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b54b0a477f393ba9d68b03e2ac479d49_3.png)'
- en: exact probability just sample it，approximate it to get close and this is。a powerful
    tool in AI we don't need to，be right a hundred percent of the time。or we don't
    need to be exactly right if，we just need to be right with some。probability we
    can often do so more，effectively more efficiently and so here。
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 精确的**概率**只是对其进行采样，近似它以便接近，这在AI中是一个**强大的工具**，我们不需要每次都**完全正确**。或者我们不需要完全正确，如果我们只需要在某种概率下是对的，我们通常可以做到这样，更**有效**，更**高效**，所以在这里。
- en: now are all of those possible samples，I'll sort of highlight the ones that。where
    the train is on time I'm ignoring，the ones where the train is delayed and。you
    know in this case there's like six，out of eight of the samples have the。train
    is arriving on time and so maybe，in this case I can say that in six out。
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 现在所有这些可能的样本，我将突出显示那些火车准时的样本，忽略那些火车延误的样本，你知道在这种情况下，八个样本中大约有六个火车准时到达，因此也许在这种情况下我可以说，在六个中。
- en: of eight cases that's the likelihood，that the train is on time and with eight。![](img/b54b0a477f393ba9d68b03e2ac479d49_5.png)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 八个案例的**可能性**是火车准时到达。 ![](img/b54b0a477f393ba9d68b03e2ac479d49_5.png)
- en: samples that might not be a great，prediction but if I had thousands upon。thousands
    of samples then this could be，a much better inference procedure to be。able to
    do these sorts of calculations，so this is a direct sampling method to。just do
    a bunch of samples and then，figure out what the probability of some。
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 可能不是一个很好的**预测**的样本，但如果我有成千上万的样本，那么这可能会是一个**更好的推断程序**，能够进行这些计算，所以这是一种直接的采样方法，来做一堆样本，然后，找出某些的**概率**。
- en: event is now this from before was an，unconditional probability what。is the probability
    that the train is on，time and I did that by looking at all。the samples and figuring
    out all right，here the ones where the train is on time。but sometimes what I want
    to calculate，is not an unconditional probability but。
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 事件现在是之前的一个**无条件概率**，即火车准时的概率，我通过查看所有样本来做这个，并弄清楚，好的，这里是火车准时的样本。但有时我想计算的不是**无条件概率**而是。
- en: rather a conditional probability，something like what is the probability。that
    there is light rain given that the，train is on time something to that。effect and
    to do that kind of，calculation well what I might do is here。are all the samples
    that I have and I，want to calculate a probability。
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 而是一个**条件概率**，像是给定火车准时的情况下，有小雨的概率，做那种计算，我可能会这样做，这里是我所有的样本，我想计算一个**概率**。
- en: distribution given that I know that the，train is on time so to be able to do。that
    I can kind of look at the two cases，where the train was delayed and ignore。or
    reject them sort of exclude them from，the possible samples that I'm。considering
    and now I want to look at，these remaining cases where the train is。
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在我知道火车准时的情况下的**分布**，所以为了能够做到这一点，我可以查看火车延误的两种情况，并忽略或拒绝它们，从我正在考虑的可能样本中排除它们，现在我想查看这些**剩余案例**，火车。
- en: on time here the cases where there's，light rain and I say okay these are two。out
    of the six possible cases that can，give me an approximation for the。probability
    of light rain given the fact，that I know the train was on time and I。did that
    in almost exactly the same way，just by adding an additional step by。
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里是**准时**的案例，其中有小雨，我说好的，这两个是六个可能案例中的两个，可以给我一个关于**小雨**的概率的近似，考虑到我知道火车准时到达，我几乎是以同样的方式做的，只是通过增加一个额外的步骤。
- en: saying but all right when I take each，sample let me reject all of the samples。that
    don't match my evidence and only，consider the samples that do match what。it is
    that I have in my evidence that I，want to make some sort of calculation。about
    and it turns out using the，libraries that we've had for bayesian。
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 说好了，当我取每个样本时，让我拒绝所有不符合我证据的样本，仅考虑那些与我证据相符的样本，我想对其进行某种计算，而结果是使用我们为贝叶斯准备的**库**。
- en: networks we can begin to implement this，same sort of idea like implement。rejection
    sampling which is what this，method is called to be able to figure。out some probability
    not by a direct，inference but instead by sampling so。what I have here is a program
    called，sample PI imports the exact same model。
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以开始实现这种相同的想法，比如实现拒绝采样，这就是这种方法的名称，以便能够通过抽样来计算某些概率，而不是直接推断。因此，我在这里有一个名为sample.py的程序，导入了完全相同的模型。
- en: and what I define first is a program to，generate a sample and the way I generate。a
    sample is just by looping over all of，the states the states need to be in some。sort
    of order to make sure I'm looping，in the correct order but effectively if。it is
    a conditional distribution I'm，going to sample based on the parents and。
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我首先定义的是一个生成样本的程序，我生成样本的方式是循环所有状态。这些状态需要按照某种顺序排列，以确保我以正确的顺序循环。但实际上，如果这是一个条件分布，我将基于父节点进行采样。
- en: otherwise I'm just going to directly，sample the variable like rain which has。no
    parents it's just an unconditional，distribution and keep track of all those。parent
    samples and return the final，sample the exact syntax of this again。not particularly
    important it just，happens to be part of the implementation。
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 否则，我将直接对没有父节点的变量进行采样，比如雨。这只是一个无条件分布，跟踪所有这些父样本，并返回最终样本。这个确切的语法再次并不是特别重要，它只是实现的一部分。
- en: details of this particular library the，interesting logic is down below。that
    I have the ability to generate a，sample if I want to know the。distribution of
    the appointment random。![](img/b54b0a477f393ba9d68b03e2ac479d49_7.png)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 关于这个特定库的细节，下面有有趣的逻辑。如果我想知道约会随机变量的分布，我有能力生成样本。![](img/b54b0a477f393ba9d68b03e2ac479d49_7.png)
- en: variable given that the train is delayed，well then I've can begin to do。calculations
    like this let me take，10，000 samples and assemble all my。results in this list
    called data I'll go，ahead and loop n times in this case。10000 times I'll generate
    a sample and I，want to know the distribution of。
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 变量在火车延误的情况下，那么我就可以开始进行这样的计算。让我取10,000个样本，并把所有结果汇总在一个名为数据的列表中。接下来，我将在这个案例中循环10000次，生成一个样本，我想知道分布情况。
- en: appointment given that the train is，delayed so according to rejection。sampling
    I'm only going to consider，samples where the train is delayed if。the trains not
    delayed I'm not going to，consider those values at all so I'm。going to say all
    right if I take the，sample look at the value of the train。
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到火车延误的情况下的约会，因此根据拒绝采样，我只考虑火车延误的样本。如果火车没有延误，我根本不会考虑这些值。因此，我会说，好吧，如果我取样，看看火车的值。
- en: random variable if the train is delayed，well let me go ahead and add to my data。that
    I'm collecting the value of the，appointment random variable that took。that it
    took on in this particular，sample so I'm only considering the。samples where the
    train is delayed item，and for each of those samples of。
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如果火车延误，这是一个随机变量，那么让我继续添加到我正在收集的数据中。这个数据是关于在这个特定样本中，约会随机变量所取的值。因此，我只考虑火车延误的样本。
- en: considering what's the value of，appointment is and then at the end I'm。using
    a Python class called counter，which quickly counts up all the values。inside of
    a data set so I can take this，list of data and figure out how many。times was my
    appointment made and how，many times was my appointment missed and。
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一下约会的值，然后最后我使用一个名为计数器的Python类，它能快速计算数据集中的所有值。这样我就可以拿到这个数据列表，弄清楚我的约会有多少次被安排，又有多少次被错过。
- en: so this here with just a couple lines of，code is an implementation of rejection。sampling
    and I can run it by going ahead，and running Python sample dot PI and。when I do
    that here's the result I get，this is the result of the counter 1251。times I was
    able to attend the meeting，and 856 times I was able to miss the。
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这里的几行代码实现了拒绝采样。我可以通过运行Python sample.py来运行它。当我这样做时，我得到的结果是计数器的结果，1251次我能够参加会议，856次我能够缺席。
- en: meaning and you can imagine by doing，more and more samples I'll be able to。get
    a better and better more accurate，result and this is a randomized process。it's
    going to be an approximation of the，probability if I run at a different time。you'll
    notice the numbers are similar，1272 and 905 but they're not identical。
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着你可以想象，通过做更多的样本，我将能够得到更好、更准确的结果。这是一个随机化的过程，它将是概率的一个近似值。如果我在不同的时间运行，你会注意到数字是相似的，1272和905，但它们并不完全相同。
- en: because there's some randomization some，likelihood that things might be higher。or
    lower and so this is why we generally，want to try and use more samples so that。we
    can have a greater amount of，confidence in our result be more sure。about the result
    that we're getting of，whether or not it accurately reflects or。
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 因为有一些随机性，某些事情可能更高或更低的可能性。这就是为什么我们通常想尝试使用更多样本，以便对我们的结果有更大的信心，更确信我们得到的结果是否准确反映了。
- en: represents the actual underlying，probabilities that are inherent inside。of this
    distribution and so this then，with an instance of rejection sampling。and it turns
    out there are a number of，other sample，methods that you could use to begin to。try
    to sample one problem that rejection，sampling has is that if the evidence。
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 代表着这个分布内部固有的实际基础概率。因此，这样就有了拒绝采样的实例。事实证明，还有许多其他的样本方法可以用来开始尝试。拒绝采样面临的问题是，如果你寻找的证据。
- en: you're looking for is a fairly unlikely，event well you're going to be rejecting。a
    lot of samples like if I'm looking for，the probability of X given some evidence。e
    if E is very unlikely to occur like，occurs maybe one every thousand times。and
    then I'm only going to be，considering one out of every thousand。
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 是一个相当不太可能的事件，那么你将会拒绝很多样本。比如说如果我在寻找某些证据下的X的概率，如果E发生的可能性非常小，比如每一千次才会发生一次，那么我只能考虑每一千个样本中的一个。
- en: samples that I do which is a pretty，inefficient method for trying to do this。sort
    of calculation I'm throwing away a，lot of samples and it takes。computational effort
    to be able to，generate those samples so I'd like to。not have to do something like
    that so，there are other sampling methods that。
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我进行的样本，这是一种相当低效的方法来尝试进行这种计算。我丢弃了很多样本，这需要计算工作来生成这些样本，因此我希望不必做这样的事情，所以还有其他采样方法。
- en: can try and address this one such，sampling method it's called likelihood。![](img/b54b0a477f393ba9d68b03e2ac479d49_9.png)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 可以尝试解决这个问题，一种叫做可能性的方法。![](img/b54b0a477f393ba9d68b03e2ac479d49_9.png)
- en: waiting in likelihood waiting we follow，a slightly different procedure and the。goal
    is to avoid needing to throw out，samples that didn't match the evidence。and so
    what we'll do is we'll start by，fixing the values for the evidence。variables rather
    than sample everything，we're going to fix the values of the。
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在可能性加权中，我们遵循稍微不同的程序，目标是避免需要丢弃不匹配证据的样本。因此，我们将首先固定证据变量的值，而不是采样所有内容，我们将固定这些值。
- en: evidence variables and not sample those，then we're going to sample all the other。non
    evidence variables in the same way，just using the Bayesian network looking。at
    the probability distributions，sampling all the non evidence variables。but then
    what we need to do is wait each，sample by its likelihood right if our。
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将不对证据变量进行采样，然后以相同的方式采样所有其他非证据变量，只需使用贝叶斯网络查看概率分布，采样所有非证据变量。但是我们需要做的是根据每个样本的可能性来加权。
- en: evidence is really unlikely we want to，make sure that we've taken into account。how
    likely was the evidence to actually，show up in the sample if I have a sample。where
    the evidence was much more likely，to show up than another sample then I。want to
    wait the more likely one higher，so we're gonna wait each sample by its。
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 证据的出现几乎不太可能，我们想确保已经考虑了这一点。如果我有一个样本，证据在该样本中出现的可能性要高于另一个样本，那么我想给更可能出现的样本更高的权重，所以我们将根据每个样本的。
- en: likelihood where likelihood is just，defined as the probability of all the。evidence
    given all the evidence we have，what is the probability that it would。happen in
    that particular sample so，before all of our samples were weighted。equally they
    all had a weight of 1 when，we were calculating like the overall。
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 可能性定义为所有证据在我们拥有的所有证据下，发生的概率。在这个特定样本中，这样的事件发生的概率是多少？因此，在我们的所有样本中，它们的权重是相等的，当我们计算整体时，它们的权重都是1。
- en: average in this case we're going to，weight each sample multiply each sample。by
    its likelihood in order to get the，more accurate distribution so what would。this
    look like well if I ask the same，question what is the probability of。light rain
    given that the train is on，time when I do the sampling procedure。
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们将对每个样本进行加权，乘以每个样本的可能性，以获得更准确的分布。那么这看起来是什么样的呢？如果我问同样的问题，给定火车准时，轻微降雨的概率是多少，当我进行采样程序时。
- en: and start by trying the sample I'm going，to start by fixing the evidence variable。I'm
    already going to have in my sample，know，anything I'm only sampling things where。I
    know the value of the variables that，are my evidence are what I expect them。to
    be so we'll go ahead and sample from，rain and maybe this time a sample light。
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 我将开始尝试抽样，我将先固定证据变量，我将已经在我的样本中知道的东西，知道任何我只抽样那些我知道变量的值的证据是我期望的，所以我们将从雨中抽样，也许这次抽样是轻雨。
- en: rain instead of no rain then I'll sample，from track maintenance and say maybe
    yes。there's track maintenance then for train，well I've already fixed it in place。train
    was an evidence variable so I'm，not gonna bother sampling again I'll。just go ahead
    and move on I'll move on，to appointment and go ahead and sample。
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我将从轨道维护中抽样，并说也许是的，确实有轨道维护，至于火车，我已经将其固定在这里。火车是一个证据变量，所以我不会再去抽样了，我将继续进行，接下来我会去预约并进行抽样。
- en: from appointment as well so now I've，generated a sample I've generated a。sample
    by fixing this evidence variable，and sampling the other three and the。last step
    is now waiting this sample，like how much weight should it have it。and the weight
    is based on like how，probable is it that the train was。
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 也来自于预约，因此现在我已经生成了一个样本，我通过固定这个证据变量并抽样其他三个变量生成了一个样本，最后一步就是为这个样本赋权重，权重是基于火车准时的**概率**。
- en: actually on time this evidence actually，happened given the values of these other。variables
    light rain and the fact that，yes there was track maintenance well to。do that I
    can just go back to the Train，variable and say all right if there was。light rain
    and track maintenance the，likelihood of my evidence the likelihood。
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，证据发生在这个时间点，考虑到这些其他变量的值，轻雨和确实有轨道维护。那么为了做到这一点，我可以回到火车变量，假设如果有轻雨和轨道维护，我的证据的可能性，火车准时的可能性是0.6。
- en: that my train was on time is 0。6 and so，this train this particular sample would，have
    a weight of 0。6 and I could repeat，the sampling procedure again and again，each
    time every sample would be given a。weight according to the probability of，the
    evidence that I see associated with。it and there are other sampling methods，that
    exist as well but all of them are。
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这列火车，这个特定的样本将具有0.6的权重，我可以重复抽样过程，一次又一次，每个样本将根据与之相关的证据的**概率**赋予权重，还有其他抽样方法存在，但它们都是。
- en: designed to try and get it the same idea，to approximate the inference procedure。of
    figuring out the value of a variable，so we've now dealt with probability as。it
    pertains to particular variables that，have these discrete values but what we。haven't
    really considered is how values，might change over time that we've。
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 旨在尝试获取相同的思想，以近似推理程序，来确定一个变量的值，因此我们现在已经处理了与特定变量相关的**概率**，这些变量具有离散值，但我们还没有真正考虑的是，值如何可能随着时间的推移而变化。
- en: considered something like a variable for，rain where rain can take on values
    of。none or light rain or heavy rain but in，practice usually when we consider values。for
    variables like rain we like to，consider it for overtime how do the。values of these
    variables change what do，we do with when we're dealing with。
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个类似于**雨**的变量，其中雨可以取值为无雨、轻雨或大雨，但实际上，通常当我们考虑像雨这样的变量的值时，我们希望考虑的是随着时间的推移，这些变量的值是如何变化的，我们该如何处理。
- en: uncertainty over a period of time which，can come up in the context of weather。for
    example if I have sunny days and I，have rainy days and I'd like to know not。just
    like what is the probability that。![](img/b54b0a477f393ba9d68b03e2ac479d49_11.png)
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在一段时间内的不确定性，这在天气的背景下可能会出现。例如，如果我有阳光明媚的日子和下雨的日子，我想知道的不仅仅是**雨**的概率，而是雨和不雨的概率。
- en: it's raining now but what is the，probability that it rains tomorrow or。the day
    after that or the day after that，and so to do this we're going to。introduce a
    slightly different kind of，model but，here we're gonna have a random variable。not
    just one for the weather but for，every possible time step and you can。
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在正在下雨，但明天或后天，甚至再后天下雨的**概率**是什么？为了解决这个问题，我们将引入一种稍微不同的**模型**，在这里我们将有一个随机变量，不仅仅是天气，还包括每一个可能的时间步骤。
- en: define time step however you like a，simple way is just to use days as your。time
    step and so we can define a，variable called X sub T which is going。to be the weather
    at time T so X sub 0，might be the weather on day 0 X sub 1。might be the weather
    on day 1 so on and，so forth X sub 2 is the weather on day 2。
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 可以根据自己的喜好定义时间步长，一种简单的方法是将天数作为时间步长，因此我们可以定义一个变量叫做X sub T，这将是时间T的天气，因此X sub 0可能是第0天的天气，X
    sub 1可能是第1天的天气，依此类推，X sub 2是第2天的天气。
- en: but as you can imagine if we start to do，this over longer and longer periods
    of。time there's an incredible amount of，data that might go into this if you're。keeping
    track of data about the weather，for a year now suddenly you might be。trying to
    predict the weather tomorrow，given 365 days of previous pieces of。
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 但正如你所想象的，如果我们开始在更长的时间段内进行这个过程，可能会涉及到大量的数据。如果你正在记录一年的天气数据，那么突然间你可能在试图预测明天的天气，基于365天之前的数据。
- en: evidence and that's a lot of evidence to，have to deal with and manipulate and。calculate
    probably nobody knows what the，exact conditional probability。distribution is for
    all of those，combinations of variables and so when。we're trying to do this inference
    inside，of a computer when we're trying to。
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这将会是大量需要处理、操作和计算的证据，可能没有人知道所有这些变量组合的确切条件概率分布是什么，因此当我们试图在计算机中进行推理时，我们会面临挑战。
- en: reasonably do this sort of analysis it's，helpful to make some simplifying。assumptions
    some assumptions about the，problem that we can just assume are true。to make our
    lives a little bit easier，even if they're not totally accurate。assumptions if
    they're close to accurate，or approximate they're usually pretty。
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 为了合理地进行这种分析，做一些简化假设是有帮助的，我们可以假设一些关于问题的假设是真实的，以使我们的生活稍微轻松一点，尽管它们可能并不完全准确。如果这些假设接近准确或大致正确，它们通常是相当好的。
- en: good and the assumption we're going to，make is called the Markov assumption。which
    is the assumption that the current，state depends only on a finite fixed。number
    of previous days so the current，day's weather depends not on all the。previous
    day's weather for the rest of，for all of history but the current days。
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我们要做的假设称为马尔可夫假设，即当前状态仅依赖于有限固定数量的前几天。因此，当前一天的天气并不依赖于所有前几天的天气，而是只依赖于昨天的天气，或者仅依赖于过去两天或三天的天气。
- en: whether I can predict just based on，yesterday's weather or just based in the。last
    two days weather or the last three，days weather but oftentimes we're gonna。deal
    with like just the one previous，state helps to predict this current。state and
    by putting a whole bunch of，these random variables together using。
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 但很多时候，我们会处理的只是一个前一个状态，这有助于预测当前状态，并通过将大量这些随机变量放在一起使用。
- en: this Markov assumption we can create，what's called a Markov chain where a。Markov
    chain is just some sequence of，random variables where each of the。variables distribution
    follows that，Markov assumption and so we'll do an。example of this where the Markov，assumption
    is I can predict the weather。
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这个马尔可夫假设，我们可以创建一个称为马尔可夫链的东西。马尔可夫链只是一系列随机变量的序列，每个变量的分布都遵循马尔可夫假设，因此我们会做一个例子，在这个例子中，马尔可夫假设是我可以预测天气。
- en: is it sunny or rainy or and we'll just，consider those two possibilities for
    now。even though there are other types of，weather but I can predict each day's。weather
    just on the prior days weather，using today's weather I can come up with。a probability
    distribution for，tomorrow's weather and here's what this，weather might。
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 是晴天还是下雨，我们暂时只考虑这两种可能性，尽管还有其他类型的天气，但我可以仅根据前一天的天气来预测每天的天气。利用今天的天气，我可以为明天的天气提供一个概率分布。
- en: it's formatted in terms of a matrix as，we might describe it as sort of rows
    and。columns of values we're on the left hand，side I have today's weather represented。by
    the variable X sub T and over here in，the columns，I have tomorrow's weather represented
    by。the variable X sub t plus 1 T plus 1，day's weather instead and what this。
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这是以矩阵的形式表示的，我们可以将其描述为值的行和列。在左侧，我用变量X sub T表示今天的天气，而在这里的列中，我用变量X sub t plus 1表示明天的天气，T加1的天气而不是其他的。
- en: matrix is saying is if today is sunny，well then you know it's more likely than。not
    that tomorrow is also sunny then，oftentimes the weather stays consistent。for multiple
    days in a row and for，example let's say that if today is sunny。our model says
    that tomorrow with，probability 0。8 it will also be sunny。
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵所表达的是，如果今天是晴天，那么明天也是晴天的可能性更大。通常天气在连续几天内保持一致。例如，假设今天是晴天，我们的模型说，明天晴天的概率是0.8。
- en: and with probability point to what we，rated and likewise if today is raining。then
    it's more likely than not that，tomorrow is also rated with probability，0。7 it'll
    be rating with probability 0。3，it will be sunny so this matrix this。description
    of how it is we transition，from one state to the next state is what。
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 如果今天在下雨，那么明天也是下雨的可能性大于不大，概率为0.7，而晴天的概率为0.3。因此，这个矩阵，这种从一个状态转移到下一个状态的描述就是我们所称的转移模型。
- en: we're gonna call the transition model，and using the transition model you can。begin
    to construct this Markov chain by，just predicting you know given today's。weather
    what's the likelihood of，tomorrow's weather happening and you can。imagine doing
    a simpler similar sampling，procedure where you take this。
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 使用转移模型，你可以开始构建这个马尔可夫链，只需预测今天的天气，明天的天气发生的可能性。你可以想象做一个更简单的抽样过程，使用这个方法。
- en: information you sample what tomorrow's，weather is going to be using that you。sample
    the next day's weather and the，result of that is you can form this。Markov chain
    of like X zero time and ten，day zero is sunny the next day is sunny。maybe the
    next day it changes to raining，then raining and raining and the pattern。
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以抽样明天的天气，使用这个方法来抽样第二天的天气，结果是你可以形成这样的马尔可夫链：在时刻X零，第一天是晴天，第二天也是晴天，接下来可能变为下雨，然后又是下雨，这种模式就出现了。
- en: that this Markov chain follows given the，distribution that we had access to
    this。transition model here is that when it's，sunny it tends to stay sunny for
    a。little while the next couple days tend，to be sunny too and when it's raining
    it。tends to be raining as well and so you，get a Markov chain that looks like this。
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 这个马尔可夫链遵循的分布是我们可以访问的。当天气晴朗时，它往往会保持晴朗，接下来的几天也会是晴天；而下雨时，它也往往会继续下雨，因此你得到的马尔可夫链看起来是这样的。
- en: and you can do analysis on this you can，say you know given that today is raining。what
    is the probability that tomorrow is，raining or you can begin to ask。probability
    questions like what is the，probability of this sequence of five。values Sun Sun
    rain rain rain and answer，those sorts of questions too and it。
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以对这个进行分析，比如说今天在下雨。那么明天也在下雨的概率是多少？或者你可以开始问概率问题，比如这一系列五个值的概率：晴天、晴天、雨天、雨天、雨天，并回答这类问题。
- en: turns out there again many Python，libraries for interacting with models。like
    this of probabilities that have，distributions and random variables that，are based
    on previous。variables according to this markup，assumption and pomegranate 2 has
    ways of。dealing with these sorts of variables so，I'll go ahead and go into the
    Markov or。
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 确实有很多Python库用于与概率模型交互，这些模型具有基于之前变量的分布和随机变量。根据这个马尔可夫假设，Pomegranate 2提供了处理这些类型变量的方法，所以我将继续深入马尔可夫模型。
- en: the I'll go ahead and go into the chain。![](img/b54b0a477f393ba9d68b03e2ac479d49_13.png)
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我将继续深入链条。![](img/b54b0a477f393ba9d68b03e2ac479d49_13.png)
- en: directory where I have some information，about Markov chains and here I've。defined
    a file called model pi where，I've defined in a very similar syntax。and again the
    exact syntax doesn't，matter so much as the idea that I'm。encoding this information
    into a Python，program so that the program has access。
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 目录中有一些关于马尔可夫链的信息，我在这里定义了一个名为model pi的文件，使用了非常相似的语法。再说一次，确切的语法并不那么重要，关键是我在将这些信息编码进一个Python程序，以便程序可以访问。
- en: to these distributions I've heerd to，find some starting distribution so every。Markov
    model begins at some point in，time and I need to give it some starting。distribution
    and so we'll just say you，know at the start you can pick 50-50。between sunny and
    rainy we'll say it's，sunny 50% of the time rainy 50% of the。
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这些分布，我听说过，找到一些起始分布。因此，每个马尔可夫模型都从某个时间点开始，我需要给它一个起始分布。我们就假设一开始你可以选择晴天和雨天各50%。我们说晴天的概率是50%，雨天也是50%。
- en: time and then down below I've here，defined the transition model how it is。that
    I transition from one day to the，next and here I've encoded that exact，sunny today。then
    with probability 0。8 it will be，sunny tomorrow and it'll be rainy，tomorrow with
    probability 0。2 and I，likewise have another distribution for，if it was raining
    today instead and so。
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面，我定义了转移模型，即我如何从一天转移到下一天，并且我编码了今天是晴天的确切概率。然后，明天是晴天的概率为0.8，而明天是雨天的概率为0.2。同样，如果今天是雨天，我也有另一种分布。
- en: that alone defines the Markov model you，can begin to answer questions using
    that。model but one thing I'll just do is，sample from the Markov chain it turns。out
    there's a method built into this，Markov chain library that allows me to。sample
    50 seats from the chain basically。
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 仅凭这一点就定义了马尔可夫模型，你可以开始使用该模型回答问题，但我所做的一件事是从马尔可夫链中抽样。结果发现，这个马尔可夫链库内置了一个方法，可以让我从链中抽样50个状态。
- en: '![](img/b54b0a477f393ba9d68b03e2ac479d49_15.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b54b0a477f393ba9d68b03e2ac479d49_15.png)'
- en: just simulating like 50 instances of，weather and so let me go ahead and run。this
    Python model pi and when I run it，what I get is that it's going to sample。from
    this Markov chain 50 states 50 days。![](img/b54b0a477f393ba9d68b03e2ac479d49_17.png)
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这就像模拟50个天气实例。因此，我要运行这个Python模型。当我运行它时，我得到的结果是，它将从这个马尔可夫链中抽样50个状态，50天。![](img/b54b0a477f393ba9d68b03e2ac479d49_17.png)
- en: worth of weather that it's just going to，randomly simple and you can imagine。sampling
    many times to be able to get，more data to be able to do more analysis。but here
    for example it's you know sunny，to day in day days in a row raining a。whole bunch
    of days in a row before it，changes back to Sun and so you get this。
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 天气的样本是随机的，你可以想象多次抽样以获得更多数据，从而进行更多分析。但在这里，例如，今天是晴天，连续几天都是晴天，然后下了好几天的雨，才又变回晴天，因此你会得到这种。
- en: model that follows the distribution that，we originally described that follows
    the。distribution of sunny days tend to lead，to more sunny days of rainy days tend
    to。lead to more rainy days and that then is，a Markov model and Markov models rely
    on。us knowing the values of these，individual states I know that today is。
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 遵循我们最初描述的分布，遵循晴天往往会导致更多晴天，雨天往往会导致更多雨天，这就是马尔可夫模型。马尔可夫模型依赖于我们知道这些个体状态的值。我知道今天是。
- en: sunny or that today is raining and using，that information，I can draw some sort
    of inference about。what tomorrow is going to be like but in，practice this often
    isn't the case it。often isn't the case then I know for，certain what the exact
    state of the。world is oftentimes the state of the，world is exactly unknown but
    I'm able to。
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 无论今天是晴天还是下雨，利用这些信息，我可以对明天的天气做出某种推断，但实际上，这种情况往往并非如此。很多时候我并不知道世界的确切状态，而世界的状态往往是未知的，但我能够。
- en: somehow sense some information about，that state that a robot or an AI doesn't。have
    exact knowledge about the world，around it but it has some sort of sensor。whether
    that sense there is a camera or，like sensors that detect distance or。just a microphone
    that is sensing audio，for example it is sensing data and using。
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在某种程度上，有一些关于状态的信息，机器人或人工智能并不对周围的世界有确切的知识，但它有某种传感器，无论是摄像头、测距传感器，还是感应音频的麦克风，例如它在感知数据并利用。
- en: that data that data is somehow related，to the state of the world even if it。doesn't
    actually know our AI doesn't，know what the underlying true state of。the world
    actually is and for that we，need to get into the world of sensor。models the way
    of describing how it is，that we translate what the hidden state。
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 那些数据与世界的状态在某种程度上是相关的，即使它并不真正知道。我们的人工智能并不知道世界的真实状态是什么，因此我们需要进入传感器模型的领域，描述我们如何将隐藏状态转化为可观测状态。
- en: the underlying true state of the world，is and with what the observation what
    it。is that the AI knows that the air has，access to actually is and so for example。a
    hidden state might be a robot's，position if a robot is exploring new。uncharted
    territory the robot likely，doesn't know exactly where it is but it。
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 世界的真实状态是什么，以及观察结果是什么，即人工智能所知的实际上是访问的内容。例如，隐藏状态可能是机器人的位置。如果一个机器人正在探索未知的领土，机器人可能并不确切知道自己在哪里，但它。
- en: does have an observation it has robot，sensor data where it can sense you know。how
    far away are possible obstacles，around it and using that information。using the
    observed information that it，has it can infer something about the。hidden state
    because what the true，hidden state is influences those。
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 具有观察能力的机器人拥有传感器数据，可以感知周围可能的障碍物有多远，利用这些信息，基于它所观察到的信息，它可以推断一些关于隐藏状态的事情，因为真实的隐藏状态会影响这些。
- en: observations whatever the robots true，position is of affects it has some。effect
    upon what the sensor data the，robot is able to collect is even if the。robot doesn't
    actually know for certain，what its true position is likewise if。you think about
    a voice recognition or a，speech recognition program that listens。
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 不论机器人的真实位置是什么，都会影响机器人能够收集的传感器数据，即使机器人并不确切知道它的真实位置。如果你考虑一个语音识别或语音识别程序，它在监听时。
- en: to you and is able to respond to you，something like Alexa or your or what。Apple
    and Google are doing with their，voice recognition as well that you might。imagine
    that the hidden state the，underlying state is what words are。actually spoken the
    true nature of the，world contains you saying a particular。
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 它能够响应你，类似于 Alexa 或你在 Apple 和 Google 的语音识别中所做的，你可能会想象这个隐藏状态，即底层状态是实际说出的单词，世界的真实本质包括你说的特定内容。
- en: sequence of words but your phone or your，a home smart home device doesn't know。for
    sure exactly what words you said the，only absorb servation。that the AI has access
    to is like some，audio waveforms and those audio。waveforms are of course dependent
    up，this hidden state and you can infer。
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 一系列单词，但你的手机或智能家居设备并不确切知道你说了什么，AI 仅能接收到的观察是一些音频波形，而这些音频波形当然依赖于这个隐藏状态，你可以推断。
- en: based on those audio waveforms what the，word spoken likely were but you might。not
    know with a hundred percent，certainty what that hidden state。actually is and it
    might be a task to，try and predict given this observation。given these audio waveforms
    can you，figure out what the actual words spoken。
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这些音频波形，可以推测出说出的单词，但你可能无法百分之百确定这个隐藏状态到底是什么，预测这个观察下的隐藏状态可能是一项任务。根据这些音频波形，你能否弄清楚实际说出的单词是什么。
- en: are likewise you might imagine on a，website true user engagement might be。information
    you don't directly have，access to you can observe data like。website or app analytics
    about how often，was this button clicked or how often are。people interacting with
    a page in a，particular way and you can use that to。
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，你可以想象在一个网站上，真实的用户参与可能是你无法直接访问的信息，你可以观察一些数据，比如网站或应用分析，关于这个按钮被点击的频率或人们以特定方式与页面互动的频率，你可以利用这些数据。
- en: infer things about your users as well so，this type of problem comes up all the。time
    when we're dealing with AI and，trying to infer things about the world。that often
    AI doesn't really know the，hidden true state of the world all the。AI has access
    to is some observation，that is related to the hidden true state。
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 也可以推断用户的信息，所以这种类型的问题在我们处理 AI 时经常出现，试图推测关于世界的事情，而 AI 往往并不真正知道世界的隐藏真实状态，所有 AI
    能访问的只是与隐藏真实状态相关的一些观察。
- en: but it's not direct there might be some，noise there the audio waveform might。have
    some additional noise it might be，difficult to parse the sensor data might。not
    be exactly correct there's some，noise that might not allow you to。conclude with
    certainty what the hidden，state is but can allow you to infer what。
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 但这并不是直接的，可能会有一些噪音，音频波形可能会有一些额外的噪音，解析传感器数据可能并不完全正确，存在一些噪音可能会使你无法确定隐藏状态，但可以让你推断出。
- en: it might be and so the simple example，we'll take a look at here is imagining。![](img/b54b0a477f393ba9d68b03e2ac479d49_19.png)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 可能是这样，所以我们在这里看的简单例子是想象一下。![](img/b54b0a477f393ba9d68b03e2ac479d49_19.png)
- en: the hidden state as the weather whether，it's sunny or rainy or not and imagine。you
    are programming an AI inside of a，building that maybe has access to just a。camera
    to inside the building and all，you have access to is an observation as。to whether
    or not employees are bringing，an umbrella into the building or not you。
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 隐藏状态就像天气，无论是晴天还是雨天，你可以想象。你正在一个建筑物内部编程一个 AI，而这个建筑物可能只有一个摄像头可以观察内部，而你能访问的只是一个关于员工是否带伞进入建筑物的观察。
- en: can detect whether it's an umbrella or，not and so you might have an observation。as
    to whether or not an umbrella is，brought into the building or not and。using that
    information you want to，predict whether it's sunny or rainy even。if you don't
    know what the underlying，weather is so the underlying weather。
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 可以检测到是否是伞，因此你可能会有一个观察。结果，看看是否有伞被带进建筑物，使用这些信息你想。预测是晴天还是雨天，即使你不知道潜在的。天气是什么，因此潜在的天气。
- en: might be sunny or rainy and if it's，raining obviously people are more likely。to
    bring an umbrella and so whether or，not people bring an umbrella your。observation
    tells you something about，the hidden state and of course this is a。bit of a contrived
    example but the idea，here is to think about this more broadly。
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 可能是晴天或雨天，如果下雨，显然人们更有可能。带伞。因此，无论人们是否带伞，你的观察会告诉你一些关于。隐藏状态的事情，当然，这个例子有点牵强，但这里的想法是更广泛地考虑。
- en: in terms of more generally anytime you，observe something it having to do with，some
    underlying。hidden state and so to try and model，this type of idea where we have
    these。hidden states and observations rather，than just use a Markov model which
    has。state state state state each of which is，connected，by that transition matrix
    that we。
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 更一般地说，每当你观察某事时，都会与某个潜在的。隐藏状态有关。因此，尝试建模这种想法，我们有这些。隐藏状态和观察，而不是仅仅使用马尔可夫模型，该模型有。状态、状态、状态、状态，每个状态通过那个转换矩阵连接。
- en: described before we're going to use what，we call a hidden Markov model very。similar
    to a Markov model but this is，going to allow us to model a system that。has hidden
    states that we don't directly，observe along with some observed event。that we do
    actually see and so in，addition to that transition model that。
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们将使用我们称之为隐藏马尔可夫模型，非常。类似于马尔可夫模型，但这将允许我们建模一个系统。具有我们无法直接观察的隐藏状态，以及一些观察事件。我们确实可以看到，因此，除了转换模型。
- en: we still need of saying you know given，the underlying state of the world if。it's
    sunny or rainy what's the，probability of tomorrow's weather we。also need another
    model that given some，state is gonna give us an observation of。like Green yes
    someone brings an，umbrella into the office or red no。
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仍然需要说明你知道的，世界的潜在状态。如果是晴天还是雨天，明天的天气概率是什么，我们。还需要另一个模型，给定某种状态，能够给我们一个观察结果。比如说，绿色是有人带了伞进办公室，红色则是没有。
- en: nobody brings umbrellas into the office，and so the observation might be that
    if。it's sunny then odds are nobody's gonna，bring an umbrella to the office but。maybe
    some people are just being，cautious and they do bring an umbrella。to the office
    anyways and if it's，raining then with much higher。
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没人带伞进办公室，那么观察可能是，如果。是晴天，那么没人会带伞进办公室，但。也许有些人只是比较谨慎，仍然带伞。进办公室。如果下雨，那么概率就高得多。
- en: probability then people are gonna bring，umbrellas into the office but maybe
    if。the rain was unexpected people didn't，bring an umbrella and so they might have。some
    other probability as well so using，the observations you can begin to。predict with
    reasonable likelihood what，the underlying state is even if you。
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 概率然后人们会带伞进办公室，但也许如果。下雨是意外，人们没有带伞，因此他们可能会有。其他概率。因此，通过使用观察，你可以开始。合理地预测潜在状态，即使你。
- en: don't actually get to observe the，underlying state if you don't get to see。what
    the hidden state is actually equal，to this here we'll often call the sensor。model
    it's also often called the。![](img/b54b0a477f393ba9d68b03e2ac479d49_21.png)
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你看不到潜在状态，也就是说。你无法看到隐藏状态的实际值，这里我们通常称之为传感器。模型，它也常常被称为。
- en: emission probabilities because the state，the underlying state emits some sort
    of。emission that you then observe and so，that can be another way of describing。that
    same idea and the sensor Markov，assumption that we're going to use is。this an
    assumption that the evidence，variable the thing we observe the。
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 发射概率因为潜在状态发出某种。发射，然后你观察到，因此，这可以是描述。相同想法的另一种方式，而我们将使用的传感器马尔可夫假设是。这是一个假设，证据变量，也就是我们观察到的事物。
- en: emission that gets produced depends only，on the corresponding state meaning
    it。can predict whether or not people will，bring umbrellas or not entirely。dependent
    just on whether it is sunny or，rainy today of course again this。assumption might
    not hold in practice，that in practice you might depend。
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 产生的发射仅依赖于相应的状态，这意味着它。可以预测人们是否会带伞，完全。依赖于今天是晴天还是雨天，当然，这个假设在实践中可能不成立。
- en: whether or not people bring umbrellas，might depend not just on today's weather。but
    also when yesterday's weather and，the day before but for simplification。purposes
    it can be helpful to apply this，sort of assumption just to allow us to。be able
    to reason about these，probabilities a little more easily and。
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 人们是否带伞可能不仅取决于今天的天气，还可能取决于昨天和前天的天气，但为了简化，假设这可以帮助我们更容易地推理这些概率。
- en: if we're able to approximate it we can，still often get a very good answer and。so
    what these hidden Markov models end，up looking like is a little something，have。chain
    of states like Sun Sun rain rain，rain we instead have this upper level。which is
    the underlying state of the，world is it sunny or is it rainy and。
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们能够近似它，我们仍然可以得到一个非常好的答案。因此，这些隐马尔可夫模型最终看起来有点像一连串的状态，如晴天、晴天、下雨、下雨，我们反而有一个上层，代表世界的潜在状态，是晴天还是下雨。
- en: those are connected by that transition，matrix we described before but each of。these
    states produces an emission，produces an observation that I see that。on this day
    it was sunny and people，didn't bring umbrellas and on this day。it was sunny but
    people did bring，umbrellas and on this day it was raining。
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这些状态通过我们之前描述的转移矩阵连接，但每个状态产生的观察结果我看到的是，这一天是晴天而人们没有带伞，而那一天是晴天但人们带了伞，还有这一天在下雨。
- en: and people did bring umbrellas and so on，and so forth and so each of these。underlying
    States represented by X sub T，for X sub 1 0 1 2 so on and so forth。produces some
    sort of observation or，omission which is what the e stands for。e sub 0 e sub 1
    Y sub 2 so on and so，forth and so this too is a way of trying。
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 人们确实带了伞等等，这些潜在状态由 X_sub T 表示，如 X_sub 0, 1, 2 等等，产生某种观察或发射，e 代表的就是这些，e_sub 0,
    e_sub 1, Y_sub 2 等等，这也是一种尝试。
- en: to represent this idea and what you want，to think about is that these underlying。states
    are the true nature of the world，the robot's position as it moves over。time and
    that produces some sort of，sensor data that might be observed or。what people are
    actually saying and，using the emission data of what audio。
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 要表示这个理念，你需要考虑的是，这些潜在状态是真实世界的本质，机器人在时间中移动时的位置，从而产生某种可能被观察到的传感器数据，或人们实际说的话，以及关于音频的发射数据。
- en: waveforms do you detect in order to，process that data and try and figure it。out
    and there are a number of possible，tasks that you might want to do given。this
    kind of information and one of the，simplest is trying to infer something。about
    the future or the past or about，these sort of hidden states that might。
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种信息下，你可能想要完成的任务有很多，其中最简单的之一是尝试推断未来或过去，或者这些可能隐藏的状态。
- en: exist and so the tasks that you'll often，see and we're not going to go into
    the。mathematics of these tasks but they're，all based on the same idea of。conditional
    probabilities and using the，probability distributions we have to。draw these sorts
    of conclusions one task，is called filtering which is given。
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 存在的任务往往是你会看到的，我们不打算深入探讨这些任务的数学，但它们都基于条件概率的相同理念，并使用我们拥有的概率分布来得出这些结论。其中一个任务叫做过滤，涉及到你检测到的波形，以处理这些数据并试图弄清楚。
- en: observations from the start until now，calculate the distribution for the。current
    state meaning you know given，information about from the beginning of。time until
    now on which days that people，bring an umbrella or not bring an。umbrella can I
    calculate the probability，of the current state that today is it。
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 从开始到现在的观察结果，计算当前状态的分布，这意味着根据从时间开始到现在的信息，哪些日子人们带伞或不带伞，我能否计算出当前状态的概率，也就是今天是晴天。
- en: sunny or is it rain in another task that，might be possible is prediction which
    is。looking towards the future given，observations about people bringing。umbrellas
    from the beginning of the when，we started counting time until now can I。figure
    out the distribution that，tomorrow is it sunny or is it raining。
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可能的任务是预测，这意味着在观察到人们从开始到现在带伞的情况下，向未来看，我能否推测明天是晴天还是下雨。
- en: and you can also go backwards as well by，a smoothing where I can say given。observations
    from start until now，the distributions for some passed state。like I know that
    today people brought，umbrellas and tomorrow people brought。umbrellas and so given
    two days worth of，data people bringing umbrellas what's。
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以向后推断，通过平滑处理，我可以说，从开始到现在的观察结果，某个过去状态的分布，例如，我知道今天人们带了伞，明天人们也带了伞，因此基于两天的数据，带伞的人数是多少。
- en: the probability that yesterday it was，raining and that I know that people。brought
    umbrellas today that might，inform that decision as well and might。influence those
    probabilities and，there's also a most likely explanation。task in addition to other
    tops that，might exist as well which is combining。
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 昨天下雨的概率，以及我知道今天人们带了伞，这也可能影响这个决定，并可能影响这些概率。此外，还有一个最可能的解释任务，除了可能存在的其他任务，这涉及到组合。
- en: some of these given observations from，the start up until now figuring out the。![](img/b54b0a477f393ba9d68b03e2ac479d49_23.png)
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这些观察结果从一开始到现在，找出这些。![](img/b54b0a477f393ba9d68b03e2ac479d49_23.png)
- en: most likely sequence of states and this，is what we're gonna take a look at now。this
    idea that if I have all these，observations umbrella no umbrella。umbrella no umbrella
    can I calculate the，most likely states of Sun rain Sun rain。and whatnot that actually
    represented，the true weather that would produce。
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 最可能的状态序列，这就是我们现在要关注的内容。这个想法是，如果我有所有这些观察结果，伞与不伞，伞与不伞，我能否计算出最可能的太阳和雨的状态。
- en: these observations and this is quite，common when you're trying to do。something
    like voice recognition for，example that you have these emissions of。these audio
    waveforms and you would like，to calculate based on all of the。observations that
    you have what is the，most likely sequence of actual words or。
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这些观察结果是相当常见的，特别是在你尝试做一些像语音识别的事情时，你会有这些音频波形的发射结果，并且你希望根据你所拥有的所有观察结果来计算出最可能的实际单词序列。
- en: syllables or sounds that the user，actually made when they were speaking to。this
    particular device or other tasks，that might come up in that context as。well and
    so we can try this out by going，ahead and going into the hmm directory。![](img/b54b0a477f393ba9d68b03e2ac479d49_25.png)
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 用户在与这个特定设备或其他可能出现的任务交谈时所发出的音节或声音，因此我们可以通过进入hmm目录来尝试这个。![](img/b54b0a477f393ba9d68b03e2ac479d49_25.png)
- en: hmm for hidden Markov model and here，what I've done is I've defined a model。where
    this model first defines my，possible state Sun in rain along with。their emission
    probabilities the，observation model or the emission model。where here given that
    I know that it's，sunny the probability that I see people。
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: hmm代表隐马尔可夫模型，这里我定义了一个模型，这个模型首先定义了我可能的状态，太阳和雨，以及它们的发射概率，观察模型或发射模型，在这里考虑到我知道是晴天，我看到人们的概率。
- en: bring an umbrella is point to the，probability of no umbrella is 0。8 and。likewise
    if it's raining then people are，more likely to bring an umbrella，umbrella has
    probability 0。9 no umbrella，has probability 0。1 so the actual，underlying hidden
    States those states。are sun and rain but the things that I，observe the observations
    that I can see。
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 带伞的概率为0.2，而不带伞的概率为0.8。如果下雨，那么人们更可能带伞，带伞的概率为0.9，不带伞的概率为0.1，因此实际的潜在隐含状态是太阳和雨，但我观察到的事情就是我能看到的观察结果。
- en: are either umbrella or no umbrella as，the things that I observe as a result
    so。this then I also need to add to it a，transition matrix same as before saying。that
    if today is sunny then tomorrow is，more likely to be sunny and if today is。rainy
    then tomorrow is more likely to be，raining，as it before I give it some starting。
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 我观察到的结果要么是带伞，要么是不带伞，因此我还需要为此添加一个转移矩阵，和之前一样，说明如果今天是晴天，那么明天更可能是晴天；如果今天是雨天，那么明天更可能是下雨。和之前一样，我给它一些起始值。
- en: probabilities saying at first you know，50-50 chance for whether it's sunny or。rainy
    and then I can create the model，based on that information again the。exact syntax
    of this is not so important，so much as it is the data that I am now。encoding into
    a program such that now I，can begin to do some inference so I can。
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 概率一开始你知道，无论是晴天还是雨天，都是50-50的机会，然后我可以根据这些信息创建模型。这个语法的确切形式并不是那么重要，重要的是我现在正在编码的数据，以便我现在可以开始进行一些推断。
- en: give my program for example a list of，observations，you know umbrella umbrella
    no umbrella。umbrella umbrella so on and so forth no，umbrella no umbrella and I
    would like to。calculate I would like to figure out the，most likely explanation
    for these。observations what is likely is is where，the rain rain is this rain or
    is it more。
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 给我的程序一个观察列表，比如伞、伞、没伞、伞、伞，等等，没伞、没伞，我想计算，找出这些观察的最可能解释，最有可能的是否是下雨，或者说下雨。
- en: likely that this was actually sunny and，then it switched back to it being rainy。and
    you know that's an interesting，question we might not be sure because it。might
    just be that it just so happened，on this rainy day people decided not to。bring
    an umbrella or it could be that it，switched from rainy to sunny back to。
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 可能更有可能的是实际上是晴天，然后又变成下雨，这是个有趣的问题，我们可能不太确定，因为可能只是恰好在这一天人们决定不带伞，或者可能是从下雨变成晴天再变回。
- en: rainy which doesn't seem too likely but，it certainly could happen and using
    the。data we give to the hidden Markov model，our model can begin to predict these。answers
    can begin to figure it out so，we're going to go ahead and just predict。these observations
    and then for each of，those predictions go ahead and print out。
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 下雨的情况似乎不太可能，但确实可能发生，利用我们提供给隐马尔可夫模型的数据，我们的模型可以开始预测这些答案，逐步找出，所以我们将继续预测这些观察结果，然后对每个预测进行打印。
- en: what the prediction is and this library，just so happens to have a function。![](img/b54b0a477f393ba9d68b03e2ac479d49_27.png)
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 预测是什么，这个库恰好有一个函数。![](img/b54b0a477f393ba9d68b03e2ac479d49_27.png)
- en: called predict that does this prediction，process for me I'll run Python sequence。pi
    and the result I get is this this is。![](img/b54b0a477f393ba9d68b03e2ac479d49_29.png)
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 被称为预测，它为我执行这个预测过程，我将运行Python序列，得到的结果是这个！[](img/b54b0a477f393ba9d68b03e2ac479d49_29.png)
- en: the prediction based on the observations，of what all of those states are likely。to
    be and it's likely to be rain and，rain in this case it thinks that what。most likely
    happened is that it was，sunny for a day and then went back to。being rainy but
    in different situations，if it was raining for longer maybe or if。
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 基于观察的预测，关于所有这些状态可能是什么，最有可能的是下雨，在这种情况下，它认为最有可能发生的是，先是晴天一天，然后又变成下雨，但在不同的情况下，如果下雨的时间更长，也许。
- en: the probabilities were slightly，different you might imagine that it's。more likely
    that it was rainy all the，way through and it just so happened on。one rainy day
    people decided not to，bring umbrellas and so here two Python。libraries can begin
    to allow for the，sort of inference procedure and by。
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 概率稍有不同，你可能想象更可能的是一直下雨，只是在某个雨天人们决定不带伞，所以这里有两个Python库可以开始进行推断程序。
- en: taking what we know and by putting it in，terms of these tasks that already exist。these
    general tasks that work with，hidden Markov models then anytime we can。take an
    idea and formulate it as a，hidden Markov model formulate it as。something that
    has hidden states and，observe emissions that result from those。
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 利用我们所知道的，并将其转换为这些已经存在的任务，这些与隐马尔可夫模型协作的通用任务，那么每当我们能够将一个想法表述为隐马尔可夫模型，将其表述为具有隐状态和由此产生的观察发射的东西。
- en: states then we can take advantage of，these algorithms that are known to exist。![](img/b54b0a477f393ba9d68b03e2ac479d49_31.png)
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 状态，然后我们可以利用这些已知存在的算法。![](img/b54b0a477f393ba9d68b03e2ac479d49_31.png)
- en: for trying to do this sort of，friends so now we've seen a couple of。ways that
    a I can begin to deal with，uncertainty we've taken a look at。probability and how
    we can use，probability to describe numerically。things that are likely or more
    likely or，less likely to happen than other events。
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试做这种朋友，所以现在我们已经看到几种方式，我可以开始处理不确定性，我们查看了概率，以及如何使用概率来定量描述那些可能或更可能或不太可能发生的事情。
- en: or other variables and using that，information we can begin to construct。these
    standard types of models things，like Bayesian networks and Markov chains。and hidden
    Markov models that all allow，us to be able to describe how particular。events relate
    to other events or how the，values of particular variables relate to。
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 或其他变量，利用这些信息，我们可以开始构建这些标准类型的模型，比如贝叶斯网络、马尔可夫链和隐马尔可夫模型，这些都允许我们描述特定事件与其他事件之间的关系，或者特定变量的值与。
- en: other variables not for certain but with，some sort of probability distribution。and
    by formulating things in terms of，these models that already exist we can。take
    advantage of Python libraries that，implement these sort of models already。and
    allow us just to be able to use them，to produce some sort of resulting effect。
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 其他变量虽然不确定，但具有某种概率分布。通过将事物表述为这些已有模型，我们可以利用已经实现这些模型的Python库。
- en: so all of this then allows our AI to，begin to deal with these sort of。uncertain
    problems so that our AI，doesn't need to know things for certain。but can infer
    based on information it，doesn't know next time we'll take a look。at additional
    types of problems that we，can solve by taking advantage of a I。
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 这样，我们的AI就能够开始处理这些不确定的问题，而不需要确切知道事情，但可以根据未知信息进行推断。下次我们将看看可以利用AI解决的其他类型的问题。
- en: related algorithms even beyond the world，of the types of problems we've already。
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 相关算法甚至超越了我们已经讨论过的问题类型的领域。
