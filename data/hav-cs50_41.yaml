- en: Lecture 3
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 3 讲
- en: 原文：[https://cs50.harvard.edu/r/notes/3/](https://cs50.harvard.edu/r/notes/3/)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://cs50.harvard.edu/r/notes/3/](https://cs50.harvard.edu/r/notes/3/)
- en: '[Welcome!](#welcome)'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[欢迎！](#welcome)'
- en: '[Defining Functions](#defining-functions)'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[定义函数](#defining-functions)'
- en: '[Scope](#scope)'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[作用域](#scope)'
- en: '[Checking Input](#checking-input)'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查输入](#checking-input)'
- en: '[Loops](#loops)'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[循环](#loops)'
- en: '[Using Loops](#using-loops)'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用循环](#using-loops)'
- en: '[Using Functions and Loops](#using-functions-and-loops)'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用函数和循环](#using-functions-and-loops)'
- en: '[Applying Functions](#applying-functions)'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[应用函数](#applying-functions)'
- en: '[Summing Up](#summing-up)'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结](#summing-up)'
- en: Welcome!
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 欢迎！
- en: Welcome back to CS50’s Introduction to Programming with R!
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欢迎回到 CS50 的 R 编程入门课程！
- en: Today, we will be learning about applying functions. We will also learn how
    to write our own functions and apply loops.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 今天，我们将学习如何应用函数。我们还将学习如何编写自己的函数并应用循环。
- en: Recall a program that we created during our last lecture called `count.R`.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回想一下我们在上次讲座中创建的名为 `count.R` 的程序。
- en: '[PRE0]'
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Notice how the lines repeat functionality to get input from the user.
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到如何重复行以从用户那里获取输入。
- en: Traditionally, any time in programming that we reuse code over and over again
    is regarded as an opportunity for improvement. Functions are one way by which
    we can reduce these redundancies by defining certain blocks of code we can reuse
    throughout our programs.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 传统上，在编程中每次重复使用代码都是改进的机会。函数是我们通过定义可以在整个程序中重用的代码块来减少这些冗余的一种方式。
- en: Defining Functions
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 定义函数
- en: In R, functions are defined by the syntax `function()`.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 R 中，函数通过语法 `function()` 定义。
- en: 'Consider the following improved version of our program:'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑以下我们程序的改进版本：
- en: '[PRE1]'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Notice that a new function called `get_votes` is created. The *body* of the
    function is denoted by opening and closing curly braces (`{` and `}`). Notice
    that within the body there are 2 lines of code, which will run each time this
    function is called. First, the `votes` are gathered from the user. Second, the
    `votes` are returned. `mario`, `peach` and `bowser` each receive the return value
    after `get_votes` is called. Finally, the sum of the values is provided and displayed
    to the user.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到创建了一个名为 `get_votes` 的新函数。函数的 *主体* 由开闭花括号 (`{` 和 `}`) 表示。注意，在主体内部有 2 行代码，每次调用此函数时都会执行。首先，从用户那里收集
    `votes`。其次，返回 `votes`。在调用 `get_votes` 之后，`mario`、`peach` 和 `bowser` 分别接收返回值。最后，提供值的总和并显示给用户。
- en: Congratulations, this is your first function in R!
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恭喜你，这是你在 R 中的第一个函数！
- en: 'However, running this function, we find that the function has lost some functionality
    that we had prior. Could there be a way we can provide a *parameter* to the function
    so we can more accurately prompt the user? Indeed, we can! Consider the following:'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然而，运行这个函数，我们发现该函数丢失了一些我们之前的功能。我们能否以某种方式向函数提供一个 *参数*，以便我们可以更准确地提示用户？确实可以！考虑以下：
- en: '[PRE2]'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Notice that a `prompt` is provided to the `get_votes` function. Thus, the user
    is prompted with the names of those they are voting for. Additionally, notice
    that the `return(votes)` statement has been removed. In R, functions automatically
    return the last computed value.
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到向 `get_votes` 函数提供了一个 `prompt`。因此，用户会被提示他们要投票的人的名字。此外，注意已经移除了 `return(votes)`
    语句。在 R 中，函数会自动返回最后计算出的值。
- en: 'Functions that have parameters may have default values assigned. Consider the
    following update to our program:'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 具有参数的函数可能已分配了默认值。考虑以下我们程序的以下更新：
- en: '[PRE3]'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Notice how a default value is offered in the first line of code.
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到在代码的第一行提供了一个默认值。
- en: 'We can still override the default prompt as follows:'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们仍然可以像这样覆盖默认提示：
- en: '[PRE4]'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Notice how, for each function call, the given argument overrides the default
    argument.
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到对于每次函数调用，给定的参数会覆盖默认参数。
- en: Scope
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 作用域
- en: Looking at our environment pane in RStudio, notice that values are provided
    for `bowser` and others. However, no value for `votes` appears. Why might this
    be?
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看我们的 RStudio 环境面板，注意到为 `bowser` 和其他人提供了值。然而，没有为 `votes` 提供值。为什么可能会这样？
- en: Turns out all objects are defined within certain “environments.” One such environment
    is the “global” environment. The global environment is home to objects you define
    in the R console or outside of a function body—objects like `mario`, `bowser`,
    and `peach`. By default, RStudio’s environment pane shows you objects defined
    in the global environment.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果表明，所有对象都是在某些“环境”中定义的。其中一种环境是“全局”环境。全局环境是您在 R 控制台或函数体外部定义的对象的家园——例如 `mario`、`bowser`
    和 `peach`。默认情况下，RStudio 的环境面板显示您在全局环境中定义的对象。
- en: '![Visualization of global environment](../Images/4e21d01cbb22b2b2b5a55db2138468ee.png)'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![全局环境的可视化](../Images/4e21d01cbb22b2b2b5a55db2138468ee.png)'
- en: The `get_votes` function is also an object defined in the global environment.
    What’s unique, though, is that `get_votes` is also a kind of environment in itself!
    As you’ve seen, within the definition of `get_votes`, you can define other objects,
    like `votes` and `prompt`.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`get_votes`函数也是定义在全局环境中的对象。然而，独特的是，`get_votes`本身也是一种环境！正如你所看到的，在`get_votes`的定义中，你可以定义其他对象，如`votes`和`prompt`。'
- en: '![Visualization of `get_votes` environment](../Images/1b07a7392b73174e8a1ad91044068051.png)'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![`get_votes`环境的可视化](../Images/1b07a7392b73174e8a1ad91044068051.png)'
- en: The environment of `get_votes` is *not* the global environment. While writing
    code that operates in the global environment, objects in this environment are
    not accessible.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`get_votes`的环境**不是**全局环境。当编写在全局环境中运行的代码时，此环境中的对象不可访问。'
- en: The environment(s) in which an object is available is known as its “scope.”
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个对象可用的环境被称为其“作用域”。
- en: Checking Input
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查输入
- en: One of the challenges consistently facing programmers is the bad behavior of
    users. That is, we should expect, as programmers, that users will not always do
    what we want. For instance, what if a user provides a string of text instead of
    numbers for votes?
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 程序员一直面临的一个挑战是用户的糟糕行为。也就是说，作为程序员，我们应该预期用户不会总是做我们想要的事情。例如，如果用户为`votes`提供了文本字符串而不是数字怎么办？
- en: 'We can improve our program to catch incorrect values that are entered:'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以将程序改进以捕获输入的错误值：
- en: '[PRE5]'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Notice how `get_votes` will return a `0` if the value for `votes` is `NA`. Otherwise,
    `get_votes` will return the value provided by the user.
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到如果`votes`的值是`NA`，`get_votes`将返回`0`。否则，`get_votes`将返回用户提供的值。
- en: 'While this program works, it still provides warnings, which we may not want
    the user to see. We can suppress warnings as follows:'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虽然这个程序可以工作，但它仍然会提供警告，我们可能不希望用户看到。我们可以如下抑制警告：
- en: '[PRE6]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Notice how warnings are now suppressed when this code is run.
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到当运行此代码时，警告现在被抑制了。
- en: 'This program can be further improved by using `ifelse`. Consider the following:'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用`ifelse`，我们可以进一步改进这个程序。考虑以下：
- en: '[PRE7]'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Notice that the first value of `ifelse` is a logical expression to be tested.
    The second value, `0`, is what will be returned if the first value `is.na(votes)`
    evaluates to `TRUE`. Finally, the third value, `votes`, is provided if the first
    value evaluates to `FALSE`.
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到`ifelse`的第一个值是一个要测试的逻辑表达式。第二个值`0`是当第一个值`is.na(votes)`评估为`TRUE`时将返回的值。最后，第三个值`votes`是在第一个值评估为`FALSE`时提供的。
- en: We have now discovered our first fundamental ways of checking user input.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们现在已经发现了检查用户输入的第一种基本方法。
- en: 'As we did prior, we can suppress warnings:'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如同之前，我们可以抑制警告：
- en: '[PRE8]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Notice how warnings are suppressed.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到警告被抑制了。
- en: Loops
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 循环
- en: One significant improvement we may desire for our program is the ability to
    repeatedly prompt the user when they make an error.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可能希望对程序进行的一个显著改进是能够在用户出错时反复提示用户。
- en: To learn more about loops, let’s enlist the help of the CS50 Duck Debugger!
    Quack!
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要了解更多关于循环的信息，让我们请CS50 Duck Debugger来帮忙！Quack！
- en: 'Consider the following code:'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑以下代码：
- en: '[PRE9]'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Notice how this code will output quack three times. However, it’s quite inefficient!
    We are repeating the same line of code three times.
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到这段代码将输出“quack”三次。然而，它相当低效！我们重复了相同的代码行三次。
- en: 'We could attempt to improve this code using a *repeat loop* as follows:'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以尝试使用以下形式的**重复循环**来改进此代码：
- en: '[PRE10]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Notice how our duck quacks multiple times, but forever. The duck is going to
    get very tired!
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到我们的鸭子“quack”多次，但永远如此。鸭子会非常累的！
- en: One of the ways we can implement a loop is by utilizing `break` and `next`.
    Such a loop will repeat a number of times by using a counter.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们实现循环的一种方法是通过利用`break`和`next`。这样的循环将通过计数器重复一定次数。
- en: '[PRE11]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Notice how the value of `i` is set to `3`. Then each time a `quack!` occurs,
    `i` is reduced by a value of `1`. When `0` is reached, the loop will `break`.
    Otherwise (or `else`), this loop will continue with `next`.
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到`i`的值被设置为`3`。然后每次发生`quack!`时，`i`的值减少1。当达到`0`时，循环将`break`。否则（或`else`），这个循环将使用`next`继续。
- en: 'In the end, `next` is not required. The loop will automatically continue without
    the `next` statement. We can remove this statement as follows:'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，`next`是不必要的。循环将自动继续，无需`next`语句。我们可以如下移除此语句：
- en: '[PRE12]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Notice how the loop will break when `i` is equal to `0`. However, `next` has
    been removed. The loop will still function.
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意当`i`等于`0`时，循环将中断。然而，已经移除了`next`。循环仍然可以工作。
- en: 'Another type of loop at our disposal is called a *while loop*. Such a loop
    will continue as long as a certain condition has not been met. Consider the following
    code:'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可用的另一种循环类型称为*while循环*。这种循环将在满足特定条件之前继续。考虑以下代码：
- en: '[PRE13]'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Notice how this loop will run `while` the value of `i != 0` is true.
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意这个循环将一直运行，直到`i != 0`的值为真。
- en: 'Another type of loop is called a *for loop* that allows us to repeat based
    upon a list or vector of values:'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另一种类型的循环称为*for循环*，它允许我们根据列表或值向量重复操作：
- en: '[PRE14]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Notice how a `for` loop starts the value of `i` at `1`, running the code inside
    of it. Then, it will set the value of `i` to two and run. Finally, it will set
    `i` to `3` and run. Thus, the code within the loop runs three times.
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意`for`循环从`i`的值为`1`开始，运行其内部的代码。然后，它将`i`的值设置为`2`并运行。最后，它将`i`设置为`3`并运行。因此，循环内的代码运行了三次。
- en: We can simplify our code by counting `1`, `2`, and `3` using the range `1:3`
    (one through three).
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以通过使用范围`1:3`（一至三）来简化我们的代码，以计算`1`、`2`和`3`。
- en: '[PRE15]'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Notice how the code `i in 1:3` accomplishes the same task as the code presented
    in the prior example.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意代码`i in 1:3`如何完成与先前示例中相同的任务。
- en: Using Loops
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用循环
- en: 'We can use our newly-learned abilities in loops in our counting of votes for
    Mario and friends. Consider the following code that utilizes a repeat loop:'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以在对马里奥和他的朋友们计票时使用我们新学的循环能力。考虑以下使用重复循环的代码：
- en: '[PRE16]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Notice that the user will be reprompted until the value provided is not `NA`.
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意用户将一直被提示，直到提供的值不是`NA`。
- en: 'We can further improve our code as follows:'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以进一步改进我们的代码如下：
- en: '[PRE17]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Notice how the `return(votes)` clause is put in the place of `break`. The same
    functionality remains for this function, but the code is more brief.
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意`return(votes)`子句是如何替换`break`的。这个函数的功能保持不变，但代码更简洁。
- en: 'Now, using our knowledge of `for` loops, we can improve our code that is repeated
    for Mario and friends:'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在，利用我们对`for`循环的知识，我们可以改进对马里奥和他的朋友们重复的代码：
- en: '[PRE18]'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Notice how, instead of three separate lines to prompt the user for votes for
    each of the candidates, the `for` loop will run for the range of “Mario,” “Peach,”
    and “Bowser” to get the votes. The `paste0` statement adds the `:` character to
    each of the prompts.
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，与为每个候选人分别提示选票的三条单独的行不同，`for`循环将运行“马里奥”、“桃子”和“霸王龙”的范围以获取选票。`paste0`语句将冒号字符添加到每个提示中。
- en: 'As a final flourish, we can employ a loop to count the votes as we go:'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 作为最后的点缀，我们可以使用循环来边走边计票：
- en: '[PRE19]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Notice how the `total` number of votes is updated in each iteration of the `for`
    loop.
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意在`for`循环的每次迭代中，`total`选票数是如何更新的。
- en: Reflecting upon the above, you can see the fundamental programming power that
    loops provide you as a programmer.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反思上述内容，你可以看到循环为你作为程序员提供的根本编程力量。
- en: Using Functions and Loops
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用函数和循环
- en: Let’s return to a case that we discussed in a previous lecture, summing up candidates’
    votes in a table like the below.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们回到之前讨论的一个案例，像下面这样在表中汇总候选人的选票。
- en: '![Candidate votes table](../Images/8744023a53bd9ec9c3423505bd17def0.png)'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![候选人选票表](../Images/8744023a53bd9ec9c3423505bd17def0.png)'
- en: Let’s now use our new abilities in loops and functions to create a better program.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在，让我们使用我们在循环和函数中学习的新能力来创建一个更好的程序。
- en: 'Perhaps our first goal should be to sum up the votes. Consider the following
    code:'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 也许我们的第一个目标应该是统计选票。考虑以下代码：
- en: '[PRE20]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Notice how this `for` loop will iterate through each `candidate` presented in
    the `votes` data frame. Then the `sum` of the `votes` for the `candidate` will
    be stored in the `total_votes` vector. `total_votes <- c()` represents an empty
    vector that is later populated with data. `total_votes[candidate]` creates a new
    element within the vector `total_votes`, one for each candidate in each iteration
    of the loop.
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意这个`for`循环将遍历`votes`数据框中呈现的每个`candidate`。然后，`candidate`的`votes`总和将被存储在`total_votes`向量中。`total_votes
    <- c()`代表一个空向量，稍后将被数据填充。`total_votes[candidate]`在向量`total_votes`中创建一个新的元素，每次循环迭代中每个候选人都有一个。
- en: A second goal could be to sum the `method` by which each candidate received
    votes.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二个目标可能是按每个候选人收到的选票方式汇总。
- en: '[PRE21]'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Notice how this `for` loop iterates through each `method` in the `colnames`
    (or column names).
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意这个`for`循环如何遍历`colnames`（或列名）中的每个`method`。
- en: Applying Functions
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用函数
- en: The above program could be optimized further using a family of functions known
    as the `apply` functions.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上面的程序可以使用一组称为`apply`函数的函数进一步优化。
- en: The `apply` functions allow you to apply (i.e., run) a function across elements
    of a data structure. For example, the `apply` function can apply a function across
    all rows or columns in a table of data.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`apply`函数允许你将函数应用于数据结构中的元素（即运行）。例如，`apply`函数可以在数据表的所有行或列上应用函数。'
- en: 'In the case of the votes table, we can use `apply` as follows to get the `sum`
    of all the rows:'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在投票表的例子中，我们可以使用`apply`函数如下来获取所有行的`sum`：
- en: '[PRE22]'
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Notice how the `sum` function is applied to all of the rows using `MARGIN =
    1`. Had we put `MARGIN = 2`, the `sum` function would have been applied to all
    of the columns.
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意`sum`函数是如何使用`MARGIN = 1`应用于所有行的。如果我们把`MARGIN`设置为`2`，`sum`函数就会应用于所有列。
- en: 'We can sum each column as follows:'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以这样对每一列求和：
- en: '[PRE23]'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Notice how `MARGIN = 2`.
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意`MARGIN = 2`。
- en: Summing Up
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: In this lesson, you learned how to apply functions in R. Specifically, you learned…
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在本课中，你学习了如何在R中应用函数。具体来说，你学习了……
- en: Defining Functions
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义函数
- en: Scope
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 范围
- en: Checking Input
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查输入
- en: Loops
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 循环
- en: Using Loops
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用循环
- en: Using Functions and Loops
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用函数和循环
- en: Applying Functions
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用函数
- en: See you next time when we discuss how to clean up our data.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 次次再见，当我们讨论如何清理我们的数据时。
