- en: 哈佛 CS50-WEB ｜ 基于Python ／ JavaScript的Web编程(2020·完整版) - P14：L4- 数据库、SQL与集成 3 (用户管理)
    - ShowMeAI - BV1gL411x7NY
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 哈佛 CS50-WEB ｜ 基于Python ／ JavaScript的Web编程(2020·完整版) - P14：L4- 数据库、SQL与集成 3 (用户管理)
    - ShowMeAI - BV1gL411x7NY
- en: we know now to build a web page that，does just this but Django is built on。this
    idea that it doesn't want you the，programmer to have to repeat work that。other
    people have already done and this，process of trying to define models and。very
    quickly be able to create and edit，and manipulate models is so common the，Django
    has all。
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在知道如何构建一个网页，只做这件事，但Django是基于。这个理念，即它不希望你，程序员必须重复其他人已经做过的工作，而这个，试图定义模型的过程，以及非常快速地创建和编辑，和操作模型是如此普遍，Django已经提供了所有。
- en: already built for us an entire app that，is just designed for the manipulation
    of。these models and it's known as the，Django admin app and this is an app that。we've
    seen traces of already that if we，remember that URL spy file from inside。of our
    application we saw that we added，a path for our own app but there was。
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 已经为我们构建了一个专门用于操作。模型的完整应用程序，这被称为，Django管理应用程序，这个应用程序。我们已经看到了一些痕迹，如果我们，记得在我们的应用程序内部的URL配置文件，我们看到我们为自己的应用程序添加了，一个路径，但还有。
- en: already a path given to us by default。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_1.png)
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 已经为我们默认提供了一个路径。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_1.png)
- en: slash admin that takes us to the admin，app as well and so in order to use the。admin
    app we need to create an，administrative account inside of our。Django web application
    and the way to do，that is via the command line I can run。Python managed up I create
    super user，it's gonna ask me for my name I'll go。
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 斜杠管理也将我们带到管理，应用程序，因此，为了使用这个。管理应用程序，我们需要在我们的Django网络应用程序内部创建一个，管理账户，方法是通过命令行。我可以运行Python
    manage.py create superuser，它会问我我的名字，我会继续。
- en: ahead and type in my user name my email，address and it's also gonna ask for
    a。password I can just make up a password，that I would like to use retype it in。just
    to confirm it and now Django has，created a super user account for me in。this web
    application so that I using，these credentials have the ability to。
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我继续输入我的用户名和电子邮件，地址，它也会询问一个，密码，我可以随意设置一个我想使用的密码，再输入一遍。以确认现在Django为我在。这个网络应用程序中创建了一个超级用户账户，以便我使用，凭证拥有。
- en: visit the web interface for the admin。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_3.png)
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 访问管理的网页界面。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_3.png)
- en: app and actually manipulate some of，these underlying models so in order to。do
    this the first thing I need to do is，take my models and add those models to。the
    admin app so inside of models that，PI I have a class called airport and a。class
    called flight and if we look at，the files I have there's another file we。
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序并实际上操作这些，基础模型，因此为了。做到这一点，我需要做的第一件事是，获取我的模型并将这些模型添加到。管理应用程序，因此在模型的，`models.py`中，我有一个名为airport的类和一个名为flight的类，如果我们查看，我有的文件，还有另一个文件我们。
- en: haven't really looked at yet called，admin PI inside of my app and inside of。admin
    PI I'll first from my models，import flight and Airport and now I'm。going to say
    admin dot site register。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_5.png)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 还没有真正查看过的，名为`admin.py`的文件，在我的应用程序内部，在`admin.py`中，我首先从我的模型，导入flight和airport，现在我要说admin.site.register。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_5.png)
- en: Airport and admin site dot register，flight and what this is going to do is。it
    is going to tell Django's admin app，that I would like to use the admin app。to
    be able to manipulate airports and to，be able to manipulate flights as well。and
    so let's take a look at this admin，app and see how it actually works。
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的机场和管理网站点注册，航班和这个将要做的事情是。它将告诉Django的管理应用程序，我希望使用管理应用程序。来操作机场和航班。因此，让我们看看这个管理，应用程序，看看它实际上是如何工作的。
- en: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_7.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_7.png)'
- en: I can run Python manage PI run server，that will start up the web server I'll。know
    visit this URL instead of going to，slash flights I'll go to slash admin。and this
    opens up this django，administration app that's not written by。me Django has written
    this and it's，asking me to log in I'll go ahead and。
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以运行Python manage.py runserver，这将启动网络服务器。我会访问这个网址，而不是去，斜杠航班，我会去斜杠管理。这将打开这个Django，管理应用程序，这不是我写的。Django写的，它要求我登录，我将继续。
- en: log in using those credentials I used a，moment ago typing in my username and。password
    and what I get here is Django's，site administration interface built。forming by
    Jenga where I didn't need to，design this at all but importantly if we。notice down
    here I now have the ability，to add and manipulate airports and。
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 使用刚才的凭证登录，我输入了我的用户名和密码，我得到的是 Django 的站点管理界面。这个界面是由 Jenga 构建的，我完全不需要设计这个界面，但重要的是，如果我们注意到这里，我现在有能力添加和管理机场。
- en: flights via this web interfaces django，administrative interface so now using。this
    interface i have the ability to，manipulate the underlying database to。manipulate
    my models to add and modify，data that already exists so if I click。on airports
    for example I see here here，all of the airports that I've already。
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这个网页接口的 Django 管理界面来管理航班，所以现在使用这个界面我可以操作底层数据库，修改模型，添加和修改已经存在的数据。所以如果我点击机场，我在这里可以看到我已经。
- en: added to my database Tokyo Paris London，in New York and I can add a new one
    I。can say let's go ahead and add PVG which，is Shanghai and I can either save it。saving
    continue editing save and add，another I'm gonna add a couple so I'll。go ahead
    and save and add another let's，go ahead and add Istanbul Airport as，well let's
    add Moscow。
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 已经添加到我的数据库中，包括东京、巴黎、伦敦和纽约，我可以再添加一个新的机场，我可以说让我们添加 PVG，也就是上海，我可以选择保存、继续编辑或保存并添加另一个。我会添加几个，所以我将保存并添加另一个，让我们再添加伊斯坦布尔机场，再添加莫斯科。
- en: that's an airport tomb and maybe one，more will add Lima as well and I'll just。go
    ahead and click Save and now I've，added a whole bunch of airports all via。this
    web interface Jango was originally，created for like news organizations they。very
    quickly wanted to be able to post，articles and post new posts on their。
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个机场记录，可能还会再添加一个利马机场，我将点击保存，现在我通过这个网页接口添加了很多机场。Django 最初是为新闻机构创建的，他们很快想要发布文章和新帖子。
- en: website and it made it very easy by an，interface like this to very quickly just。say
    like here add a new article and，here's the content of the article to be。able to
    display on a page and now we've，been able to very quickly add new。airports to
    our website as well and so，if we want to add flights well we can go。
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 网站通过这样的界面让我们很容易地快速添加新文章，并展示文章内容在页面上，现在我们也能很快地将新机场添加到我们的网站，所以如果我们想添加航班，我们可以继续进行。
- en: ahead and go back home I'll click on，flights I see that I already have two。flights
    inside of my database I have New，York to London in New York to Paris I'll。add
    a new one it's letting me choose an，Origin destination and duration and。Gengo
    know is that the origin must be an，airport so it's going to give me the。
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 继续回到主页，我点击航班，我看到我的数据库中已经有两个航班：从纽约到伦敦和从纽约到巴黎。我将添加一个新的航班，它让我选择出发地、目的地和时长。而且出发地必须是一个机场，所以它将给我提供。
- en: opportunity to just choose an airport，where I can say ok Shanghai is the。origin
    the destination is going to be，Paris and the duration is going to be。like 760
    minutes for example so now，using Django's admin interface i've been。able to add
    a number of different，flights and a number of different。
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以选择一个机场，比如说上海是出发地，目的地是巴黎，时长大约是 760 分钟。例如，使用 Django 的管理界面，我已经能够添加多个不同的航班和多个不同的。
- en: airports and if I go back not to the，admin app but to my flights app the app。I
    wrote myself and go back to slash，flights now I actually see all of the。new flights
    that I have added to my，database via Django's admin interface I。added them to
    the admin interface and，now I see this flight from Shanghai to。
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我不回到管理应用程序，而是回到我自己编写的航班应用程序，回到 /flights，现在我可以看到通过 Django 的管理界面添加的所有新航班。我将它们添加到管理界面，现在我看到这个从上海到。
- en: Paris I see this flight from Paris to，New York as well and so now what I might。like
    to do is begin to add some more，pages to this web application make this。web application
    a little more，sophisticated but maybe giving me the。ability to like click on a
    particular，flight to view details about that flight。
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我看到从巴黎到纽约的航班，所以现在我想开始为这个网页应用程序添加更多页面，让这个网页应用程序更复杂，可能给我能力点击特定航班查看关于该航班的详细信息。
- en: what I'd like is for every flight to，have its own page not just slash flights。for
    all the fights but slash flights，slash one for flight ID one slash flight。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_9.png)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望每个航班都有自己的页面，不仅仅是 /flights 显示所有航班，而是 /flights/1 显示航班 ID 为 1 的航班。 ![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_9.png)
- en: slash to 482 so on and so forth what I，can do in order to do that is go back。into
    URL spy and create a new path we'll，create a path where I'm going to specify。a
    flight ID which would be an integer，when I do let's go ahead and load the。flight
    view whose name will be flight，and now I need to just go to view spy。
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 斜杠到 482，等等。我可以为此返回到 URL 间谍，创建一个新路径，我们将创建一个路径，我将在其中指定一个航班 ID，这将是一个整数。完成后，继续加载航班视图，其名称将为航班。现在我只需去视图间谍。
- en: and add a function called flight so I'll，go back go into view spy in addition
    to。an index function we'll define a flight，function that accepts as an argument
    a。flight ID so now what is this flight，function going to do well the first。thing
    I need was actually need to do is，actually get that flight I can say。
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 并添加一个叫航班的函数，所以我会返回到视图间谍，除了索引函数外，我们还将定义一个接受航班 ID 作为参数的航班函数。那么这个航班函数将要做什么呢？第一件事我实际上需要做的是，获取该航班。
- en: flight equals flight that objects get，get me the flight whose ID is equal to。flight
    ID for example we're，alternatively jangle also lets you say。PK instead of ID is
    much more generic，way of referencing the primary key for。whatever the primary
    key happens to be，called the PK in this case is just the。
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 航班等于航班，该对象获取我航班 ID 等于航班 ID 的航班，例如，或者说 PK，替代 ID，作为一种更通用的方式来引用主要键。无论主要键被称为什么，在这种情况下，PK
    只是。
- en: ID but then what I can do is render a，template like flight flight HTML and。pass
    as input to that the flight so，we're passing it this flight to flight。HTML and
    now I can create a template，create a new file called flight HTML。which is going
    to also extend flight，slash layout HTML using that same HTML。
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ID，但我能做的是渲染一个类似航班航班的 HTML 模板，并将航班作为输入传递给它，所以，我们把这个航班传递给航班 HTML。现在我可以创建一个模板，创建一个新的文件，叫做航班
    HTML。这个文件也将扩展航班/布局 HTML，使用相同的 HTML。
- en: layout and inside the body of the page，let's just say something like in big。we'll
    say flight flight ID and then，maybe an unordered list where。can say something
    like the origin is，flight origin the destination is flight。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_11.png)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 页面布局和主体内部，我们可以简单地说一些类似于大的内容。我们会提到航班航班 ID，然后，也许是一个无序列表。可以说起点是航班起点，目的地是航班目的地。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_11.png)
- en: destination and the duration is flight，duration so now I have a page that。displays
    flight information about any，particular flight and if I go ahead and。load not
    slash flights in my web browser，but slash flight slash one for example。well now
    I have information about flight，number one and slash flight / - gets me。
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 目的地和持续时间是航班持续时间。所以现在我有一个页面，显示关于任何特定航班的航班信息。如果我继续在我的网页浏览器中加载，而不是加载斜杠航班，而是斜杠航班/一，比如说。现在我有关于航班编号一的信息，而斜杠航班/-
    则让我得到。
- en: information about flight number two，query in for that particular flight then。printing
    on its origin destination and，duration now there's some error checking。that we
    probably should do here if I try，and access a flight that doesn't exist。something
    like flight 28 for example I'm，gonna get some sort of error that I does。
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 关于航班编号二的信息，查询该特定航班，然后打印它的起点、目的地和持续时间。现在有一些错误检查，我们可能应该在这里做一下。如果我尝试访问一个不存在的航班，比如航班
    28，我将会得到某种错误。
- en: not exist near flight matching query。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_13.png)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 不存在与航班匹配的查询。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_13.png)
- en: does not exist I might like to control，what happens in that situation a little。better
    so you might imagine adding some，additional error checking to handle。those cases
    as well but we'll leave it，at this just for now but now let's go。ahead and add
    the ability not only to，have flights that have airports。
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不存在，我可能想稍微控制一下这种情况会发生什么。你可能会想象添加一些额外的错误检查来处理这些情况，但现在我们就暂时先不管这一点。现在我们继续添加不仅仅是拥有机场的航班的功能。
- en: associated with them but let's also add，passengers to our flights as well to
    be。able to represent passengers that might，actually be on these flights - so I'll。go
    ahead and go back into model spy and，in model spy in addition to an airport。class
    and a flight class let me create a，new class called a passenger also going。
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 与它们相关联，但我们也来为航班添加乘客，以便能够表示可能实际在这些航班上的乘客 - 所以我将继续回到模型间谍，在模型间谍中，除了机场类和航班类，我还要创建一个新类，叫做乘客。
- en: to be a model and what property is does，a passenger have well passenger has
    a。first name which will go ahead and make，a model char field whose max length
    will。put at  sixty-four  and a last name max length，equals  sixty-four  and passengers
    also as we。described before they have a，many-to-many relationship with flights。
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 成为一个模型，乘客有什么属性呢？乘客有一个名字，我们将创建一个最大长度为六十四的字符字段，姓氏的最大长度也为六十四。乘客也正如我们之前描述的，他们与航班之间有一个多对多的关系。
- en: that a flight could have multiple，passengers a passenger could be on。multiple
    flights and ultimately we need，an additional table to keep track of。this but we
    can think a little bit more，abstractly here in django and just say。that every
    passenger has flights，associated with them which are a models。
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 一个航班可以有多个乘客，乘客可以在多个航班上，最终我们需要一个额外的表来跟踪这一点。但我们可以在Django中更抽象地思考，只需说每个乘客都有与之相关的航班，这些航班都是模型。
- en: dot many-to-many filled with flight so，every passenger could be associated with。many
    flights will say blank equals true，to allow the possibility that a。passenger has
    no flight maybe if they're，not registered for any flights at all。and we'll also
    give this a related name，of passengers meaning if I have a。
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 多对多字段与航班相关，因此每个乘客可以与多个航班关联。我们将设置blank=True，以允许乘客没有航班的可能性，或许如果他们没有注册任何航班。我们还将为此提供一个相关名称，命名为乘客，意味着如果我有一个乘客。
- en: passenger I can use the flights，attribute to access all of their flights。and
    likewise if I have a flight I can，use this passengers related name to。access all
    of the passengers who are on，that flight and we'll see how that'll be。useful in
    a moment to the string，representation of a passenger we'll just。
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 乘客，我可以使用航班属性来访问他们的所有航班。同样，如果我有一个航班，我可以使用这个乘客的相关名称来访问所有在该航班上的乘客，我们稍后会看到这会有多有用。乘客的字符串表示，我们将只是。
- en: go ahead and be their first name space，their last name which feels like a。reasonable
    way of representing a。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_15.png)
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是他们的名字和姓氏，这似乎是一个合理的表示方式。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_15.png)
- en: particular passenger and now I need to，apply these changes I need to say Python。Manish
    up I make migrations because I've，made new changes to my model I've。created a
    model passenger in particular，and now if I do Python managed up I。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_17.png)
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 特定乘客，现在我需要应用这些更改，我需要说Python。Manish，运行迁移因为我对我的模型进行了新的更改。我创建了一个特定的乘客模型，现在如果我运行Python管理，![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_17.png)
- en: migrate now I've applied those changes，to my actual database and if I go into。admin
    dot PI so we'll go into admin dot，PI and register not only flight an。airport but
    passenger admin that's like。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_19.png)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在迁移，我已将这些更改应用到我的实际数据库中，如果我进入admin.py，我们将进入admin.py，并注册航班、机场和乘客管理。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_19.png)
- en: register passenger then now via the，admin interface I can manipulate。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_21.png)
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 注册乘客，现在通过管理界面，我可以操作。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_21.png)
- en: passengers as well I can say Python man，in shop I run server to run my web。server
    go to my web servers admin view，by going to slash admin go down to。passengers
    and let's go ahead and add a，passenger where I can say all right。first name Harry
    last name Potter and，we'll go ahead and put him on flight one。
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我也可以说Python管理，运行服务器以运行我的网页服务器，通过访问斜杠admin进入我的网页服务器管理视图，进入乘客部分，让我们添加一个乘客，我可以说，好的，名字哈利，姓氏波特，我们将把他放在航班一上。
- en: and the flight three maybe he's on two，different flights for example and you。can
    hold down command or control to be，able to select multiple flights and。we'll go
    ahead and save that Harry，Potter has been added successfully and。let's add a couple
    of other passengers，will add Ron Weasley and we'll add。
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 航班三，可能他在两个不同的航班上，例如，你可以按住命令或控制键，以便选择多个航班。我们将继续保存，哈利·波特已成功添加。让我们再添加几个其他乘客，将添加罗恩·韦斯利。
- en: another will add Hermione Granger and。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_23.png)
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个将添加赫敏·格兰杰和。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_23.png)
- en: we'll add Ginny Weasley as well so we've，added a number of different passengers。that
    now all exist in Django's admin，interface and now what I'd like to do is。on the
    flight page display information，about which passengers happen to be on。any given
    flight so the way I might do，that is by going into view spy and on。
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还会添加**金妮·韦斯利**，所以我们添加了许多不同的乘客，它们现在都存在于Django的管理界面中。现在我想做的是在航班页面上显示关于在任何给定航班上乘客的信息，所以我可能会这样做，通过进入视图文件并在。
- en: the flight page in addition to giving，access，to passengers so passengers this。template
    is going to get access to and，we get passengers by saying flight dot。passengers
    dot all and the reason we can，do this is again because passengers is。that related
    name it is our way of，taking a flight and getting all of the。
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 航班页面除了提供给乘客访问权限外，这个模板将会获得乘客的信息，我们可以通过说flight.passengers.all来获取乘客，而我们之所以能够这样做，是因为乘客是相关名称，它是我们获取航班及其上所有乘客的方式。
- en: passengers that happen to be on that，flight，and so now inside of flight dot
    HTML I。can add something like let's add on h2，called passengers we're here I'm
    going。to loop for passenger in passengers go，ahead and display that passenger
    just。print out that passenger inside of a，list item and in Django I can say if
    the。
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 因此现在在flight.html中，我可以添加一些东西，比如添加一个h2，叫做乘客，我们在这里，我将循环遍历乘客，显示该乘客。将该乘客打印在一个列表项中，在Django中我可以说如果。
- en: list is empty let's just have a list，item that says no passengers meaning。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_25.png)
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 列表为空，我们只需要一个列表项，写着没有乘客的意思。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_25.png)
- en: nobody is currently on this flight so，now my web server is still running I can。go
    back to slash flights here all of the，flights and if I go to slash flight。slash
    one I now see that I'm flight one，Harry Potter is a passenger on that。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_27.png)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 目前没有人乘坐这趟航班，所以，现在我的网络服务器仍在运行。我可以返回到斜杠航班，这里是所有的航班，如果我去斜杠航班，斜杠一，我现在看到的是航班一，**哈利·波特**是这个航班的乘客。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_27.png)
- en: flight but if I go to flight 2 all right，no passengers are on that flight either。and
    now it's been a little annoying that，I've had to do everything by using the。URL
    here to be able to go back and forth，between pages I could link to those。pages
    if I want to and the way I might，do that is let's on the flight page add。
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 但是如果我去航班2，好的，那个航班上也没有乘客。现在有点烦人的是，我不得不通过使用URL来来回回，这样才能在页面之间导航。如果我想的话，我可以链接到那些页面，我可能会这样做，让我们在航班页面上添加。
- en: a link that goes to the URL index that，says something like back to flight list。maybe
    so here is now a link that takes，me to the index view and likewise I can，go into
    index。html and for each of these，list items each of these list items is。really
    going to be a link that links to，it's a URL to a particular flight and。
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 一个链接，指向一个URL索引，上面写着类似“返回航班列表”的内容。因此，现在这里有一个链接可以带我到索引视图，同样，我可以进入index.html，对于每一个列表项，这些列表项实际上都会是一个链接，指向一个特定航班的URL。
- en: the flight route takes as a parameter a，flight ID and so inside this URL。substitution
    here I can specify use，flight ID as the ID of the flight that I。would like to
    use here and so now I've，put every single flight inside of a link。that takes me
    to the flight route but，because the flight route requires as an。
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 航班路线作为参数需要一个航班ID，因此在这个URL替换中，我可以指定使用航班ID作为我想使用的航班的ID，因此现在我把每一个航班都放在一个链接里，这个链接可以带我到航班路线，但因为航班路线需要一个。
- en: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_29.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_29.png)'
- en: argument the flight ID I can specify the，flight ID here and so now if I go back。to
    slash flights I now see a list of，flights where every flight is in fact a。link
    that can take me somewhere else and，so now I can click on any one of those。links
    like New York to Paris and that，takes me to the flight page I can click。
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 参数航班ID，我可以在这里指定航班ID，因此现在如果我返回到斜杠航班，我现在看到一份航班列表，每个航班实际上都是一个可以带我去其他地方的链接，因此现在我可以点击任何一个链接，比如从纽约到巴黎，这会带我到航班页面，我可以点击。
- en: back to flight list that takes me back，to the flight list click on another。flight
    and go to that flight as well so，I've now been able to come up with this。way of
    linking these pages together by，having links in each of the various。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_31.png)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 返回航班列表，这会带我返回航班列表，点击另一个航班并转到那个航班，所以我现在能够通过在各个页面中添加链接的方式，将这些页面连接在一起。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_31.png)
- en: different pages that take me to some，other route as well and so now what I。might
    like to do is in addition to，displaying all the passengers on any。particular flight
    also give myself the，ability to add passengers to a flight as。well which feels
    like a reasonable thing，that I might want to do inside of this。
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 不同的页面也将带我到其他路由。因此，现在我可能想要做的是，除了显示任何特定航班上的所有乘客外，还给自己添加乘客到航班的能力，这似乎是我可能想在其中做的合理事情。
- en: web application and so how can I go，about doing that well in order to do。that
    I'm going to need some new route，that lets me book a flight for a。particular passenger
    and so I'll go，ahead and go back to URL stop by and。inside of URLs PI I'll add
    a new path，that will be in flight ID slash book an。
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: web 应用程序，所以我该如何进行呢？为了做到这一点，我需要一些新的路由，让我可以为特定乘客预定航班。因此，我将继续回到 URL，并在 URL 的 API
    内添加一个新的路径，这将是航班 ID / 预订一个。
- en: in-flight ID slash book is going to let，me book a flight for this particular。flight
    ID for flight 1 or flight 2 or，flight 3 or so forth when I do we'll go。ahead and
    go to the book view and we'll，name that book and so now I need to。implement the
    book view so how is this，view going to work I'm going to define a。
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在航班 ID / 预订将让我为此特定航班 ID 预订航班，例如航班 1、航班 2 或航班 3，当我执行时，我们将继续转到预订视图，并将其命名为 book，因此现在我需要实现预订视图，这个视图将如何工作，我将定义一个。
- en: function called book that is going to，take as its argument not only the。request
    but also a flight ID the first，thing as with before is I want to get。the flight
    ID but remember from before，that there are multiple ways that I can。request a
    web page I can request a web，page via the get request method which。
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 函数，名为 book，它将不仅接受请求作为参数，还接受航班 ID。首先，如之前所述，我想获取航班 ID，但记住之前提到的，我可以通过多种方式请求网页，我可以通过
    GET 请求方法请求网页。
- en: means I would just like to get this page，or I can request a method via post。meaning
    I would like to send data to the，page and generally speaking anytime you。want
    to manipulate the state of，something especially manipulating our。database that
    should be inside of a post，request I'm submitting some form some。
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着我只是想获取此页面，或者我可以通过 POST 请求方法请求一个。这意味着我想将数据发送到页面，一般来说，每当你想要操作某个事物的状态，尤其是操作我们的数据库时，这应该在
    POST 请求中，我提交一些表单。
- en: data and in response to that post，submission，you should manipulate what's going
    on。inside of the database so we're gonna，check when this book route is called，upon
    if requests meth。this post then we want to perform some，sort of action the flight
    in question is。just going to be flight dot objects get，get the flight whose primary
    key is that。
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 数据以及对该 POST 提交的响应，你应该操作数据库中的内容。因此，当调用此预订路由时，我们会检查，如果请求方法是 POST，那么我们想执行某种操作，相关的航班将是
    flight.objects.get，获取主键为该航班的航班。
- en: flight ID and then what I'd also like to，do is associated with the forum when。someone
    submits this form to like book a，new passenger on the flight they should。tell
    me what the ID is of the passenger，like what passenger should I book on。this flight
    because those are the two，pieces of information you need to know。
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 航班 ID，然后我还想与表单关联，当有人提交此表单以预订新乘客时，他们应该告诉我乘客的 ID，也就是我应该在这趟航班上预订哪个乘客，因为这是你需要知道的两条信息。
- en: in order to actually book a flight you，need the flight and the passenger。information
    so let's assume for now that，the information is going to be in。request dot post
    and then in squ*re，brackets passenger what this means is。that the data about which
    passenger ID，we want to register on this flight is。
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实际预订航班，你需要航班和乘客的信息，所以现在假设信息将在 request.post 中，然后在方括号中是 passenger。这意味着关于我们想要在此航班上注册的乘客
    ID 的数据是。
- en: going to be passed in via a form with an，input field whose name is passenger
    the。name on any particular input field，dictates what name we get receipt what。is
    received when a route like this book，route is able to process the request。from
    the user so we'll go ahead and take，that information and because by default。
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 将通过一个输入字段传递，该字段的名称为 passenger。在任何特定的输入字段上的名称决定了我们收到的内容是什么。当像这样的预订路由能够处理来自用户的请求时，我们将继续获取该信息，因为默认情况下。
- en: this might be a string let's go ahead，and convert it into an integer just to。make
    sure we're dealing with an integer，and let me say that the passenger in。question
    is going to be passenger dot，objects get PK equals this whole thing。so now what
    I've done is if the request，method is post meaning someone submitted。
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能是一个字符串，让我们继续并将其转换为整数，以确保我们在处理整数。让我说这个乘客将会是乘客对象，通过主键获取，这整个过程。现在我所做的是，如果请求方法是POST，意味着有人提交了。
- en: this form via the post request method，I'm first saying flight start objects。get
    to get a particular flight get me，the flight with that flight ID and then。I'm
    getting a passenger which passenger，am I getting the one whose PK their。primary
    key otherwise known as ID is，equal to whatever was submitted via this。
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 通过POST请求方法，这里我首先说航班对象获取，获取特定航班，给我那个航班ID的航班。然后我获取一个乘客，我正在获取哪个乘客，他们的主键，也就是ID，等于通过这个提交的内容。
- en: post form with a name of passenger and，we haven't yet created that form but。we'll
    do so in just a moment now，ultimately we'll want to add some more。error checking
    to this as well like what，if someone requests a passenger that。doesn't exist or
    a flight that doesn't，exist either so there's definitely some。
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 提交表单的名称是乘客，我们还没有创建那个表单，但我们马上就会做到。最终，我们希望在这方面添加更多的错误检查，比如说，如果有人请求一个不存在的乘客或者一个不存在的航班，这肯定会有一些问题。
- en: error checking that we probably should，be doing here but for simplicity let's。just
    assume for now that we're able to，get a flight and get a passenger well。how do
    we access a passenger flights，I can just say passenger dot flights。and in order
    in order to add a new item，to some set like flights。
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能应该在这里进行错误检查，但为了简单起见，暂时假设我们能够获取航班并获取乘客。那么我们如何访问乘客的航班呢？我可以直接说乘客的航班。为了向一些集合中添加新项，比如航班。
- en: I can just say passenger flights not add，flight and this will do the equivalent。of
    adding a new row into a table of，keeping track that the passenger is on。that flight
    but the nice thing about，Django's abstractions is that I don't。have to worry about
    those underlying，details I don't have to worry about what。
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以直接说乘客的航班不添加航班，这将相当于向一个表中添加新行，以记录该乘客在该航班上。但Django的抽象优点在于我不必担心那些底层的细节。
- en: the structures of the tables are I can，think in a much higher level and just。say
    take this passenger take their set，of flights and go ahead and add a new。flight
    to that set of flights and when，all that's said and done what I probably。want
    to do is return some sort of，redirect that redirects the user back to。
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 表的结构我可以在更高的层面思考，只需说拿这个乘客，带上他们的航班集合，并继续向那个航班集合添加一个新航班。当这一切完成后，我可能想要做的是返回某种重定向，将用户重定向回。
- en: the flight page so we'll go ahead and，return an HTTP response redirect what。URL
    would I like to take them to well，I'd like to take them to the flight。route and
    reverse again takes the name，of a particular view and gets me what。the URL is
    and we saw that last time and，the flight route takes an argument so I。
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 航班页面，所以我们将继续并返回一个HTTP响应来重定向。那么，我希望把他们带到哪个URL呢？我希望把他们带到航班路由，而反转又获取了特定视图的名称，并告诉我这个URL是什么，我们上次看到过，航班路由接受一个参数。
- en: need to pass as an argument the flights，ID so I need to provide it to the flight。route
    what the flights ID is structured，as a tuple and that is going to redirect。me
    back to the flight route so that I，can see that flight page again and what。I need
    to add up at the top here is from，Django HTTP import HTTP response。
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 需要作为参数传递航班ID，所以我需要将其提供给航班路由，航班ID被结构化为一个元组，这将把我重定向回航班路由，以便我可以再次查看航班页面。而我需要在顶部添加的是，从Django
    HTTP导入HTTP响应。
- en: redirect in addition to from Django URLs，an import reverse and so those all
    need。to add as well so that I can redirect，the user back to the flight page after。they're
    done submitting the form and，reverse takes the name of a particular。view as defined
    in URLs depay something，like index or flight or book and gets me。
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 除了Django的URLs外，还需要从中导入反转，这些都需要添加，以便我可以在提交表单后将用户重定向回航班页面。反转接受在URLs中定义的特定视图的名称，比如index或flight或book，并给我这个视图。
- en: what the actual URL path should be and，as we talked about last time that's。helpful
    so that I don't have to hard，code URLs into my Django web application。I can just
    reference URLs by their name，and if ever I need to change a URL I can。just change
    it in one place in URLs dot，PI and that change is going to reflect。
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 实际的 URL 路径应该是什么，我们上次讨论过，这样我就不必在我的 Django Web 应用程序中硬编码 URL。我可以通过名称引用 URL，如果我需要更改
    URL，我可以只在 URLs.py 中更改一次，而该更改将反映。
- en: everywhere else as well so now the next，thing I need to do is actually create。this
    form that what I have so far is，just a function called book。waiting for a post
    request to be made to，it and when a post request is made to it。then we're going
    to go ahead and submit，this form and go ahead and add the。
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 所以现在我需要做的下一件事是实际创建。这个表单到目前为止，我只有一个名为 book 的函数，等待发出 post 请求，当对它发出 post 请求时，我们将继续提交，这个表单并继续添加。
- en: flight for this particular passenger but，what I'd like to do now is actually
    add。that form so I'll go back into templates，go into flight HTML and what I'd
    like to。add here is a form I'll go ahead and，label it with an h2 called add passenger。and
    we'll create a form whose action is，going to be URL of book so we're gonna。
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个特定乘客的航班，但我现在想做的是实际添加。那个表单，所以我将回到模板，进入航班 HTML，我想在这里添加一个表单，我将其标记为一个 h2，称为添加乘客。我们将创建一个表单，其操作将是，预订的
    URL，所以我们要。
- en: go to the book route and again if we，recall the book route in URL stop by the。route
    with name book this view requires，as a parameter some flight ID so I need。to provide
    the flight ID as an argument，for what flight I'm booking the。passenger on and
    it just happens to be，flight dot ID because this template has。
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 转到预订路由，再次如果我们回忆 URL 中的预订路由，通过名称为 book 的路由，这个视图需要作为参数的一些航班 ID，所以我需要提供航班 ID，作为我为乘客预订的航班的参数，正好是
    flight.ID，因为这个模板有。
- en: access to a variable called flight the，method of this submission is again going。to
    be post and recall from before that，whenever I have a form in Django I need。to
    give it the CSRF token just for，security to make sure that Django knows。it's really
    this application that is，submitting this form we'll go ahead and。
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 访问一个名为 flight 的变量，此提交的方法同样是 post，回忆之前提到的，每当我在 Django 中有一个表单时，我需要。提供 CSRF 令牌，仅出于安全考虑，以确保
    Django 知道，确实是这个应用程序在提交这个表单，我们将继续。
- en: add a drop-down list which you can，create an HTML using a select field the。name
    of this select field is going to be，passenger and the reason for that is。inside
    of you stop I when I get the，passenger I'm looking for inside the。post data inside
    of request stop post，for a field whose name is passenger and。
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个下拉列表，你可以使用选择字段在 HTML 中创建。这个选择字段的名称将是乘客，原因是。当我在请求的 post 数据中获取乘客时，我要寻找的是一个名为乘客的字段。
- en: so that is what I would like the name of，this drop-down to be and inside of
    a。select drop-down we have a whole bunch，of options options that we can choose。from
    and there's going to be one option，for everyone who isn't a passenger on。this
    flight and so how do I get everyone，who isn't a passenger on the flight well。
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这就是我希望这个下拉框的名称，而在一个选择下拉框中，我们有一整堆，供我们选择的选项。而且将会有一个选项，供每一个不是航班乘客的人。那么我该如何获取所有不是航班乘客的人呢？
- en: it seems that right now the flight page，only has access to actual passengers
    and。doesn't yet have access to people that，are not passengers on the flight so
    it。sounds like I need to add some，additional context to the stemplot。additional
    information that we want，access to so I'll go ahead and give this。
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 目前航班页面似乎只访问实际乘客，并且还没有访问不在航班上的人。因此，听起来我需要向 stemplot 添加一些额外的上下文。我们想要访问的附加信息，所以我将继续给这个。
- en: flight access to additional information，that will call like non passengers for。people
    that are not on the flight and，how do I get non passengers well just，filter。to
    only get passengers that match a，particular query there's also a way in。Jango
    to say passenger objects dot，exclude to say exclude passengers that。
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 航班访问额外的信息，我们将调用不在航班上的人，如何获取非乘客呢，只需过滤。仅获取与特定查询匹配的乘客对象，在 Jango 中也有一种方法，可以说乘客对象.exclude，以排除乘客。
- en: satisfy a particular query so I want to，exclude passengers who among their。flights
    have this as one of their，flights and so what does this actually。mean well it
    means that when I render，flight dot HTML there's a couple pieces。of information
    that it should have it，needs to know what flight is being。
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 满足特定查询，因此我想排除那些在他们的航班中包含这个航班的乘客，那么这实际上意味着什么呢？它意味着当我渲染flight dot HTML时，应该有几条信息，它需要知道正在进行的是哪个航班。
- en: rendered it needs to know who is on the，flight who are the passengers but if
    I。want a drop-down where I can choose from，all the people who aren't already on
    the。flight like I would like to register you，for this flight well I also need
    all of。the non passengers passengers except，excluding the ones who are already
    on。
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 渲染时需要知道谁在航班上，谁是乘客，但如果我想要一个下拉菜单，可以从所有未在航班上的人中选择，比如我想为你注册这个航班，我也需要所有的非乘客，除了已经在航班上的人。
- en: the flight and get me all of them is，what that dot all is ultimately saying。and
    so using that I now have access to，this variable called non passengers that。I
    can use as I'm constructing this page，so back on flight HTML I can say for。every
    passenger in non passengers let me，create a option that I can choose from。
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 获取所有这些的点，最终就是在说的内容。因此，利用这个我现在有一个变量叫做非乘客，在构建此页面时可以使用。因此在航班HTML中，我可以说对于每个非乘客，允许我创建一个可供选择的选项。
- en: and the options value is going to be the，passengers ID because ultimately when
    I。submit the form what I care about，getting is what is the ID of this。passenger
    that I've chosen from this，drop-down but of course the user who's。looking at this
    page they don't want to，see people's IDs they want to see。
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 选项的值将是乘客的ID，因为最终在我提交表单时，我关心的是我从下拉菜单中选择的这个乘客的ID，但当然，查看此页面的用户不想看到人们的ID，他们想看到。
- en: people's names so inside of the option，tag we'll go ahead and just print out。the
    passengers name and we'll see in a，moment what all of this actually looks。like
    in terms of HTML so now that I've，created this form I'll also need at the。bottom
    to add an input whose type is，submit to let myself submit this form to。
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 人们的名字，因此在选项标签内部，我们将直接打印出乘客的名字，稍后我们会看到这一切在HTML中实际上是什么样子。现在我已经创建了这个表单，底部还需要添加一个类型为提交的输入，以便让我提交这个表单。
- en: let's now try running this application，it looks like there's a slight error。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_33.png)
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们尝试运行这个应用程序，似乎有一个小错误。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_33.png)
- en: where I said view book instead of views，book views is the name of the module。since
    it's in a file called view spy and，now it looks like my server is running。ok I
    can go back to slash flights let me，get one of the flights like New York to。London
    flight number one and the right。
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我说的是查看预订而不是查看，预订视图是模块的名称，因为它在一个叫做view spy的文件中，现在看起来我的服务器运行正常。我可以返回到斜杠航班，让我获取一个航班，比如从纽约到伦敦的航班号一和正确。
- en: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_35.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_35.png)'
- en: name error named passenger is not，defined this is how Django renders to me。errors
    that are occurring and I Python，code looks like it just means。inside of used-up
    pine I'm referencing。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_37.png)
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 名称错误，命名的乘客未定义，这是Django呈现给我的。发生的错误以及我的Python代码看起来只是意味着。我在用完的pine内部引用。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_37.png)
- en: passenger but I never imported it so up，at the top I'll go ahead an import。passenger
    as well now it seems on my web，applications working ok so now hopefully，information。I
    see passengers and I also down at the，bottom now see an ADD passenger section。with
    a drop down list where I can click，on it and see all right here the three。
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 乘客但我从未导入它，因此在顶部我会导入乘客，现在我的网络应用似乎运行正常，希望有信息。我看到乘客，而且我现在在底部看到一个添加乘客的部分，带有一个下拉列表，可以点击并查看这三个人。
- en: people that are not already on this，flight and so if I want to add like。Ginny
    Weasley to this flight I can click，Ginny Weasley，click Submit and that submits
    the form。and I'm redirected back to the same，flight page now Harry and Ginny are
    both。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_39.png)
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 人们如果不在此航班上，因此如果我想将像Ginny Weasley添加到此航班，我可以点击Ginny Weasley，点击提交，这样就提交了表单。我被重定向回同一航班页面，现在Harry和Ginny都在。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_39.png)
- en: on the flight and then the add passenger，list I see Ron and Hermione。that's
    the options for me there and so，using Janos models I've been able to。very quickly
    build up a reasonably，sophisticated application an application。that has models
    that displays that，information to me and lets me manipulate。
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在航班上，然后在添加乘客列表中，我看到了Ron和Hermione，这就是我的选择，因此，利用Jano的模型，我已经能够非常快速地构建一个相对复杂的应用程序，一个能够向我展示这些信息并让我进行操作的应用程序。
- en: that data and that data is ultimately，stored inside of a sequel database and。one
    of the big powers of Jango that it，really gives to me is this admin。interface
    that I ordinarily might have，had to spend a lot of time designing a。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_41.png)
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据最终存储在一个sequel数据库中，Jango的一个重要优势就是，它为我提供了这个管理界面，通常我可能需要花很多时间来设计一个。
- en: web interface that just lets me do，things like take some person and go。ahead
    and update like what is their name，what flights are they on and the ability。to
    very quickly add and delete and edit，the models is something that in a web。application
    could take quite a lot of，time to be able to build from scratch。
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 这个网络界面让我能够做一些事情，比如更新某个人的信息，例如他们的姓名、他们搭乘的航班，快速添加、删除和编辑模型，这在一个网络应用程序中从头开始构建可能需要相当多的时间。
- en: but Jango very fortunately gives all of，that right to me and this admin。interface
    even though it is designed by，Jango it's very customizable in terms of。things
    that I can do on this admin，interface if I want to manipulate it in。certain ways
    and in order to add，additional features to it as well so。
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 但幸运的是，Jango将这一切直接提供给我，尽管这个管理界面是由Jango设计的，但在我可以在这个管理界面上进行的操作方面是非常可定制的。
- en: we'll see a couple brief examples of，this if I go into admin dot PI here is。my
    configuration for jenga's admin，interface and I can say I would like to。configure
    the admin interface in a，particular way that in a flight for。example by default
    all I saw was like，the flights origin and destination if I。
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我进入admin.dot PI，这里是我为jenga的管理界面配置的内容，我可以说我想以特定的方式配置管理界面，例如在航班中，默认情况下我只看到航班的起点和终点。
- en: want to be able to see more information，about a flight I can say go ahead and。give
    me a class called flight admin，which is going to be a subclass of model。admin
    where I can specify any particular，settings that I want to apply to how the，flight
    ad。Paige is displayed so I can and all this，is documented on jenga's website and
    you。
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 想要查看更多关于航班的信息，我可以说继续，并给我一个名为flight admin的类，它将是model.admin的子类，在这里我可以指定任何特定的设置，以应用于航班ad.Paige的显示，这一切都记录在jenga的网站上。
- en: just have to read it to be able to know，what configuration options are available。to
    you but I can say in the list display，when you list all the flights and。display
    them all to me what fields，should I have access to we'll go ahead。and show me
    something like the origin，and the destination and the duration and。
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 只需要阅读就能知道有哪些配置选项可供你使用，但我可以在列表显示中，列出所有航班并显示给我，我应该访问哪些字段，像起点、终点和持续时间等信息。
- en: maybe also show me the ID for example so，I want to see all of this information。when
    you load a flight and when I，register the flight I'll say register。this flight
    but use the flight admin，settings when you do so so I can specify。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_43.png)
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 也许还想让我看到ID，因此我想在加载航班时看到所有这些信息，当我注册航班时，我会说注册这个航班，但在这样做时使用flight admin的设置。
- en: I would like to use these particular，settings when you view the admin。interface
    and so now if I go back and go，ahead and click on flights then now in。this list
    display whereas before I only，saw IDs and origins and destinations now。I can configure
    it to show me all of the，IDS and origins and destinations and。
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望在查看管理界面时使用这些特定的设置，因此现在如果我返回并继续点击航班，那么在这个列表显示中，以前我只看到ID和起点、终点，而现在我可以配置它以显示所有的ID和起点、终点。
- en: durations as well I've been able to，configure this display to work the way I。would
    like it to and there are other。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_45.png)
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我已经能够配置这个显示，以我想要的方式工作，还有其他的。
- en: configurations you can do as well one，that I quite like to use is if I want
    to。update my passenger admin so when I'm，editing a passenger you can have a。special
    way of manipulating many-to-many，relationships inside of an attribute。called filter
    horizontal and if I use a，horizontal filter on flights this will。
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以进行的配置也有很多，我比较喜欢使用的一种是，如果我想更新我的乘客管理界面，当我编辑乘客时，可以以特殊的方式操纵多对多关系，使用一个名为filter
    horizontal的属性。如果我在航班上使用水平过滤器，这将。
- en: just make it a little bit nicer for，manipulating the flights that a。passenger
    is on and again the specific。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_47.png)
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 只是让操作乘客所搭乘航班的界面变得更好看一些，再次提到具体的。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_47.png)
- en: syntax of this not as important as the，idea that these are all just。configurable
    settings that Django has，documented that you can look at to see。how to configure
    the admin interface to，work exactly the way you want it to work。and so now if
    I go back home and go to，passengers and maybe click on a。
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 语法并不是最重要的，关键是这些都是Django记录的可配置设置，你可以查看如何配置管理界面，使其完全按照你想要的方式工作。所以现在如果我回到首页，去乘客那儿，或许点击一下。
- en: passenger like Harry Potter I now see，this horizontal filter which is a very。nice
    way of being able to manipulate，flights that the person is on I see on。the left
    a list of their available，flights that I could add them to on the。right a list
    of their chosen flights，flights that they're already on and it。
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 乘客像哈利·波特，现在我看到这个水平过滤器，这是一种非常好的方式来操纵乘客所搭乘的航班，我在左侧看到他们可添加的航班列表，在右侧看到他们已经选择的航班。
- en: becomes very easy for me to just take a，flight and double click on it to move
    it。from an available flight to a flight，that they're on and vice versa。just very
    quickly being able to control。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_49.png)
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我只需双击一个航班，就能轻松地将其从可用航班移到他们所搭乘的航班，反之亦然。能够快速控制。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_49.png)
- en: and manipulate these models and this is，all stuff that Django just gives to
    you。right out of the box so Jane Doe now has，given us a lot of features the ability，to
    represent。models very succinctly a migration，method for being able to very quickly。apply
    those changes to our database and，the last thing we'll take a look at is。
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 并且操纵这些模型，这些都是Django开箱即用提供的功能。所以，现在简·多给了我们很多特性，能够非常简洁地表示模型，迁移方法能够快速地将这些更改应用到我们的数据库，最后我们将关注的是。
- en: this idea of authentication then on many，websites we want some method of。authentication
    some ability for users to，be able to log in and log out for Django。to remember
    who a particular user，happens to be and what we're going to do。now is introduce
    an application that，lets us interact with this。
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这个认证的想法在许多网站上，我们需要某种认证方法，给用户提供登录和登出的能力，让Django记住特定用户的身份。我们现在要做的是引入一个可以与此互动的应用。
- en: authentication method because Django has，a whole bunch of authentication features。built
    right into the framework that we，can take advantage over so that we don't。need
    to rewrite all the logic for how do，you log someone in and what does it mean。to
    represent the user Django has done a，whole lot of that for us so we'll go。
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 认证方法，因为Django框架内置了一系列认证功能，我们可以利用这些功能，这样就不需要重写登录逻辑，以及如何表示用户。Django为我们做了很多工作，所以我们将。
- en: ahead and create an application to do，that now alright so let's go back into。my
    terminal now and now I have this，airline project inside of which is one。app called
    flights and I'd like to now，create another app that's going to。maintain users
    inside of this，Python，managed up I start app users should just。
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 继续创建一个应用程序来实现这一点，好吧，所以让我们回到我的终端，现在我有这个航空公司项目，其中有一个名为flights的应用，我现在想创建另一个应用来维护用户。
- en: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_51.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_51.png)'
- en: be an app that's going to allow me to，represent users as if before when I。create
    a new application I'll need to go，into settings tap I add users as one of。the
    installed apps inside of this，project and I'll go into URLs dot pi to。say I'd
    also like when I go to like，users will go ahead and include user is。
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这将是一个允许我表示用户的应用，就像之前一样，当我创建一个新应用时，我需要进入设置，添加用户作为这个项目中已安装的应用之一，然后我会进入URLs.py，表示我还希望在访问用户时包含用户。
- en: not URLs so all the URLs that are，associated with my users application now。I'll
    need to actually create those URLs，so I'll go ahead and go down into my。users
    application create a new file，called URLs by inside of which is the。same as what
    we've normally seen inside，of these URLs files I need to import。
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 不是URL，所以所有与我的用户应用程序关联的URL，现在我需要实际创建这些URL，因此我会继续进入我的用户应用程序，创建一个新文件，名为URLs，其中的内容与我们通常在这些URLs文件中看到的相同，我需要导入。
- en: path import my view ism and then define，some URL patterns where here what I'd。like
    to do is define one path that takes，me two views index and we'll call this。one
    index then I'll create another path，that takes me to login call the login。view
    and the name will be login and，we'll have another path called logout。
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 路径导入我的视图并定义一些URL模式，这里我想做的是定义一个路径，将我带到视图index，我们将称之为index，然后我会创建另一个路径，将我带到login，称为login
    view，名称将是login，我们将有另一个路径称为logout。
- en: for a function called logout view that，will be associated with it so will。effectively
    have three different routes，one main index route that's just going，to display
    in。Nation about the currently signed end，user one route for logging someone in
    a。forum that will display the place where，they can type in a username and password。
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个名为logout view的函数，将与之关联，因此我们将有效地有三个不同的路由，一个主index路由将显示当前登录用户的信息，一个路由用于登录某人，一个表单将显示他们可以输入用户名和密码的地方。
- en: to log in and then one route to allow，users to be able to log out from this。application
    as well so let's go ahead，now and actually write these functions。we need one function
    called index one，function called login view one function。called log out view so
    I'll go into view，spy and we'll start with index and so。
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 用于登录，然后一个路由允许用户能够从此应用程序注销，所以现在让我们继续并实际编写这些函数。我们需要一个名为index的函数，一个名为login view的函数和一个名为log
    out view的函数，所以我将进入views.py并从index开始。
- en: what does the index function need to do，it's going to display information about。the
    currently signed in user that I sign，in to this website and then I'm。presented
    with the index page because we，think about this programmatically we。first need
    to think about what should，happen if someone tries to access this。
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: index函数需要做什么？它将显示有关当前登录用户的信息，我登录到这个网站后，就会呈现出index页面，因为我们从程序的角度考虑，我们首先需要考虑如果有人尝试访问这个。
- en: page but they're not authenticated how，would we even find that out and what
    do。we do in that situation well let's say，if not request dot user dot is。authenticated
    the request object that，gets passed in as part of the request to。every user in
    Django automatically has a，user attribute associated with it and。
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 页面但他们没有认证，我们如何才能发现这一点？在这种情况下我们该怎么办？假设，如果请求对象的`user.is_authenticated`为False，传入的请求对象在Django中每个用户自动都有一个与之关联的`user`属性。
- en: that user object has an is authenticated，attribute that tells us if the user
    is。signed in or not if they're not signed，in we'll go ahead and HTTP response。redirect
    them to the login view and in，order to make this work I'm going to。need to from
    Django HTTP import HDP，response redirect and likewise from。
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 该用户对象具有一个is_authenticated属性，告诉我们用户是否已登录。如果他们未登录，我们将通过HTTP响应重定向他们到登录视图。为了使这一切正常工作，我将需要从Django.http导入HTTP响应重定向，以及从。
- en: Django dot URLs let's go ahead and，import reverse as well so if the user is。not
    authenticated then we're going to，redirect them to the login view where。what is
    the login view going to do well，the login view for now let's just go。ahead and
    render users slash login dot，HTML some form where the user can log。
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: Django.urls，让我们继续导入reverse，如果用户没有认证，那么我们将把他们重定向到登录视图，登录视图将做什么呢？暂时让我们渲染`users/login.html`，一个用户可以登录的某种形式。
- en: themselves in we'll need to create some，templates I'll create a templates folder。inside
    of which is a user's folder，inside of which we'll just create a。basic layout as
    we've done multiple，times now this is again going to be the。general structure
    for pages in this app，title will be users and the body will。
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 自身，我们需要创建一些模板。我会创建一个模板文件夹，其中包含一个用户文件夹，在这个文件夹内我们将创建一个基本的布局，正如我们多次所做的，这将再次成为该应用程序中页面的通用结构，标题将是用户，正文将是。
- en: just have a block called body that I can，later fill in with other content and
    now。that I have this HTML layout I can go，ahead and create a new，file called login
    dot HTML where login。not HTML will extend user slash layout，HTML and inside the
    body block I can。just display in HTML form so I can say，something like I would
    like for there to。
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 只是有一个叫做 body 的块，我可以在稍后用其他内容填充，现在。既然我有这个 HTML 布局，我可以继续创建一个新的，名为 login dot HTML
    的文件，其中 login。not HTML 将扩展用户斜杠布局，HTML，在 body 块内我可以。只需以 HTML 表单形式显示，所以我可以说，想要的内容是。
- en: be a form whose action when I submit the，form let's go ahead and still go to
    the。login URL but let's do so using the post，request method again I'm logging
    in I'm。submitting a form generally when you're，doing that you want to submit form
    data。via post especially in the case of，username and password because if you do。
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 这将是一个表单，当我提交表单时，让我们继续前往。登录 URL，但我们使用 post 请求方法，我在登录，我。正在提交一个表单，通常在你，执行此操作时，你会想要通过
    post 提交表单数据，尤其是在，用户名和密码的情况下，因为如果你这样做。
- en: this sort of thing you don't want the，username and password to be passed in
    as。get parameters because those show up in，the URL our form will have our CSRF。token
    for security as before an input，whose type is text whose name is。username and
    just for user friendliness，let's give it a placeholder also have。
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这种情况你不希望，用户名和密码以。get 参数的形式传递，因为这些会出现在，URL 中，我们的表单将会有我们的 CSRF。令牌以确保安全，与之前一样，一个类型为文本的输入，名称为。用户名，出于用户友好性，让我们给它一个占位符，还会有。
- en: user name so the user knows to type in，their username here we'll also have an。input
    whose type is password whose name，is also password and when an inputs type。is
    password that just means our HTML，we'll know in the browser that Chrome or。Safari
    or whatnot we'll know to show the，password as dots instead of as。
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 用户名，这样用户就知道在这里输入他们的用户名，我们还会有一个。输入框，其类型为密码，名称也是密码，当输入框类型为。密码时，这意味着我们的 HTML，在浏览器中，无论是
    Chrome 还是。Safari 等等，我们将知道以点的形式显示密码，而不是。
- en: characters and we'll give that a place，holder of password and then an input
    of。type submit' whose value is login so we。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_53.png)
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 字符，然后我们会给它一个占位符为密码，然后一个类型为提交的输入，其值为登录，这样我们就。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_53.png)
- en: now have the ability to login so if we，go ahead and run this program。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_55.png)
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 现在有了登录的能力，所以如果我们，继续运行这个程序。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_55.png)
- en: python managed by run server we should，see user's stuff use has no attribute。login
    view all right it looks like I，called this function login request it。should actually
    be called login view and，I'll also need a function called log out。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_57.png)
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: python managed by run server，我们应该，看到用户的东西使用没有属性。登录视图，好吧，看起来我，调用了这个函数登录请求，它。实际上应该叫登录视图，我还需要一个名为注销的函数。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_57.png)
- en: view but I haven't implemented that yet，so I'll just go ahead and say pass for。now
    but I'll come back to later to，implement the logout view alright so it。looks like
    my web server is running now，and before I actually go to the login。page let me
    first go back to the admin，page and actually just create some users。
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 视图，但我还没有实现，所以我就先说 pass。但我会在稍后回来，实现注销视图。好吧，所以看起来我的 Web 服务器现在在运行，在我实际上去登录。页面之前，先回到管理员，页面并实际创建一些用户。
- en: I can go to users and then add and let's，add a user the username will be like。Harry
    for example and we'll go ahead and，give Harry a password and we'll go ahead。and
    save and add another let's add maybe，Ron as well，go ahead and add him we'll go
    ahead and。save that and these users they can have，additional information associated
    with。
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以去用户，然后添加，让我们添加一个用户，用户名可以是，比如说，Harry，然后我们继续给 Harry 设置一个密码，并且我们继续。保存并添加另一个用户，也许再添加，Ron，继续添加他，我们会继续保存这些用户，他们可以有，附加的信息与之关联。
- en: them I can give Ron a name like Ron，Weasley Ron Weasley at example。com it's。his
    email address there are a bunch of，default fields that Django gives you for。manipulating
    user ism and you can take，these users and go ahead and add to。those fields if
    I want to giving him a，first name last name email address and。
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我可以给 Ron 起个名字，比如 Ron，Weasley Ron Weasley 在 example。com 的邮箱地址。这是他的电子邮件地址，还有一堆
    Django 为你提供的默认字段，用于操作用户信息，如果我想的话，可以将这些用户添加到。那些字段中，给他一个，名字，姓氏，电子邮件地址和。
- en: whatnot and you could also customize，these fields as well if you'd like to。add
    custom fields that you would like to，keep track of with regards to your。individual
    users and I will go ahead and，log out from Django admin now because I。don't need
    it anymore but now if I go to，slash users I'm not authenticated so。
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以自定义这些字段，如果你想添加自定义字段以跟踪个别用户的情况。现在我将从Django管理员注销，因为我不再需要它，但如果我去/users，我没有经过认证，所以。
- en: what I see is a login form that just，looks like this a place for me to type。in
    a username and a password and of，course now you could type in like。Harry's username
    and password but I，haven't yet implemented the processing。of that data yet so
    let's go ahead and。
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 我看到的登录表单看起来像这样，有一个地方让我输入用户名和密码，当然现在你可以输入比如Harry的用户名和密码，但我还没有实现数据处理，所以让我们继续。
- en: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_59.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_59.png)'
- en: do that now we'll go ahead and go back，to view stop by in the login view there。are
    two ways the login view function，could be called one is via to get。request method
    meaning just show me the，login form and one is via post submit。data to the login
    form as well so if the，request method is post well then let me。
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将返回到登录视图，登录视图函数可以通过两种方式被调用，一种是通过get请求方法，意味着只显示登录表单，另一种是通过post提交数据到登录表单，所以如果请求方法是post，那么让我。
- en: first get the username which will be，inside of the post data in a field。called
    username and let me get the，password which will be in a field of in。the request
    stop post inside of password，and now what I'd like to do is try to。authenticate
    this user and how do I go，about doing that well it turns out there。
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 首先获取用户名，它将在名为username的字段中，接下来获取密码，它将在请求的post数据中，名为password的字段中，现在我想做的是尝试认证该用户，如何做到这一点呢，结果表明这里。
- en: are a couple of functions that Django，was given to me that I can import so。from
    Django contrib off-off for，authentication I'm going to import three。functions
    we're ultimately going to use，one is authenticate that checks if。username and
    password to correct one is，called login one is called log out and I。
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个Django提供的功能，我可以导入，因此我将从Django的认证模块中导入三个功能，我们**最终**会使用的，一个是authenticate，用于检查用户名和密码是否正确，一个是login，另一个是logout，我。
- en: can now use those functions inside of，this login view here after I've gotten。the
    username and password，I'd like to authenticate the user check。if the username
    and password are correct，so I'll go ahead and say user is equal。to authenticate
    request username is the，username password equals password and so。
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在获取到用户名和密码后，我可以在这个登录视图中使用这些功能，我想验证用户，检查用户名和密码是否正确，因此我将说用户等于authenticate请求，用户名是username，密码等于password，所以。
- en: authenticate as a function just takes，the request takes a username takes a。password
    and if the username and，password are valid they，mean back who the user actually
    is and。as long as the user is not none that，means the authentication was successful。and
    I can go ahead and log the user in，how do I log the user in I use the login。
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: authenticate函数仅接收请求、用户名和密码，如果用户名和密码有效，它会返回用户的身份，只要用户不是none，这意味着认证成功，我可以继续登录用户，如何登录用户呢，我使用login。
- en: function that Django gives me logging in，with this request this user and now
    I。can go ahead and redirect them HTTP，response redirect the user back to the。index
    route back to the original route，that the user started out as and so。that's if
    the user is not none if the，authentication was successful but。
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: Django给我的函数是在此请求中登录用户，现在我可以进行HTTP响应重定向，将用户重定向回。索引路由，也就是用户最初开始的路由，如果用户不是none，且认证成功。
- en: otherwise if the authentication failed，what should I do，well let me go ahead
    and render the same。users login page again but let me add，some additional context
    the context will。be a message that says invalid，credentials and now inside of
    login dot。HTML I can just add some logic that says，if there's a message then go
    ahead and。
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 否则如果认证失败，我该怎么办呢，那么让我重新渲染相同的用户登录页面，但添加一些额外的上下文，上下文将是一个消息，提示凭据无效，现在在login.html中，我可以添加一些逻辑，如果有消息，则继续。
- en: display that message inside of a div and，then end IFTA and that so if there
    is a。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_61.png)
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个div中显示该消息，然后结束IFTA，如果有的话。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_61.png)
- en: message will see the message printed，otherwise we won't see it at all so now。if
    I go ahead and refresh the login page，nothing seems to have changed but let's。say
    I type in a username that doesn't，exist Hermione and some password and I。log in
    well then I get this error，message invalid credentials we were not。
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 消息将会被打印出来，否则我们根本看不到它。因此，如果我继续刷新登录页面，似乎没有什么变化，但假设我输入一个不存在的用户名赫敏和某个密码，然后我登录，那么我会收到这个错误消息，凭证无效，我们没有。
- en: able to log the user in so what happens。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_63.png)
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 能够登录用户，那么会发生什么。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_63.png)
- en: if we do successfully log in well then，the user is going to be taken to this。index
    route and it looks like now we，need to finish off this index realm what。does the
    index rat do well let's go，ahead and return render a template。called users slash
    user dot HTML and，inside of user dot HTML we'll go ahead，user。
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们成功登录，那么用户将被带到这个索引路由，现在看来我们需要完成这个索引的领域，索引路由做什么呢，让我们去返回渲染一个名为用户/用户.html 的模板，在用户.html
    中，我们会继续使用用户。
- en: we'll still extend user slash layout，because we're going to use the same。basic
    layout but in the body of this，page the information I want to show is I。want to
    say like welcome，and then like Harry or welcome Ron or，whoever the user happens
    to be and it。turns out inside of Django templates I，have access to the requests
    that was。
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仍然会扩展用户/布局，因为我们将使用相同的基本布局，但在这个页面的主体部分，我想展示的信息是，我想说欢迎，然后像哈利或欢迎罗恩，或者无论用户是谁，事实证明在
    Django 模板内部，我可以访问到请求。
- en: used to make this HTTP request which，means I also have access to request dot。user
    who is the user associated，that request and if the user has a first。name I can
    access request user dot first，name and in addition to that I can。display other
    information maybe like，their username is request user username。
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 用来发出这个 HTTP 请求，这意味着我也可以访问请求.user，即与该请求关联的用户，如果用户有名字，我可以访问请求用户.first_name，除此之外，我还可以显示其他信息，也许像他们的用户名是请求用户.username。
- en: and maybe their email address is request，user email and so I can show the user。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_65.png)
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 也许他们的电子邮件地址是请求用户电子邮件，所以我可以展示给用户。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_65.png)
- en: information about them such that if like，Harry logs in for example a signing
    is。Harry sign-in with Harry's credentials，click login。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_67.png)
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 关于他们的信息，如果例如哈利登录，签名就是。哈利用哈利的凭证登录，点击登录。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_67.png)
- en: well then Harry sees a page that says，welcome Harry Harry is logged in they。are
    request dot user and using that，information we can access first name。username
    and email as well just by，accessing properties of request dot user。now last thing
    we need to add which，still doesn't yet exist is a way to。
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 那么哈利看到的页面上写着欢迎哈利，哈利已登录，他们是请求.user，利用这些信息我们可以访问名字、用户名和电子邮件，只需访问请求.user 的属性。现在最后一件我们需要添加的东西，仍然还不存在，就是一个方法。
- en: actually log the user out and it turns，out that just as Django has a login。function
    Django also has a logout，function that handles logout for us so。we don't need
    to implement it ourselves，so all our logout view needs to do is。make a call to
    this logout function and，then figure out where should the user go。
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上注销用户，事实证明，正如 Django 有登录功能，Django 也有注销功能来处理注销，因此我们不需要自己实现。所以我们注销视图需要做的就是调用这个注销功能，然后确定用户应该去哪里。
- en: after they've been logged out and you，know what let's go ahead and take them。back
    to the login page with a message of，logged out to indicate that the user has。now
    been logged out then in user dot，HTML we'll go ahead and add a link that。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_69.png)
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在他们注销后，你知道吗，让我们把他们带回登录页面，显示注销的消息，以指示用户现在已注销，然后在 user.html 中，我们会添加一个链接。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_69.png)
- en: will go to the logout route that just，says logout for example so now when。Harry
    goes back to Harry's page if Harry，sees a URL that says logout if Harry。clicks
    logout Harry gets logged out is，brought back to this page because now，to be false。there
    is no authenticated user and so，they now see just the default login page。
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 将会转到注销路由，仅仅说注销，例如，当哈利返回哈利的页面时，如果哈利看到一个说注销的 URL，哈利点击注销，哈利被注销并被带回这个页面，因为现在用户未经过身份验证，因此他们现在看到的只是默认的登录页面。
- en: and if now Ron were to login for example，using Ron's username and Ron's password。logging
    in then Ron now sees information，associated with him as well so Django。gives us
    a lot out-of-the-box gives us，the ability to represent these models。and admin
    interface to be able to，manipulate them a migration system that。
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果现在Ron使用他的用户名和密码登录，Ron将看到与他相关的信息，因此Django为我们提供了许多开箱即用的功能，让我们能够表示这些模型，并有一个管理界面来操作它们，以及一个迁移系统。
- en: allows us to very quickly make changes，to our models and apply them to our，database
    and。also a built-in user authentication，system a system that allows us to very。quickly
    enable users to be able to log，in log out from our web application as。well so
    all of this are features that，just helps to make it so that we can。
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这个系统让我们可以非常快速地对模型进行更改并应用到数据库中，同时还有一个内置的用户身份验证系统，能够让用户快速登录和登出我们的网络应用程序。这些都是使我们能够轻松操作的功能。
- en: very quickly take advantage of things，like sequel and models and migrations
    to。build dynamic interesting web，applications with data to back them up。this was
    web programming with Python and。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_71.png)
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 很快利用一些东西，例如序列、模型和迁移，来构建动态有趣的网络应用程序，支持数据。这个就是用Python进行网页编程。![](img/8f4f652fb6c250bb6b9ef00f83c3cad9_71.png)
